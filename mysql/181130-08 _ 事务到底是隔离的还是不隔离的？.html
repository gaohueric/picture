<head><meta charset="utf-8"><meta name="Keywords" content="极客时间,极客邦,极客邦科技,极客邦控股,极客时间App,专栏订阅,极客新闻,二叉树,极客Live,QCon,左耳听风,AI技术内参,大航海时代,陈皓,徐飞,洪亮劼,霍泰稳,池建强,Selina,Gary,InfoQ,极客搜索"><meta name="description" content="极客时间是极客邦科技出品的一款 IT 内容知识服务 App，内容包含专栏订阅、极客新闻、热点专题、直播、视频和音频等多形式的知识内容，并设有陈皓专栏、徐飞专栏、洪亮劼专栏等专栏供订阅。"><link rel="apple-touch-icon" sizes="180x180" href="//static001.geekbang.org/static/icon/time/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="//static001.geekbang.org/static/icon/time/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="//static001.geekbang.org/static/icon/time/favicon-16x16.png"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover"><meta name="format-detection" content="telephone=no"><title>极客时间 | MySQL实战45讲</title><script src="https://hm.baidu.com/hm.js?022f847c4e3acd44d4a2481d9187f1e6"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://s1.pstatp.com/bytecom/resource/track_log/src/toutiao-track-log.js"></script><script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script><script type="text/javascript" src="//at.alicdn.com/t/font_372689_nw1guejwd2q.js"></script><script type="text/javascript">if(!('flex' in document.documentElement.style) && !navigator.userAgent.match(/spider|googlebot|bingbot|geekbang|yahoo! Slurp/i)){
        window.location.href = 'https://static001.geekbang.org/static/common/browser_update/index.html'
      }</script><script type="text/javascript">;(function(root) {
        root._tt_config = true;
        var ta = document.createElement('script'); ta.type = 'text/javascript'; ta.async = true;
        ta.src = document.location.protocol + '//' + 's1.pstatp.com/bytecom/resource/track_log/src/toutiao-track-log.js';
        ta.onerror = function () {
            var request = new XMLHttpRequest();
            var web_url = window.encodeURIComponent(window.location.href);
            var js_url  = ta.src;
            var url = '//ad.toutiao.com/link_monitor/cdn_failed?web_url=' + web_url + '&js_url=' + js_url + '&convert_id=1606932352132152';
            request.open('GET', url, true);
            request.send(null);
        }
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ta, s);
      })(window);</script><link href="https://static001.geekbang.org/static/time/css/app.3e04e644962ca8c2f97ec7731bb7710c.css" rel="stylesheet"><style type="text/css" abt="234"></style><script>//remove 17173 video ad
doAdblock();
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
//remove baidu search ad
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var aa = function(){
            var all = document.body.querySelectorAll("#content_left div,#content_left table");
            for(var i = 0; i < all.length; i++){
                if(/display:\s?(table|block)\s!important/.test(all[i].getAttribute("style"))){all[i].style.display= "none";all[i].style.visibility='hidden';}
            }
            all = document.body.querySelectorAll('.result.c-container[id="1"]');
            //if(all.length == 1) return;
            for(var i = 0; i < all.length; i++){
                if(all[i].innerHTML && all[i].innerHTML.indexOf('广告')>-1){
                    all[i].style.display= "none";all[i].style.visibility='hidden';
                }
            }
        }
        aa();
        document.getElementById('wrapper_wrapper').addEventListener('DOMSubtreeModified',aa)
    };
}
//remove sohu video ad
if (document.URL.indexOf("tv.sohu.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//remove 56.com video ad
if (document.URL.indexOf("56.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//fore iqiyi enable html5 player function
if (document.URL.indexOf("iqiyi.com") >= 0){
    if (document.cookie.indexOf("player_forcedType=h5_VOD")==-1){
        document.cookie='player_forcedType=h5_VOD'
        if(localStorage.reloadTime && Date.now() - parseInt(localStorage.reloadTime)<60000){
            console.log('no reload')
        }else{
            location.reload()
            localStorage.reloadTime = Date.now();
        }
    }
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style><style type="text/css">.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style><style type="text/css">#iv-container{position:fixed;background:#0d0d0d;width:100%;height:100%;top:0;left:0;display:none;z-index:1000}.iv-container{overflow:hidden}.iv-close{width:26px;height:26px;position:absolute;right:20px;top:20px;cursor:pointer;text-align:center;overflow:hidden;text-shadow:0 0 3px #6d6d6d;-webkit-transition:all .2s ease;-moz-transition:all ease .2s;-o-transition:all ease .2s;transition:all .2s ease}.iv-close:after,.iv-close:before{content:"";height:2px;width:26px;background:#fff;position:absolute;left:0;top:50%;margin-top:-2px;border-radius:2px}.iv-close:before{-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.iv-close:after{-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}.iv-close:hover{-webkit-transform:rotate(90deg);-moz-transform:rotate(90deg);-ms-transform:rotate(90deg);-o-transform:rotate(90deg);transform:rotate(90deg)}.iv-image-view{position:absolute;height:100%;width:100%}.iv-image-wrap{display:inline-block}.iv-image-wrap:active{cursor:move}.iv-large-image{cursor:move;max-width:100%;max-height:100%;background-color:#ececec;-moz-transform:translateZ(0);-o-transform:translateZ(0)}.iv-large-image,.iv-loader{position:absolute;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0)}.iv-loader{top:50%;left:50%;border-radius:50%;width:32px;height:32px;z-index:100;margin-top:-16px;margin-left:-16px;font-size:5px;text-indent:-9999em;border-top:1em solid hsla(0,0%,100%,.2);border-right:1em solid hsla(0,0%,100%,.2);border-bottom:1em solid hsla(0,0%,100%,.2);border-left:1em solid #fff;-webkit-animation:load8 1.1s infinite linear;animation:load8 1.1s infinite linear}.iv-loader:after{width:10em;height:10em;border-radius:50%}@-webkit-keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}</style><style type="text/css">.vue-pull-to-wrapper[data-v-12abd9fb]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;height:100%}.scroll-container[data-v-12abd9fb]{-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}.vue-pull-to-wrapper .action-block[data-v-12abd9fb]{position:relative;width:100%}.default-text[data-v-12abd9fb]{height:100%;line-height:50px;text-align:center}</style><style type="text/css">.button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:46.25rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}</style><style type="text/css">.empty{height:51px}.mobile-tips{width:100%;height:51px;background:rgba(0,0,0,.8);position:fixed;top:0;left:0;z-index:20;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 12px;-webkit-transition:opacity .35s;transition:opacity .35s;opacity:0;pointer-events:none}.mobile-tips.istop{opacity:1;pointer-events:auto}.mobile-tips .mobile-tips-info{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.mobile-tips .mobile-tips-info i{width:36px;height:36px;background-image:url(data:image/png;base64,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);background-position:0 0;background-repeat:no-repeat;background-size:contain;border-radius:7px}.mobile-tips .mobile-tips-info h2{font-size:15px;color:#fff;font-weight:400;margin-left:6px}.mobile-tips .mobile-tips-info h2 span{font-size:11px}.mobile-tips a{width:72px;height:31px;text-align:center;border:1px solid #fa8919;border-radius:3px;font-size:13px;color:#fa8919;line-height:31px}</style><style type="text/css">.share-poster-wrapper{position:fixed;background-color:#fff;left:0;bottom:0;z-index:100;display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;width:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-moz-user-select:-moz-none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.share-poster-wrapper .poster-bottom,.share-poster-wrapper .poster-middle,.share-poster-wrapper .poster-top{-ms-flex-negative:0;flex-shrink:0}.share-poster-wrapper .poster-middle{padding:16px 32px;-webkit-box-sizing:border-box;box-sizing:border-box}.share-poster-wrapper .poster-middle .poster-userinfo{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-bottom:18px}.share-poster-wrapper .poster-middle .poster-userinfo .poster-avatar{min-width:45px;min-height:45px;width:7vw;height:7vw;border-radius:50%;-ms-flex-negative:0;flex-shrink:0}.share-poster-wrapper .poster-middle .nickname{font-size:5vw;font-weight:400;margin-left:18px}.share-poster-wrapper .poster-middle .time{font-size:3.2vw}.share-poster-wrapper .poster-middle .poster-middle-content{font-size:4vw;font-weight:400;white-space:normal;word-wrap:break-word;word-break:break-word;letter-spacing:1px}.share-poster-wrapper .poster-middle .poster-middle-content p{margin-bottom:22px}.share-poster-wrapper .poster-middle .quote-content{font-size:3.7vw;padding:32px 0}.share-poster-wrapper .poster-middle .quote-content p{margin-bottom:22px}.share-poster-wrapper .poster-middle .quote-info{border-left:1px solid #000;padding-left:10px;margin-top:38px}.share-poster-wrapper .poster-middle .quote-info p{font-size:3.2vw;line-height:1.5}.share-poster-wrapper.theme0 .poster-top{width:100%;height:25px;margin-top:27px;background:url("https://static001.geekbang.org/static/time/page/img/sharePoster/theme1/top.png") no-repeat 15px 1px}.share-poster-wrapper.theme0 .poster-middle{width:100%;padding-left:56px;padding-right:56px;background-image:url("https://static001.geekbang.org/static/time/page/img/sharePoster/theme1/middle.png");background-repeat:repeat-y;background-position:15px 0}.share-poster-wrapper.theme0 .poster-middle .time{margin-bottom:45px}.share-poster-wrapper.theme0 .poster-middle .quote-content{border-top:1px solid #e3e1dc;margin-top:30px}.share-poster-wrapper.theme0 .poster-bottom{width:100%;height:25px;margin-bottom:27px;background:url("https://static001.geekbang.org/static/time/page/img/sharePoster/theme1/bottom.png") no-repeat 15px -10px}.share-poster-wrapper.theme1 .poster-top{width:100%;height:25px;margin-top:27px;background:url("https://static001.geekbang.org/static/time/page/img/sharePoster/theme0/top.png") no-repeat 38px 1px}.share-poster-wrapper.theme1 .poster-middle{width:100%;padding:0 42px 10px;background:url("https://static001.geekbang.org/static/time/page/img/sharePoster/theme0/middle.png") repeat-y 38px 0}.share-poster-wrapper.theme1 .poster-middle .poster-userinfo{border-bottom:1px solid #b5a899}.share-poster-wrapper.theme1 .poster-middle .poster-userinfo .poster-avatar{margin-left:38px}.share-poster-wrapper.theme1 .poster-middle .poster-middle-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;min-height:260px;border-bottom:1px solid #b5a899}.share-poster-wrapper.theme1 .poster-middle .time{max-width:65px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;text-align:center;vertical-align:middle;border-right:1px solid #b5a899}.share-poster-wrapper.theme1 .poster-middle .time span{white-space:nowrap;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.share-poster-wrapper.theme1 .poster-middle .poster-middle-content{padding:30px}.share-poster-wrapper.theme1 .poster-middle .quote-content{font-size:3.7vw;margin-left:36px;margin-right:36px}.share-poster-wrapper.theme1 .poster-middle .quote-info{margin-left:36px;margin-right:36px}.share-poster-wrapper.theme1 .poster-middle .footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-right:30px}.share-poster-wrapper.theme1 .poster-bottom{width:100%;height:25px;margin-bottom:27px;background:url("https://static001.geekbang.org/static/time/page/img/sharePoster/theme0/bottom.png") no-repeat 38px -10px}.share-poster-wrapper .share-poster{background:#fefdf8;-webkit-box-sizing:border-box;box-sizing:border-box;color:#9b8d73;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-overflow-scrolling:touch;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.share-poster-wrapper .share-poster.color0{background-color:#fefdf8}.share-poster-wrapper .share-poster.color1{background-color:#4d4d4d}.share-poster-wrapper .share-poster .footer{margin-top:2rem;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.share-poster-wrapper .share-poster .footer p{margin:0;line-height:1.4;margin-left:20px;text-align:right;padding-right:20px}.share-poster-wrapper .controls{background:#fff;border-top:1px solid #f5f5f5;width:100%;padding-top:5px;-webkit-box-shadow:0 -4px 10px 0 rgba(0,0,0,.1);box-shadow:0 -4px 10px 0 rgba(0,0,0,.1);z-index:1;-ms-flex-negative:0;flex-shrink:0}.share-poster-wrapper .controls>div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:10px 0}.share-poster-wrapper .controls>div span{font-size:.85rem}.share-poster-wrapper .controls>div button{width:100px;height:24px;background:#eee;margin:0 10px;border-radius:5px;border:2px solid #b2b2b2;outline:none}.share-poster-wrapper .controls>div button.on{border:2px solid #ff5a05}.share-poster-wrapper .controls .controls-themes button{color:#b2b2b2;font-size:12px;background:#fff;text-align:center}.share-poster-wrapper .controls .controls-themes button.on{color:#ff5a05}.share-poster-wrapper .buttons{background:#fff;border-top:1px solid #f5f5f5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-negative:0;flex-shrink:0}.share-poster-wrapper .buttons a{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-align:center;color:#000;font-weight:400;height:3rem;line-height:3rem}.share-poster-wrapper .buttons a .icon-share-money{width:1rem;height:1rem;margin:3px 0 0 5px}.share-poster-wrapper .buttons a:last-child{border-left:1px solid #f5f5f5}.share-poster-wrapper img{max-width:100%}.share-poster-wrapper.android .poster-middle .nickname{font-size:10vw}.share-poster-wrapper.android .poster-middle .time{font-size:6.4vw}.share-poster-wrapper.android .poster-middle .poster-middle-content{font-size:8vw}.share-poster-wrapper.android .poster-middle .quote-content{font-size:7.4vw}.share-poster-wrapper.android .poster-middle .quote-info p{font-size:6.4vw}</style><style type="text/css">.mini-audio-player{width:100%;height:5.25rem;border:1px solid #d9d9d9;background:#fafafa;-webkit-box-sizing:border-box;box-sizing:border-box;padding:1rem;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin:1rem 0}.mini-audio-player>a{border:none;-ms-flex-negative:0;flex-shrink:0}.mini-audio-player .btn-play{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI0AAACNCAYAAACKXvmlAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAEsVJREFUeJztnXuQVNWdxz9zHUeR9yuYLBgIvhAZIAiIkhRCwqprUGNiTNRskl2T3U0gPjayibJWCbEGTNCsuJXEqCnjMyYYJRrzWDCKKCrKgAoCAqIVxUFGQSSMOLN/fO/xnDt0T79u3763+36quurcV/e55/z6PH7nd36/uqamJmqEOuATwFHAUP8zBBgADAT6Az39e3sC9cB+YLd/bjfwFtAC7ABeBbb6n43AZqCjzO8QC+ornYEycjQwGTgRGAUcD/Qo8Dvqgb5+ui9wRBf3vgu8AKwBngSWAxsK/L1EUE1CMxg41f98GrUeUdIDmOh/LvLPtQCPAg/7n9cizlNZSLrQDAe+BHwRGJPH/W8CL2K7lc2oq3nLv/aOf99u1DXVY7us3sBHUDc2AHV1Q/3Pcf61zgwEzvE/AKuBe4F7gJfzyG8sSaLQ9AYuAP4ZGN/FfTuBJ4AVwNPAWuCNAn9rP9Dqp1uRoGVjENDo5+kkYBLQr9M9Y/zPD/083Qb8CiusiaAuQQPhccBM4FygW4brbWgcYbqC56nswLQOjaNMlzkZaMhw317U+vwPsCqy3JVA3IWmDjgduAw4JcP1NuBPqNDvJ97/2F7AmUjop5NZgJYB1wG/J8YzMa/SGchCHTADeA4VYGeBWQvMAj4KfA4183EWGIBdqCv6HMr3LPQeLqcAD6CxzwxUDrEjjkIzBXgKtRyjnfP7gbvRWKERuAGNW5LITpT/RqQSuBu9n6ERvf9TqDxiRZyE5khgMWqiT3DO7wWu969/GelAqomV6L2ORO+517l2AiqPxf71WBAHoekGXI0UY2c75/ehf+Nw4BLgleizFimvoPccjgbF+5xrZ6PyuZrMk4BIqbTQTEb99xzswLADuAtpdGcBr1cmaxXjdeC76P3vwg6IG1A5rQY+VZmsiUoJzaHAj4C/osIxPId0HF8BtlUgX3FiGyqHk4BnnfNHA48AP0blGDmVEJrjUD9+mfP7e/zj8VTfmKVUngQmoPLZ45/zgEvRQPm4qDMUtdBcgDShjc65pWhBcSHwQcT5SQofoPIZhcrLMAqV54VRZiYqoTkYWIT0FIf559qA2cBngS0R5SPpbEHlNRuVH6g8b0Ple3AUmYhCaPoCfwC+7ZzbjPrqBUB7BHmoJtpRuU1C5Wj4NirnvpkeCpNyC81Q4DFgmnPuIaR/SMQ6S4x5FpXjQ865aai8h5bzh8spNKPRKvNI/7gDmIfU6K3ZHkopiFZUnvOccyNRuY/O+EQIlEtoJqAB2+H+cRsyZZhD2h2FTTsq168D7/vnDkflP6EcP1gOofkU8BesLclu4DQ0CE4pH79E5WxsmvuheghdERi20EwElmCt3VqRGcDSrE+khMn/odmV6f57ovqYGOaPhCk0o9CgrLd/3IKW+lNlXbSsBKai8gfVx0OofkIhLKEZTLBLehtJfHNI359SGKtR+b/tH/dDrdCQML48DKExkmwMq3ch88ZUYCpLM6qHXf7xQOBBbE9QNKUKzcHI1sM0fW1oGX9lid+bEg4rUX0Y7fEoVF8laY5LFZoFqP80/CvpoDduLAX+xTmeiuqtaEoRmvOAi53jJtJpdVy5HdWP4WJUf0VRrNAcC9zsHP8BuKLYTKREwhWongw3o3osmGKEpgG4A7tavRk4n1TTG3faUT2ZnZ2HAXeSeStNlxQjNPOAT/rpNrSPJ11LSgataBuzGRiPJbhulReFCs3JyILMMId0tTpprAKudI4vQ/WaN4UIzSHATc4zy5Cdb0ry+DF2luuhej0k34cLEZorgBF+eg+aXqfjmGTSjurP2ByPoICJTL5CMxy43Dn+b4JWYynJYwsaXhguJ88NefkKzY+wzdcq4Cd5Zy0lzrieKg4Brs3noXyEZhpwlp/uQBu50l0D1cEHaEOi2ZB3FkENf0ZyCU0dQU3i3cDjxeQuJbasQDs5DU3k8FaRS2hmYDfj7wP+q+ispcSZ72P3jo9H9Z6Vrtyn1aEN54afE9OtsrPXzMl9U8KY3zg3yp/bhup3pn98NfKTk9GxUlctzQzsTsj3gGtCymBKPLkG1TOo3rO2Nl0JjbuCfROFOzmsNIPQWstsNHg/Fehe0RzFmzeAnznHF2e7MVv3dALWA9N+tI84KdQDVwHf40At5160SDeH2nNhkg/Xoy6qHtX/BORkIEC2lmamk15MTMcyGTCWhFeSWS3eDRkkbUBCVfAKb5WzDfitc/ydTDdlEpo+yJmzIUmtzKVox2EueiDrNWOAnWK5zkl/AclDgExCcz7WRddakmXvOzP3LQFGIJeyv6HruAe1xEoU3wEkB1/pfEMmofm6k/55GTJVLnoA/1Dks+cA69GiXUW8S8WMm5z0Nzpf7Cw0RyLP4CBDnTvLlKlycFCJz3dDBklrgX8qPTuJ5g6sodY4Oi1kdhaac530n0iun95SOBI5vF5CjNywRkwrqn+DKxddCs095cpRQjgD9e1ziYEb1grg1n9WofkYVgP8PlIj1zrd0PR9PUEfx7XAA9guajSSDyAoNKdhVzeXY7dzpmhmtRj4I3BMhfMSFbsIWjScbhKu0Pyjk3ZdcqVYpqMuaz6FhzZMIg866ekm4QrNFCftDoJSgjQg08iXUEyDasaVgyn4PZERmmOwMR93cmBImWojjH1aH0MqiWUoGFg18jx2Bj0Q37u8ERp338sKYhygKiRORbOifbluzIMpyD3/dWRQuSecDoLjmpPBCo3rXqsWzDn3oh0Vx6PBbanUI1OCdcghZSyDexXJCic9EazQuJFma2nH5CbU6nyBcFbyD0cOEx9HW16rAVceRoOExsP6+oXqH89k4reoDOZjdROlMAl4BriRAyPmJg1XHo4HPA8YhrVo207yLPTC4l1kOD8G+acrFQ/4DzTL+iaVj61VLG9gZaI7MMwjuL6yLvIsxY91wGeQ05+/hfB9A5AZ5UoUrzKJrHfSR3kE/ehvjTQr8eYepIpYSDAoabGcgMY6NyNBShLuFuxhHvAJ58TLpLi8i1xxjAUeDeH7PGSfshGZUna1hShOuKGVhnrIB7Dh1YgzkxSeR/qYrxLOmK8PCur6NBWOR5kn7sxyiIfVBEPtDoLzoQM5ohyBNs6H0WWNQXE8f0oB/mEqwHYnPcAjOCWsRaOrQnkb7aMaT1DxVSx1wLeQ0Vdcu6u3nHR/D+if5WJK16xGIaK/AewI4fs+i3ZTxBG3MennEVwvSR0uFkYHcCtayPsppXsGm0k8lyDcxqSvRzCTqTu04mgF/h2tzTxdwvcMRsrWWONh/QGDFvJSiucZpMD7N4rv6gfnviVy9jjp7h7B4AphrLvUOu3AfYSj14kL7kyx3sPGPYSI4jpXMR4KdfwSxRuix1Ht4c7q9ntYnyQQ7KpSCsOMZxZRvDHWTuKplXddtOzxCFrpJXUltpIMQNtYV2Dd/xfLXSTACaaHDVkHEUSPryI8ZPKwHjlyLvUP1wL8sNRMlQlXl9fqERzlJ91gKCrGoYDpPyNYoMXyJto/HldHS4FVA4+gti+MAqhm+gD/i7xDhREovQO4BVnElaLfKTeBVYN6bChekJ+6lAOpQwbjCwgu8JbCKmQekYQQ1K5c7PCA15wTqWOfAxkNPIaWC8IQmB1I+TeBZAgMBOXiVY+ggc3wiDMTZ3ojx4XPUGA8pCy0o/WpY9FYKElLNu7SxtZ6OlllRZuXWFKHXIZdC3w0pO98EhmZPxfS90WNa9251UN7fwwjqG1GouBZtxOOwGxHphMnkVyBgWCA1A2mezILUoPQhq9aowdqWVYTdIRQLPtReKNj0VgoyducXZnYA2zxUN/6gnPTqKhzVWHORQq6/yQcy7lHkGb4YoKK06TS6KRfANqNFrPZuTCO2uAY4M9oq0qxXkFdXkdjoalU1y5Vd2lkNVjVt+srOIyZQtz5PnJO9JkQvqsNdW1Ho7WjJHdFmXDl4SmwzfFy58JJaAZRbS/vEpYzoj8jI/Nq3ZlaR1BoloNtaTZgNcP9qF4nPWGxDXmamE71CgxoNmnWnVqQnHwoNB1oAGeYTkom/o5Woo8lGHiiWnH9MP4Vv/dxl/Nd/2q17rE7Ew+imeWV1I4ttSsHHzp/coXG9eh5MtCr3DlKCJtQZJczCCpCq51eaHxr+FA+XKH5G3bq3UCO4Jc1wF4UTKwRub2vNWZgtwo347hd6Wxt9msn/aUyZyrO3IfGLfOona6oM279u3JxgNDc66SnU3vmny+hwd/nSU40vXLQl+BkqEuh2Qg866cbUMCwpFCKqcG7KEBqI6njbZBm24RqfJZOY7lMxtC3OumLypSpcrCb4lqHu9CSwgLSzYKGbzrpWztfzCQ0t2P78UaCPobjzrUF3Ps8cAr6V4XhW69amIBdpNyL5CFAJqF5G8V0NFwSfr7KxiJgFmp1stGK3mksQYVminDr+zdkWKnPZgqwCLjQT5+DbESTMjC8AbgNOZWehLVvfQU5SnyQ2p0R5eIItDxiuDHTTdmE5in0L5yCdeEeV4c7mXgHmTzUenS8QvkuViYeIUuk5K52BV7vpL9FbVr01RKD0C4Jw/XZbuzKUm0JsjlpRI4BfoDGC7FjfuPcSmehGvgB1gHEGlT/GemqpWkHrnKOLwKGlJy1lDgyhOA0+yq60Hvl2rR+PzYKx6FAU0lZS4krTdgg9qtQvWcll9B0oCAThi8TXPlMST6TCFoyziaH1WY+7jH+AvzOT9chx8sHFZO7lNhxEFJRGGedvyOPCDT5+lS5HBu6bxwxHRCnFMws7O6Tfaiec5Kv0GwkqKKfSwJcl6Z0yTBUj4ZrUT3npBDvTfOwcX+6A78o8PmU+OAhl2/Gl956VL95P5wv+5CbMDMVm4rC2qQkj8uAaX66A6lT8o4cXGhL8TgKmmWYR/UE+KwVxhJsVRYS3PeWk2K6lyvwt2ciQ517qb541NVKH2SFZwysViNNcEEUIzRtyAbF+B8eDtxR5HelREcdqicTs/Q9ZJlZsOFZsRW9jqBV3+nE151pipiH6slwEfBiMV9USutwJ/LBYphNsmyKa4nzkdMDw09Q/RVFqV3K95DnKFDzdwuaVaXEh6moXozWdyl5KvGyUarQvI+2exh/LA1oz1CS7IqrmYnAYuzAdy2qr5IM6MMYvL6Dtq0arxO9gIcJelBKiZ7RqB56+8ctwJmovkoirBnPK8hBkAln2ActdI4O6ftTCmMM8p1jVCGtqH62ZH2iAMKcJq8BTgN2+ccDgWWkXVXUTETjFuMoexeqlzVh/UDYupWVqKsyW0j6Iok/JeTfScnMNFTeZjv1blQfGQ3Ei6UcCrlHUbhg01X1RH3rBWX4rRTL15A7kJ7+cSuqh9DDIpZLi7sStS4mtF4D2os0t4y/Wat4qFxvwc6StqPyD7WFcX+wXDQj01CjdaxDXqSWUHveKMpFH+ABVK5GD/MiMuFszvZQqZT7X78FmIwGxIbTUWyjUkP31TqfRME+XBdny1B5hzJLykYUXUUr8vnibvEcjiKzXR5RHqoJD2ninyAYNedGVM6tmR4KOwNR8D4KiPVV7Op4AzAfjfZT09H8GIbKawF2/PIeCmD2HYLhsstG1P/yXwHjCbqBN27hLyHd5ZCNg1D5rCW4trcWledtUWamEl3Di8gHykKs6Wh3//gJ4MQK5CnOnIjKZSHWprcduA6VY1HmDaVQqfHE35Gd6hR8L9g+41F86ztJQyMegcphBSoXwwY0nb4UlWPkVHoQ+hhaJ5mHXXmtQzv+NiC7j1rzVnE4eu+XUDmYqXQbKqcxlEFhVwiVFhqw/npHIrMKwyFoM9dm1BR/PPqsRcrH0Xu+jN77UOfafah85hADh0xxEBrDJmTrMQ3pHwzdkFOlTcipYhjxsOPEBPRem9B7HuZcewatTn+eGHlLj5PQGJaigjyL4MpsPXAeUo03oylmUjXLfVH+m9H7nEfQV9Aa4GxUDjn3VkdNHIUGtIHrfrRH50w09nFpRBvX30DLEhcS/1gOvVA+l6AodDdwoKHaY+h9x6LN+LGMuRVGzMZy0o7WVh5AM4iZyJFgN/96Awp0cQYaKC5HK+oPI5evlSz0OhQ361T/MxmrkHPZi7xoLsKP3BZ36pqaEuenqA8ys/gaXcfb3Immq8uRo541wJtlzNdHUMsxDkWxORkbYCsTq4BfIj+9iQqQmkShcTkK+KL/GZPH/dtRxNetzqcFeAsJlLE6fAe1ch7WxrYXEoz+yCpuqPMZiRwd5mI1alV+TZ4eGuJI3LunXGwErvE/g7Fdwaex5o4ug8ivcsOiBelUTJf5WoS/XTaSLjQuryH3J7/wj0cgu5ITkYH7SKwavhzsQa1YM/AkUv1XZXzLahKazqzzP7f4xx5aJT4K260MAQagVqk/1lSyt39/O3bLx27UjbUAO4BXsV3cJqSELCUSTGL4fyx+lt5bqgReAAAAAElFTkSuQmCC)}.mini-audio-player .btn-pause,.mini-audio-player .btn-play{width:2.6875rem;height:2.6875rem;background-repeat:no-repeat;background-position:0 0;background-size:contain;text-decoration:none}.mini-audio-player .btn-pause{background-image:url(data:image/png;base64,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)}.mini-audio-player .audio-info{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin-left:.6875rem;min-width:0}.mini-audio-player .audio-info h3{color:#353535;font-size:15.25px;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mini-audio-player .audio-info p{margin:0;margin-top:.125rem;font-size:11px;line-height:1rem}.mini-audio-player .audio-info p span{color:#888}.mini-audio-player .btn-download{width:1.25rem;height:1.25rem;position:relative;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAA+CAYAAACbQR1vAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAA4hJREFUaIHtm8lOFFEUhr9qCWGHGxcaY1joK2h0YRzAtYmsWbAGGidEXOACbAYRxfgAPoEPoInGxJgg86gsJTHMw86EhS7O7TDk3uqq6qo6HahvQ7pOce7//1U0feve9vr6+lAiD3QC/4AC8FZDRJXGoMB14PWB1yPANPA1bSG5tAc0XLEcu5y6CvQCOGU5pnI3agVQMWQBaAvQJgtAW4A2WQDaArTJAtAWoE0WgLYAbbIAtAVokwWgLUCbLABtAdpkAfjU6oC7wKV0pCTCRcRDnesEVwDNwC/gg/nZHbeyFOgGltj30Gw7yRZALfAOqDavPeA50BO7xOToQTR75nU14qn26Im2AM4DNZbjz4DeePQlSi+i9Sg1iLdD2AJYApYdzbuo7BBeIBptLCPeDmELYA9oBHYdjbqQpaxKowA8ddR2gXuIt0O43gRHgTu4Q+ikskIoIJps7AINwA9b0e/fYJAQ1FZWD9CP2/wOUI/DPJT+IDRqGrhCeGIEaNEPdDhqO8iVH/NrEOST4BgSwo6j3gEMBOgTNwP4m6+nhHkI/lG4VAiPgcGAveJg0IxpYxvROh6kUZi5wLhpvO2oPyKdEF6asWyEMg/hJ0PjyN+VXwhDIXuGYQh46KhtIeYnwjSMMhss3glbjvoDkglhyPS2Eck8RJ8OTyB3gl8IryL2tjGM2/wmYn4ySuNyngdMmIE3HfX7iHDPUQ+CZ3q0O+qbyIWIZB7KfyAyaQS4QmhH7oQoIZQyv0EZV75IHE+EJvG/E9oJfyd4yC6yvKO+gQQ/FaKnlbgeiU0hIWw46nnEUJAQiubbHPV1M1bZ5iHeZ4KlQmgD3uAfgofsGfQz34DsKYyFuLemTSMhfATOWOqtiMk/llrRfIuj9zpwG5gtX+Y+SezNK4bwCXsILdgDaAXOOnomYh6Seyw+gwhed9TPWY75mb9FAuYh2XWBWUS4K4QgrAE3gblYFFlIemFkDjEQJYQ1JMD5WBUdIY2VoXkkhLUQv7NqfidR85De0liYEFaRK7+QqCJDmmuDC0gIqz7nrJhzUjEP6S+O+oWwglz5xTQFaawOLwI3gO8Hjo2ZY6maB72vzPwErgEXkO8MuVaiEkcrgCK/lcfPNkhkAWgL0KYKmZiMIG9Ktn0Bx5G/wDcgXwW8R6avJ41G4HQOufInlas5ZO5+UpnJAU3AFyy7J44xe8BnoOk/JruwYo92bigAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:0 0;background-size:contain;text-decoration:none;padding-right:.25rem}.mini-audio-player .btn-download .icon-download-done{width:.45rem;height:.45rem;position:absolute;bottom:0;right:0;display:inline-block;background-image:url(data:image/png;base64,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);background-repeat:no-repeat;background-position:0 0;background-size:contain}</style><style type="text/css">.MathJax_Display{overflow:auto}.poster{position:fixed;left:-10000px;top:-10000px;overflow:hidden;padding:1rem;background:#ececec}.richcontent-pre-copy{font-size:13px;color:#888;position:absolute;right:1em;top:.2em;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.richcontent-pre-copy .iconfont{font-size:12px;margin-right:.2em}</style><style type="text/css">.comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#fa8919}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#fa8919;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}</style><style type="text/css">.breadcrumb{padding:30px 0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap;background:#fff}.breadcrumb a.title{color:#e57c39;font-size:15px;font-weight:400}.breadcrumb span.title{color:#888;font-size:15px;font-weight:400}.breadcrumb .split{color:#ccc;font-size:10px;margin-right:5px}</style></head><body><svg aria-hidden="true" style="position: absolute; width: 0px; height: 0px; overflow: hidden;"><symbol id="icon-android" viewBox="0 0 1024 1024"><path d="M862.778202 640.174593c-17.774874 0-32.175395-13.876101-32.175395-30.980825L830.602807 414.807258c0-17.134486 14.399495-30.981851 32.175395-30.981851 17.773847 0 32.203104 13.847365 32.203104 30.981851l0 194.385484C894.981306 626.298492 880.553076 640.174593 862.778202 640.174593zM380.771249 151.679606 380.771249 151.679606l-56.204315-70.516577c-3.83925-4.829593-2.675467-11.578298 2.619023-15.097354 5.293464-3.520082 12.682557-2.443532 16.523859 2.385035l58.093665 72.901612c33.367912-14.662218 70.603809-22.865138 109.905574-22.865138 39.302791 0 76.509952 8.203946 109.875812 22.865138l58.094691-72.901612c3.83925-4.829593 11.258104-5.905117 16.552594-2.385035 5.265755 3.520082 6.429537 10.268787 2.589261 15.097354l-56.204315 70.516577c64.726402 35.578483 111.504491 96.640099 124.53803 168.465162L256.233218 320.144767C269.295493 248.319705 316.042794 187.258088 380.771249 151.679606zM622.341222 254.749242 622.341222 254.749242c17.716377 0 32.058401-13.439939 32.058401-29.992534 0-16.552594-14.34305-29.963798-32.058401-29.963798-17.65788 0-32.028639 13.411204-32.028639 29.963798C590.312583 241.309303 604.683343 254.749242 622.341222 254.749242zM401.01839 254.749242 401.01839 254.749242c17.716377 0 32.028639-13.439939 32.028639-29.992534 0-16.552594-14.312263-29.963798-32.028639-29.963798-17.687641 0-32.029665 13.411204-32.029665 29.963798C368.988724 241.309303 383.330748 254.749242 401.01839 254.749242zM161.221798 640.174593 161.221798 640.174593c-17.803609 0-32.20413-13.876101-32.20413-30.980825L129.017668 414.807258c0-17.134486 14.400521-30.981851 32.20413-30.981851 17.773847 0 32.175395 13.847365 32.175395 30.981851l0 194.385484C193.397193 626.298492 178.995645 640.174593 161.221798 640.174593zM766.691258 718.719625 766.691258 718.719625c0 31.011613-25.658625 56.117082-57.3096 56.117082l-40.116617 0 0 131.868626c0 29.440404-24.349114 53.294859-54.42888 53.294859-30.079766 0-54.42888-23.854455-54.42888-53.294859L560.407282 774.836707l-97.425191 0 0 131.868626c0 29.440404-24.378875 53.294859-54.429906 53.294859-30.050004 0-54.42888-23.854455-54.42888-53.294859L354.123306 774.836707l-40.116617 0c-31.621213 0-57.308573-25.10547-57.308573-56.117082L256.698115 384.348801l509.992117 0L766.690232 718.719625z"></path></symbol><symbol id="icon-apple" viewBox="0 0 1024 1024"><path d="M791.489559 544.090212c-1.290235-129.678896 105.758341-191.876433 110.550644-194.968902-60.149545-88.022725-153.845209-100.085402-187.24797-101.478037-79.748834-8.069091-155.586003 46.939992-196.074818 46.939992-40.365935 0-102.809232-45.752156-168.959395-44.543841-86.916809 1.290235-167.054762 50.544459-211.803402 128.38866-90.295997 156.691919-23.121837 388.831888 64.880408 515.930313 43.007846 62.197537 94.289582 132.075047 161.627581 129.576496 64.839448-2.580471 89.35392-41.96337 167.751079-41.96337s100.43356 41.96337 169.041315 40.673134c69.77511-1.290235 113.991272-63.405853 156.691919-125.78771 49.397583-72.171262 69.73415-142.028292 70.921986-145.632759-1.556474-0.696318-136.068633-52.244293-137.399828-207.133978zM662.568421 163.511735c35.737472-43.356005 59.862826-103.505549 53.288769-163.511735-51.486536 2.088953-113.868392 34.283397-150.81418 77.557482-33.136521 38.379383-62.156577 99.634843-54.374205 158.432713 57.466674 4.485104 116.121184-29.204375 151.899616-72.457981z"></path></symbol><symbol id="icon-arrowright1" viewBox="0 0 1024 1024"><path d="M267.649318 918.655743 308.671617 959.678042 756.349659 512 308.671617 64.322981 267.649318 105.34528 674.305061 512Z"></path></symbol><symbol id="icon-ok" viewBox="0 0 1024 1024"><path d="M997.12174459 172.27043777c-16.65294032-15.61730971-42.91653278-14.87165566-58.53513703 1.82270988L386.13981108 762.29120758l-301.78276187-297.35026283c-16.32153853-16.07298718-42.54370576-15.90728628-58.61669294 0.41425224-16.07298718 16.27881876-15.86586107 42.54241122 0.45567747 58.57526772l332.02317589 327.09357417c0.12427568 0.12427568 0.28997657 0.1657009 0.41295772 0.28997657 0.12557022 0.12427568 0.16699543 0.28997657 0.2912711 0.41425225 2.60978915 2.48551348 5.75810623 3.89397111 8.78214765 5.55098011 1.49001355 0.86992972 2.77549005 2.15411168 4.34835405 2.77549006 4.88817651 1.90556034 10.0663296 2.89976573 15.20305745 2.89976571 5.42670444 0 10.85340887-1.07705584 15.90728629-3.23116753 1.69972875-0.70422882 3.02404141-2.15411168 4.59819994-3.06546662 3.10689185-1.82270989 6.33805938-3.3554432 8.98927377-6.0480828 0.12427568-0.12427568 0.1657009-0.33140179 0.28997657-0.45567748 0.08285045-0.12557022 0.24855135-0.16699543 0.37282701-0.2912711l581.48717354-619.05855778C1014.6433201 214.19276515 1013.77339038 187.97059792 997.12174459 172.27043777z"></path></symbol><symbol id="icon-leftarrow1" viewBox="0 0 1024 1024"><path d="M266.163989 512.035816 266.163989 512.035816c-0.992607 13.43294 3.208065 26.929326 13.338796 37.123502l396.655995 396.499429c18.788925 18.691711 48.957015 18.72548 67.867714 0.033769 18.755156-18.788925 18.466584-48.957015-0.062422-67.706031L377.856837 512.069585l366.077559-366.042767c18.49626-18.657942 18.62315-49.113581-0.097214-67.774593-18.853393-18.657942-49.113581-18.657942-67.805292-0.029676l-396.528082 396.817678C269.436522 485.33264 265.171382 498.828003 266.163989 512.035816L266.163989 512.035816z"></path></symbol><symbol id="icon-shezhi" viewBox="0 0 1024 1024"><path d="M640.516 888.95C640.516 888.95 640.516 888.95 640.516 888.95c-13.9-0.002-27.404-6.01-36.132-16.066-11.886-13.62-49.55-49.036-80.378-49.036-30.616 0-68.862 35.622-79.844 48.1-8.706 9.886-22.12 15.79-35.882 15.79-6.556 0-12.742-1.314-18.39-3.908l-0.988-0.452-93.706-54.758-0.93-0.68c-17.06-12.484-23.554-36.89-15.102-56.782 0.064-0.152 8.642-20.834 8.642-39.696 0-57.234-44.558-103.804-99.332-103.804l-3.32 0c-0.202 0.008-0.402 0.01-0.604 0.01-15.69 0-28.462-14.56-32.542-37.104-0.328-1.804-7.998-44.562-7.998-78.244 0-33.69 7.668-76.446 7.994-78.248 4.134-22.826 17.186-37.492 33.15-37.096l3.322 0c54.772 0 99.332-46.566 99.332-103.804 0-18.854-8.574-39.534-8.662-39.742-8.442-19.87-1.906-44.274 15.224-56.714l0.968-0.706 98.898-56.764 1.028-0.458c5.57-2.482 11.668-3.738 18.128-3.738 13.73 0 27.174 5.774 35.958 15.448 11.704 12.808 48.704 46.116 78.65 46.116 29.662 0 66.438-32.652 78.1-45.232 8.732-9.478 22.078-15.152 35.678-15.152 6.59 0 12.802 1.302 18.462 3.872l0.998 0.454 95.52 55.458 0.944 0.688c17.088 12.464 23.598 36.874 15.138 56.776-0.062 0.152-8.642 20.836-8.642 39.694 0 57.24 44.562 103.804 99.332 103.804l3.32 0c15.944-0.37 29.016 14.268 33.146 37.096 0.33 1.802 8 44.558 8 78.246 0 33.684-7.67 76.442-8 78.246-4.13 22.826-17.202 37.436-33.148 37.094l-3.318 0c-54.77 0-99.332 46.57-99.332 103.804 0 18.856 8.574 39.53 8.66 39.738 8.44 19.86 1.916 44.264-15.188 56.72l-0.958 0.698-97.126 56.098-1.01 0.458C653.016 887.682 646.936 888.95 640.516 888.95L640.516 888.95zM637.564 841.126c0.436 0.296 1.66 0.804 2.95 0.804 0.056 0 0.104 0 0.15-0.004l90.744-52.418c-2.19-5.314-12.208-31.124-12.208-58.044 0-80.51 60.684-146.488 136.756-150.62 1.098-6.316 7.04-41.854 7.04-68.526 0-26.664-5.94-62.194-7.038-68.528-76.074-4.128-136.758-70.108-136.758-150.62 0-26.958 10.048-52.8 12.22-58.076l-89.276-51.834c-0.102-0.008-0.226-0.012-0.372-0.012-1.522 0-2.946 0.58-3.416 0.91-1.496 1.608-14.44 15.322-33.028 28.988-27.512 20.23-53.536 30.486-77.334 30.486-24.034 0-50.262-10.458-77.954-31.086-18.702-13.93-31.702-27.906-33.204-29.546-0.476-0.336-1.916-0.932-3.45-0.932-0.12 0-0.226 0.002-0.318 0.008l-92.468 53.076c2.216 5.384 12.196 31.146 12.196 58.016 0 80.51-60.682 146.49-136.758 150.62-1.096 6.324-7.04 41.862-7.04 68.528 0 26.664 5.942 62.194 7.042 68.528 76.076 4.128 136.756 70.108 136.756 150.618 0 27.01-10.084 52.898-12.234 58.108l87.518 51.142c0.056 0.004 0.122 0.004 0.194 0.004 1.28 0 2.494-0.492 2.922-0.78 1.636-1.838 14.71-16.296 33.534-30.714 28.066-21.496 54.736-32.392 79.27-32.392 24.77 0 51.636 11.104 79.87 33.012C622.808 824.538 635.932 839.264 637.564 841.126L637.564 841.126zM524.326 650.038c-72.942 0-132.284-62.018-132.284-138.242 0-76.222 59.342-138.238 132.284-138.238 72.944 0 132.286 62.014 132.286 138.238C656.612 588.02 597.27 650.038 524.326 650.038L524.326 650.038zM524.326 420.578c-48.13 0-87.29 40.92-87.29 91.216 0 50.298 39.16 91.218 87.29 91.218 48.134 0 87.292-40.92 87.292-91.218C611.62 461.498 572.462 420.578 524.326 420.578L524.326 420.578z"></path></symbol><symbol id="icon-yinliang-copy" viewBox="0 0 1024 1024"><path d="M678.569984 354.628608c-2.898944-7.727104-8.73472-13.999104-16.164864-17.391616-6.076416-3.41504-13.274112-4.893696-20.66432-3.729408-17.586176 2.770944-29.575168 19.423232-26.774528 37.19168 1.586176 10.061824 7.575552 18.320384 15.665152 23.092224 31.039488 33.216512 50.143232 77.703168 50.143232 126.763008 0 53.681152-22.890496 101.904384-59.286528 135.862272-6.747136 5.82144-11.02336 14.427136-11.02336 24.0384 0 17.531904 14.212096 31.744 31.745024 31.744 8.97536 0 17.074176-3.730432 22.847488-9.71776 6.161408-3.576832 10.970112-9.237504 13.513728-16.031744 39.776256-43.931648 64.222208-101.956608 64.222208-165.894144C742.791168 456.604672 718.345216 398.590976 678.569984 354.628608z"></path><path d="M789.633024 238.830592c-5.279744-10.749952-16.3328-18.152448-29.118464-18.152448-17.907712 0-32.425984 14.518272-32.425984 32.427008 0 11.754496 6.254592 22.048768 15.619072 27.73504 54.951936 57.501696 88.880128 135.248896 88.880128 221.06624 0 96.089088-42.518528 182.078464-109.546496 240.768l0.124928 0.145408c-10.517504 5.219328-17.752064 16.063488-17.752064 28.601344 0 17.626112 14.288896 31.915008 31.915008 31.915008 10.4704 0 19.762176-5.042176 25.581568-12.829696 0.280576-0.333824 0.562176-0.667648 0.831488-1.012736l0.080896 0.080896c80.111616-70.1184 130.968576-172.84096 130.968576-287.6672C894.793728 399.910912 854.69696 307.396608 789.633024 238.830592z"></path><path d="M448.487424 183.721984 289.050624 346.851328 191.880192 346.851328c-41.570304 0-62.021632 22.37952-62.021632 62.032896l0 206.718976c0 39.005184 21.098496 62.042112 62.021632 62.042112l97.171456 0 159.435776 163.109888c45.809664 43.02336 115.52256 24.064 115.52256-47.366144L564.009984 231.07584C564.009984 158.90944 493.427712 141.606912 448.487424 183.721984zM501.989376 761.613312c0 46.959616-20.816896 20.632576-42.176512-0.446464-37.228544-36.745216-93.476864-96.119808-139.710464-145.563648l-86.875136 0c-31.434752 0-41.347072-10.541056-41.347072-41.347072L191.880192 450.22208c0-30.152704 10.559488-41.337856 41.347072-41.337856l87.842816 0c45.993984-49.707008 101.695488-108.972032 138.902528-145.384448 21.117952-20.663296 42.015744-47.586304 42.015744 1.302528C501.989376 365.810688 501.989376 662.644736 501.989376 761.613312z"></path></symbol><symbol id="icon-quanping" viewBox="0 0 1024 1024"><path d="M223.744 590.336h-37.376v242.176h241.664v-36.864H223.744v-205.312z" fill=""></path><path d="M443.392 847.872H171.008v-273.408h68.096v205.312h204.288z" fill=""></path><path d="M201.728 817.152h210.944v-6.144H208.384v-205.312h-6.656zM573.952 795.136v37.376h242.176v-241.664h-36.864v204.288z" fill=""></path><path d="M831.488 847.872H558.08v-68.096h205.312v-204.288h67.584v272.384z" fill=""></path><path d="M589.312 817.152h211.968v-210.944h-6.144v204.288h-205.312v6.656zM428.544 228.864v-37.888H185.856v242.176h36.864V228.864z" fill=""></path><path d="M238.08 448.512H170.496V175.616h273.408v68.096H238.08z" fill=""></path><path d="M201.216 417.792h6.144V213.504h205.312v-6.656H201.216zM778.24 433.664h37.888V191.488h-242.176v36.864H778.24z" fill=""></path><path d="M831.488 449.024H762.88V243.712h-204.288V176.128h272.384v272.896z" fill=""></path><path d="M793.6 418.304h6.656V206.848h-210.944v6.144H793.6z" fill=""></path></symbol><symbol id="icon-zhongxinbofang" viewBox="0 0 1024 1024"><path d="M585.00608 88.21248c-237.89056 0-431.44704 193.99168-431.44704 432.42496a432.55296 432.55296 0 0 0 2.52416 46.7968L68.6592 478.94528a34.14016 34.14016 0 0 0-48.5632 47.98464l141.49632 143.20128a47.0528 47.0528 0 0 0 33.67936 14.03904c0.02048 0 0.04096 0 0.0256 0.03584a47.22688 47.22688 0 0 0 33.65376-14.09024l141.45024-143.1808a34.16064 34.16064 0 0 0-48.5632-47.98976l-95.80032 96.9728a368.37888 368.37888 0 0 1-4.20864-55.28064c0-200.79104 162.93376-364.16 363.18208-364.16 200.27392 0 363.20256 163.36384 363.20256 364.16 0 200.77056-162.93376 364.10368-363.20256 364.10368a359.84896 359.84896 0 0 1-257.664-107.52 320.49664 320.49664 0 0 1-8.192-8.4992 34.14016 34.14016 0 0 0-48.78848 47.74912 427.8528 427.8528 0 0 0 314.64448 136.52992c237.90592 0 431.46752-193.95072 431.46752-432.36864-0.00512-238.42816-193.56672-432.41984-431.47264-432.41984z" fill="#7B7B7B"></path></symbol><symbol id="icon-bofang" viewBox="0 0 1024 1024"><path d="M139.7 64.9v894.2L884.3 512z" fill="#5C5C5C"></path></symbol><symbol id="icon-quxiaoquanping" viewBox="0 0 1024 1024"><path d="M17.066667 795.306667h211.626666V1006.933333h141.653334V653.653333H17.066667v141.653334z m211.626666-566.613334H17.066667v141.653334h353.28V17.066667h-141.653334v211.626666zM653.653333 1006.933333h141.653334V795.306667H1006.933333v-141.653334H653.653333V1006.933333z m141.653334-778.24V17.066667h-141.653334v353.28H1006.933333v-141.653334H795.306667z"></path></symbol><symbol id="icon-play1" viewBox="0 0 1024 1024"><path d="M512 0C229.76 0 0 229.76 0 512s229.76 512 512 512 512-229.76 512-512-229.76-512-512-512z m0 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zM435.2 277.76a35.712 35.712 0 0 0-19.84-7.04c-16.64 0-32 12.8-32 32v418.56c0 19.2 15.36 32 32 32 7.04 0 14.08-1.92 19.84-7.04l257.92-209.28a32 32 0 0 0 0-49.92L435.2 277.76z m11.52 376.32V369.92L622.08 512l-175.36 142.08z" fill="#444444"></path></symbol><symbol id="icon-ic_replay_px" viewBox="0 0 1024 1024"><path d="M512 213.333333V42.666667L298.666667 256l213.333333 213.333333v-170.666666c141.44 0 256 114.56 256 256s-114.56 256-256 256-256-114.56-256-256H170.666667c0 188.586667 152.746667 341.333333 341.333333 341.333333s341.333333-152.746667 341.333333-341.333333-152.746667-341.333333-341.333333-341.333334z" fill=""></path></symbol><symbol id="icon-done" viewBox="0 0 1024 1024"><path d="M511.67197 0.765403a511.617298 511.617298 0 1 0 511.726642 511.562627A511.617298 511.617298 0 0 0 511.67197 0.765403z m293.477416 378.819861l-330.927496 330.872825a46.197544 46.197544 0 0 1-65.60598 0L218.686599 520.255419a46.416231 46.416231 0 0 1 65.60598-65.60598l157.235664 157.454352 298.124507-298.179178a46.361559 46.361559 0 0 1 68.230218 62.763054 38.270155 38.270155 0 0 1-2.788254 2.952269z"></path></symbol><symbol id="icon-shanchu1" viewBox="0 0 1024 1024"><path d="M32.035491 1023.976262a32.000116 32.000116 0 0 1-22.644446-54.62129l456.915116-457.380572L9.391045 54.454191A32.000116 32.000116 0 0 1 54.679937 9.235117l479.419925 480.025018a31.976844 31.976844 0 0 1 0 45.219074l-479.419925 480.025018a31.813934 31.813934 0 0 1-22.644446 9.472035z m960.143128 0a31.813934 31.813934 0 0 1-22.644446-9.309125l-479.419926-480.025018a31.976844 31.976844 0 0 1 0-45.219074L969.534173 9.398027a32.000116 32.000116 0 0 1 45.288892 45.219073L557.907949 511.9744l456.915116 457.310754a32.000116 32.000116 0 0 1-22.644446 54.691108z"></path></symbol><symbol id="icon-zanting" viewBox="0 0 1024 1024"><path d="M119.289 0h181.567v1024H119.289zM721.759 0h182.952v1024H721.759z"></path></symbol><symbol id="icon-praise" viewBox="0 0 1024 1024"><path d="M287.922748 327.842488c-4.421079 2.275555-13.328252 6.664126-20.853838 10.402538l-12.369268 6.176507-11.556569-7.476825a95.638334 95.638334 0 0 0-51.655103-16.416505H95.362017A95.45954 95.45954 0 0 0 0 415.776442v512.812617A95.45954 95.45954 0 0 0 95.362017 1023.999837h96.125953a92.355033 92.355033 0 0 0 76.930019-41.122533l9.4273-13.815871 16.253966 4.063492c26.006345 6.339047 67.535227 16.091426 123.708933 28.932059A937.853819 937.853819 0 0 0 608.971078 1023.999837H784.091304c54.385769 0 92.745128-20.479997 113.972807-60.952371A1093.339255 1093.339255 0 0 0 1023.999837 444.87104c0-57.376499-46.990215-97.036175-90.729636-109.551728-31.597709-8.289522-100.238206-9.752379-195.25889-12.027935l-75.808495-1.787936 3.44584-26.493964a621.892981 621.892981 0 0 0 3.559619-79.644432C669.208275 108.73903 589.937684 0 512.113696 0a95.898397 95.898397 0 0 0-95.394524 94.59808c-1.771682 144.822834-81.464876 208.2133-128.796424 233.244408z"></path></symbol><symbol id="icon-play" viewBox="0 0 1024 1024"><path d="M900.506923 407.270163L246.46493 18.029536C229.112396 8.498257 170.621177-13.647951 125.641949 11.862238S70.388562 69.470411 70.388562 90.775624v845.340374c0 14.156753-5.606635 59.149998 57.902522 79.614216a160.672139 160.672139 0 0 0 118.173846-6.868128l654.041993-389.240627c23.828198-14.156753 52.912617-45.83424 52.912616-109.749878s-31.453222-87.323338-52.912616-102.601418zM253.879705 790.483657V236.407965L712.446372 513.375728z"></path></symbol><symbol id="icon-pause" viewBox="0 0 1024 1024"><path d="M126.246575 98.191781c0-54.229918 44.074082-98.191781 98.191781-98.191781 54.229918 0 98.191781 44.003945 98.191781 98.191781v827.616438c0 54.229918-44.074082 98.191781-98.191781 98.191781-54.229918 0-98.191781-44.003945-98.191781-98.191781V98.191781z m575.123288 0c0-54.229918 44.074082-98.191781 98.191781-98.191781 54.229918 0 98.191781 44.003945 98.191781 98.191781v827.616438c0 54.229918-44.074082 98.191781-98.191781 98.191781-54.229918 0-98.191781-44.003945-98.191781-98.191781V98.191781z"></path></symbol><symbol id="icon-down" viewBox="0 0 1053 1024"><path d="M488.806044 847.474529c6.06441 5.333758 13.268636 9.220826 21.042771 11.398168a42.377803 42.377803 0 0 0 32.382487 0 36.386459 36.386459 0 0 0 21.042771-11.398168l396.55395-396.597789a44.642824 44.642824 0 1 0-63.128314-63.128314l-330.254607 330.254607V41.565611a40.463496 40.463496 0 1 0-80.926991 0v676.437422l-330.254607-330.254607a44.642824 44.642824 0 1 0-63.128314 63.128314L488.806044 847.474529z m522.82519 95.569253H40.463496a40.405044 40.405044 0 0 0 0 80.810088h971.167738a40.405044 40.405044 0 0 0 0-80.810088z"></path></symbol><symbol id="icon-praise-line" viewBox="0 0 1033 1024"><path d="M290.445428 327.699711c-4.45146 2.299647-13.436509 6.734681-21.041771 10.512673l-12.467372 6.241899-11.662496-7.555983a97.505037 97.505037 0 0 0-52.103433-16.426051h-96.913699a95.862432 95.862432 0 0 0-96.207379 95.271094v512.821302a95.82958 95.82958 0 0 0 96.207379 95.271094h96.913699a93.431376 93.431376 0 0 0 77.596664-41.065126l9.510683-13.797883 16.426051 3.942252c26.199551 6.40616 68.135258 16.09753 124.837985 28.90985a949.031505 949.031505 0 0 0 192.841835 22.010907H791.078601c54.846583 0 93.546359-20.532563 114.982355-60.940648a1086.451845 1086.451845 0 0 0 126.956946-518.077638c0-57.491177-47.405582-97.07796-91.542381-109.561758-31.866538-8.213025-101.102342-9.85563-196.948347-11.991017l-76.479692-1.806866 3.465896-26.610202a612.198909 612.198909 0 0 0 3.597305-79.502085C675.110683 108.740456 595.148669 0 516.632146 0a96.388065 96.388065 0 0 0-96.223805 94.614052c-1.823292 144.713507-82.212384 208.282323-129.962913 233.085659zM226.186718 928.400385a33.032788 33.032788 0 0 1-33.049214 32.852101h-96.913699a33.016362 33.016362 0 0 1-33.049214-32.852101V415.743343a33.016362 33.016362 0 0 1 33.049214-32.852101h96.913699a33.016362 33.016362 0 0 1 33.049214 32.852101v512.657042zM483.402246 95.271094a32.999936 32.999936 0 0 1 33.049214-32.687841c36.777927 0 95.271094 69.974976 95.271094 152.926532 0 76.873917-3.36734 90.179018-29.566892 167.381457 304.440423 0 318.533975 3.942252 344.142188 10.841193l4.254348 1.149824a50.345845 50.345845 0 0 1 39.208983 49.935194c0 6.40616-0.098556 8.541546-0.279243 11.333975l-0.312095 6.406159c-13.239397 315.872955-114.1282 464.035932-118.4154 470.113571-7.983061 14.290664-21.206031 28.745589-59.692268 28.745589H614.334296a908.804107 908.804107 0 0 1-179.158935-20.532563c-80.487648-18.397177-115.278024-26.610202-131.934039-30.716715l-18.627142-4.599294 4.927816-507.729227 13.994995-6.570421C463.54315 317.67982 482.597369 159.825473 483.402246 95.271094z"></path></symbol><symbol id="icon-arrow-down-new" viewBox="0 0 1024 1024"><path d="M511.872 676.8c-0.003 0-0.006 0-0.008 0-9.137 0-17.379-3.829-23.21-9.97l-251.277-265.614c-5.415-5.72-8.743-13.464-8.744-21.984 0-17.678 14.33-32.008 32.008-32.008 9.157 0 17.416 3.845 23.25 10.009l228.045 241.103 228.224-241.088c5.855-6.165 14.113-10.001 23.266-10.001 8.516 0 16.256 3.32 21.998 8.736 12.784 12.145 13.36 32.434 1.264 45.233l-251.52 265.6c-5.844 6.155-14.086 9.984-23.223 9.984-0.025 0-0.051 0-0.076 0z"></path></symbol><symbol id="icon-fenxiang1" viewBox="0 0 1024 1024"><path d="M820.691478 1024H203.308522c-42.622145 0-77.185855-34.801159-77.185855-77.734957V388.645101c0-42.933797 34.56371-77.720116 77.185855-77.720115h128.623304v51.808463H203.308522a25.822609 25.822609 0 0 0-25.733565 25.911652v557.619942a25.822609 25.822609 0 0 0 25.733565 25.911653h617.382956a25.822609 25.822609 0 0 0 25.733565-25.911653V388.645101a25.822609 25.822609 0 0 0-25.733565-25.911652h-128.623304v-51.808463h128.623304c42.622145 0 77.171014 34.786319 77.171015 77.720115v557.619942c0 42.933797-34.54887 77.734957-77.171015 77.734957z m-140.198956-770.344812l-142.766377-151.04742v622.859131h-51.45229V102.340638l-142.766377 151.31455-37.309217-35.750956L476.493913 37.561507l-1.79571-1.81055L511.99258 0l37.309217 35.750957-1.810551 1.81055 170.310493 180.342725-37.309217 35.750956z"></path></symbol><symbol id="icon-xingzhuang8" viewBox="0 0 1212 1024"><path d="M608.820484 64.179444C661.042051 24.029735 725.901346 15.406979 790.194773 7.053684a825.143881 825.143881 0 0 1 264.961132 8.083834 526.203701 526.203701 0 0 1 86.038939 23.982041 170.703628 170.703628 0 0 1 50.254502 32.604797A77.470076 77.470076 0 0 1 1212.575098 132.08365q0.242515 284.955148 0 569.371374c0 86.227563 0.242515 172.724586-0.188622 258.952149a59.281449 59.281449 0 0 1-22.904197 52.814382 56.047916 56.047916 0 0 1-58.634742 3.233533 199.401238 199.401238 0 0 0-45.538932-15.628745 1168.518203 1168.518203 0 0 0-241.491067-11.85629c-52.167675 1.886228-104.146728 9.970062-156.287457 15.898207a34.814378 34.814378 0 0 0-16.841321 6.197606 70.706601 70.706601 0 0 1-46.212584 11.856289c-20.667669-0.808383-41.362284-1.347306-61.976061-2.42515a15.197608 15.197608 0 0 1-7.62575-2.155689c-44.434141-26.676652-94.63475-23.443119-142.949131-27.215574a1076.308604 1076.308604 0 0 0-141.386256-2.155689c-54.080849 2.694611-108.053914 8.892217-161.838357 15.898207a303.440182 303.440182 0 0 0-45.107794 16.976051 49.580848 49.580848 0 0 1-58.09582-33.143719 183.826385 183.826385 0 0 1-5.389223-39.880248Q0 546.649603 0 144.748323c0-60.089833 18.862279-82.455107 70.059895-104.820381A478.02405 478.02405 0 0 1 209.694654 6.784223a874.347484 874.347484 0 0 1 265.015024 8.083834 509.092919 509.092919 0 0 1 72.296422 18.862279 628.033063 628.033063 0 0 1 61.814384 30.449108zM578.748621 921.604769v-15.628745l-0.323353-312.574915q0-230.389269 0.538922-461.047998a31.203599 31.203599 0 0 0-15.332338-30.179647 172.185664 172.185664 0 0 0-41.901206-19.670663 924.925339 924.925339 0 0 0-114.359305-21.826351 778.742674 778.742674 0 0 0-272.398259 14.820362 346.122825 346.122825 0 0 0-64.886241 26.407191 30.529946 30.529946 0 0 0-16.167668 30.718569q0.458084 387.215648 0.242515 774.970219c0 3.502995 0.296407 7.275451 0.377245 8.622756a341.137794 341.137794 0 0 1 40.41917-22.904197A502.275552 502.275552 0 0 1 268.329396 862.32332c45.808393-1.347306 91.886246 0.808383 137.748531 3.233534a443.344402 443.344402 0 0 1 122.497031 23.71258 97.006008 97.006008 0 0 1 50.173663 32.335335zM1022.093024 64.179444v492.036029a11.640721 11.640721 0 0 1-2.694612 1.347306c-39.476056-40.688631-78.952112-81.646723-119.506012-123.413199-40.149709 41.497014-79.625765 82.455107-119.074875 123.413199-0.916168-0.269461-1.832336-0.808383-2.694611-1.077845V63.1016a410.739605 410.739605 0 0 0-107.029962 26.676652 154.589852 154.589852 0 0 0-25.248508 15.359284 27.808389 27.808389 0 0 0-11.505991 23.982041q0.242515 391.257565 0.161677 782.784592a10.185631 10.185631 0 0 0 0.592814 4.041917 345.314442 345.314442 0 0 1 39.772464-22.634736A502.84142 502.84142 0 0 1 843.655861 862.32332a829.94029 829.94029 0 0 1 211.338367 12.664673 188.622793 188.622793 0 0 1 104.308404 45.00001v-12.664674c-0.242515-54.431149-0.700599-109.131759-0.700598-163.562907 0-68.98205 0.619761-137.9641 0.673652-206.676689 0-132.844339-0.404192-265.688677 0.511977-398.533016a43.113781 43.113781 0 0 0-25.787431-43.113781 350.46115 350.46115 0 0 0-111.907208-31.257492z"></path></symbol><symbol id="icon-xingzhuang9" viewBox="0 0 1170 1024"><path d="M1066.790472 74.786141H1036.766305v59.243789h30.097308a42.220342 42.220342 0 0 1 44.908254 38.764454v753.164094a42.238627 42.238627 0 0 1-44.908254 38.947305H103.420639a42.183772 42.183772 0 0 1-44.8534-38.947305V172.794384a42.165487 42.165487 0 0 1 44.8534-38.764454h449.320254V74.786141H103.347498A100.952148 100.952148 0 0 0 0 172.794384v753.164094A100.842437 100.842437 0 0 0 103.347498 1023.966721h963.442974a100.897292 100.897292 0 0 0 103.420639-98.008243V172.794384a101.007003 101.007003 0 0 0-103.420639-98.008243zM239.973915 419.277802h222.365345a29.530469 29.530469 0 0 0 0-59.060938H239.973915a29.530469 29.530469 0 0 0 0 59.060938z m0 123.973114a29.621894 29.621894 0 0 0 0 59.243789h296.456651a29.621894 29.621894 0 0 0 0-59.243789H239.973915z m-29.256192 212.838797a29.256192 29.256192 0 0 0 29.256192 29.439043H610.540157a29.530469 29.530469 0 0 0 0-59.060938H239.973915a29.384188 29.384188 0 0 0-29.256192 29.621895z m449.320254-210.461732v0.914256h0.511984l139.936023 235.695197 139.917739-235.695197h0.475413v-0.914256l0.457128-0.731404h-0.457128V140.795424a140.429722 140.429722 0 1 0-280.841159 0v404.101153h-0.420557z m140.448007 159.994801l-72.043373-121.413197h144.050176zM718.605217 140.795424a81.917338 81.917338 0 0 1 163.834675 0v404.101153H718.605217V140.795424z"></path></symbol><symbol id="icon-xingzhuang10" viewBox="0 0 1749 1024"><path d="M874.666667 938.24c321.536 0 756.565333-320 787.456-408.32-11.818667-96.853333-422.4-445.866667-787.456-445.866667-347.861333 0-787.456 278.186667-787.456 447.573334 9.088 84.053333 431.402667 406.613333 787.456 406.613333m0 85.76C509.568 1024 0 689.066667 0 533.333333 0 286.293333 513.152 0 874.666667 0 1270.656 0 1749.333333 375.466667 1749.333333 533.333333 1749.333333 664.32 1226.154667 1024 874.666667 1024z m0-299.52a213.333333 213.333333 0 1 0-218.88-213.333333 216.277333 216.277333 0 0 0 218.88 213.333333m0 86.186667a298.666667 298.666667 0 1 1 306.090666-298.666667 302.677333 302.677333 0 0 1-306.090666 298.666667z"></path></symbol><symbol id="icon-xingzhuang" viewBox="0 0 1157 1024"><path d="M420.997565 647.791304a37.843478 37.843478 0 0 1-17.363478 4.006957 38.600348 38.600348 0 0 1-33.658435-19.812174l-2.515478-5.565217-105.382957-231.735653a20.279652 20.279652 0 0 1-1.825391-8.236521 19.277913 19.277913 0 0 1 19.277913-19.144348 18.921739 18.921739 0 0 1 11.553391 3.784348l124.304696 88.820869a59.013565 59.013565 0 0 0 31.632696 9.349565 58.301217 58.301217 0 0 0 19.789913-3.561739L1051.581217 204.8C946.732522 80.806957 774.121739 0 578.782609 0 259.116522 0 0 216.375652 0 483.506087c0 145.808696 77.913043 276.925217 199.969391 365.523478a38.845217 38.845217 0 0 1 16.205913 31.610435 44.521739 44.521739 0 0 1-2.048 12.243478c-9.728 36.507826-25.33287 94.831304-26.045217 97.725218a52.624696 52.624696 0 0 0-3.116522 14.024347 19.322435 19.322435 0 0 0 19.277913 19.366957 22.038261 22.038261 0 0 0 11.130435-3.561739l126.70887-73.46087a60.104348 60.104348 0 0 1 30.72-8.904348 54.00487 54.00487 0 0 1 17.029565 2.671305 687.86087 687.86087 0 0 0 188.928 26.490435c319.643826 0 578.782609-216.598261 578.782609-483.728696a419.127652 419.127652 0 0 0-65.914435-223.944348L425.182609 645.342609z"></path></symbol><symbol id="icon-xingzhuang1" viewBox="0 0 1024 1024"><path d="M1023.360799 700.990429V196.873908A196.845499 196.845499 0 0 0 826.699958 0h-629.399916A196.845499 196.845499 0 0 0 0.639201 196.873908v630.252184a196.746067 196.746067 0 0 0 196.660841 196.873908h629.399916a196.831294 196.831294 0 0 0 193.592676-162.072964C968.133833 839.341934 742.11236 741.473159 624.357331 685.365515c-89.48814 108.66417-183.507505 173.862672-324.941379 173.862672s-235.794146-87.35747-224.558413-194.033014c7.457345-70.170065 55.52526-184.658066 264.004217-165.055903 109.871549 10.227216 160.141157 30.823693 249.842364 60.368984a711.33128 711.33128 0 0 0 57.130365-139.203773H248.436122v-39.346373h196.646636V311.077819H205.183521v-43.465668h239.757192v-101.98807a19.17603 19.17603 0 0 1 19.886253-16.051047H563.13608v118.181162h255.680399v43.465668h-255.680399v70.880289h208.635206a803.163157 803.163157 0 0 1-84.743848 212.640865C747.666306 616.615897 1023.360799 700.990429 1023.360799 700.990429z m-739.56976 90.482452c-149.459398 0-173.138244-94.459703-165.24056-133.94812s51.13608-90.482452 134.274823-90.482453c95.553447 0 181.021723 24.431683 283.734221 74.431405-72.187099 94.033569-160.72354 149.999168-252.768484 149.999168z"></path></symbol><symbol id="icon-xingzhuang2" viewBox="0 0 1024 1024"><path d="M289.714302 291.475655a49.459953 49.459953 0 0 0-31.604939 10.511306 33.934471 33.934471 0 0 0 0 54.261062 50.454266 50.454266 0 0 0 31.604939 10.511306 36.121959 36.121959 0 0 0 38.124788-38.067971 36.050936 36.050936 0 0 0-10.539714-27.272576 38.35206 38.35206 0 0 0-27.585074-9.943127z m312.114745 220.027189a27.997004 27.997004 0 0 0-21.065224 9.516992 30.298127 30.298127 0 0 0-9.019836 21.164656 29.971425 29.971425 0 0 0 9.019836 21.02261 28.139048 28.139048 0 0 0 21.065224 9.659038 41.732723 41.732723 0 0 0 27.102122-9.090859 26.61917 26.61917 0 0 0 11.051075-21.164655 28.224275 28.224275 0 0 0-11.051075-21.59079 39.772507 39.772507 0 0 0-27.102122-9.516992zM1023.360799 155.822999A156.036066 156.036066 0 0 0 867.79348 0h-711.643778A156.05027 156.05027 0 0 0 0.639201 155.822999v712.496047a156.05027 156.05027 0 0 0 155.567319 155.680954h711.643778A156.036066 156.036066 0 0 0 1023.360799 868.319046V155.822999zM389.060341 679.399639a671.033208 671.033208 0 0 1-106.405659-15.198779l-106.40566 53.26675 30.127674-91.476765q-121.433985-85.2268-121.433985-205.964766a231.731669 231.731669 0 0 1 88.834734-182.953531 322.043668 322.043668 0 0 1 215.282896-75.283673 340.907199 340.907199 0 0 1 199.217645 60.795117 243.194673 243.194673 0 0 1 106.888611 152.271883c-10.710168-0.710223-20.411819-0.994313-29.104952-0.994313a257.953114 257.953114 0 0 0-182.683645 70.31211 224.118075 224.118075 0 0 0-75.283673 169.885421 236.802663 236.802663 0 0 0 9.019836 64.204189c-10.710168 0.710223-20.070911 0.994313-28.096435 0.994313z m448.633875 106.391455l22.10215 76.420031-83.309197-46.164517a391.773394 391.773394 0 0 1-91.348925 16.051048 269.884866 269.884866 0 0 1-182.669441-64.914413 199.785823 199.785823 0 0 1 0-312.498266 286.930226 286.930226 0 0 1 363.847413 0.568179q77.769455 65.198502 77.783659 155.680954 0 95.454016-106.405659 174.856984z m-69.246775-274.28825a28.636205 28.636205 0 0 0-20.582272 9.516992 29.531086 29.531086 0 0 0-9.545402 21.164656 29.232792 29.232792 0 0 0 9.545402 21.02261 28.820863 28.820863 0 0 0 20.582272 9.659038 41.192953 41.192953 0 0 0 27.599278-9.090859 27.073713 27.073713 0 0 0 10.52551-21.164655 28.74984 28.74984 0 0 0-10.52551-21.59079 39.388986 39.388986 0 0 0-27.599278-9.516992zM502.497212 366.759329a36.136163 36.136163 0 0 0 38.124788-38.067971 36.079345 36.079345 0 0 0-10.539714-27.272576 38.35206 38.35206 0 0 0-27.585074-9.943127 49.459953 49.459953 0 0 0-31.604938 10.511306 33.934471 33.934471 0 0 0 0 54.261062 50.440061 50.440061 0 0 0 31.604938 10.511306z"></path></symbol><symbol id="icon-xingzhuangkaobei" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512A512 512 0 0 0 512 0z m276.16 380.96L441.92 727.36a19.008 19.008 0 0 1-26.56-1.76l-23.2-23.2-155.2-155.2a19.792 19.792 0 0 1 0-28.16l42.4-42.4a20.096 20.096 0 0 1 28.16 0l121.92 122.08 288.16-288.16a18.864 18.864 0 0 1 26.56 1.76l42.24 42.24a18.672 18.672 0 0 1 1.76 26.4z"></path></symbol><symbol id="icon-touxiang" viewBox="0 0 1024 1024"><path d="M914.272 802.848q0 68.576-41.728 108.288t-110.848 39.712H262.272q-69.152 0-110.848-39.712t-41.728-108.288q0-30.272 2.016-59.136t8-62.272 15.136-62.016 24.576-55.712 35.424-46.272 48.864-30.56 63.712-11.424q5.152 0 24 12.288t42.56 27.424 61.728 27.424T512 554.88t76.288-12.288 61.728-27.424 42.56-27.424 24-12.288q34.848 0 63.712 11.424t48.864 30.56 35.424 46.272 24.576 55.712 15.136 62.016 8 62.272 2.016 59.136zM731.424 292.576q0 90.848-64.288 155.136T512 512t-155.136-64.288-64.288-155.136 64.288-155.136T512 73.152t155.136 64.288 64.288 155.136z"></path></symbol><symbol id="icon-xin" viewBox="0 0 1164 1024"><path d="M1123.1869446875 325.13635625v-1.3175409375l0.338795625-6.211261875c0-2.2586409375 0.15057562500000002-4.5172809375 0.2070421875-6.775921875v-1.69398-9.7874428125c0-1.1293199999999999 0-3.5761809374999998-0.2070421875-6.964141875a235.0868446875 235.0868446875 0 0 0-11.7637528125-69.07675875c-1.8822009375-5.458381875000001-3.9526209374999994-10.728542812499999-6.0230418750000005-15.9987046875l-0.22586343749999999-0.5646599999999999a267.4042275 267.4042275 0 0 0-55.826068125-90.5338453125c-1.8822009375-2.0704209375-3.500893125-3.5761809374999998-4.4796365625000005-4.5172809375a11.293202812499999 11.293202812499999 0 0 0-1.4681165624999999-1.5057609374999998 222.58903312500001 222.58903312500001 0 0 0-48.9372140625-37.8322303125 220.330393125 220.330393125 0 0 0-23.791014375000003-12.798963749999999A231.924748125 231.924748125 0 0 0 914.7520587500001 39.982977500000004a8.3381484375 8.3381484375 0 0 0-2.4656821875-0.5646609375 269.8887328125 269.8887328125 0 0 0-138.98168625 3.5761809374999998 281.78424 281.78424 0 0 0-56.8989225 22.3981865625c-6.154795312499999 3.0115209375000003-12.328413750000001 6.211261875-18.596140312499998 9.5992228125-1.0540321875 0.75288-2.0704209375 1.31754-3.0679875 2.0704200000000004-0.39526218750000003 0.18822-2.6350809375 1.8822009375-6.135973125 4.517281875a310.5630853125 310.5630853125 0 0 0-70.82720625 62.677276875c-1.76926875 2.0704209375-3.5197153125000002 3.9526209374999994-5.194873125 6.0230418750000005l-11.293202812499999 13.17540375c-4.536103125 5.458381875000001-9.411002812500001 11.1049828125-14.3611903125 16.9398046875l-9.109850625 10.728542812499999-9.109850625-10.728542812499999c-4.9313653125000005-5.834821875-9.82508625-11.4814228125-14.361189375-16.9398046875l-11.29320375-13.17540375c-1.67515875-2.0704209375-3.4256053125-3.9526209374999994-5.194873125-6.0230418750000005a310.1866453125 310.1866453125 0 0 0-70.808383125-62.677276875c-3.500893125-2.6350809375-5.740711875000001-4.3290609374999995-6.1359740625-4.517281875-0.9975665625-0.75288-2.013954375-1.31754-3.0679865625-2.0704200000000004q-9.411002812500001-5.0819409375-18.614963437500002-9.5992228125A281.59601999999995 281.59601999999995 0 0 0 382.3528203125 42.99449750000002 269.8887328125 269.8887328125 0 0 0 243.3711340625 39.41831656249997a8.2063940625 8.2063940625 0 0 0-2.465683125 0.5646609375A231.924748125 231.924748125 0 0 0 184.64647718749995 59.55786218750001a269.1546740625 269.1546740625 0 0 0-72.65293968750001 50.6311940625 10.182705 10.182705 0 0 0-1.4681165624999999 1.5057609374999998 127.04853468750001 127.04853468750001 0 0 0-4.4984596875000005 4.5172809375A267.2724740625 267.2724740625 0 0 0 50.21971625000003 206.7459434375l-0.225864375 0.5646599999999999c-2.0704209375 5.270161875-4.1031975 10.5403228125-6.0230409375 15.9987046875a234.3904303125 234.3904303125 0 0 0-11.763753750000001 69.07675875c-0.1693978125 3.3879609375-0.2070421875 5.834821875-0.2070421875 6.964141875v11.4814228125c0 2.2586409375 0.1129321875 4.5172809375 0.2070421875 6.775921875s0.2070421875 4.140840937499999 0.319974375 6.211261875v1.3175409375a370.0782665625 370.0782665625 0 0 0 58.611723749999996 176.73862875 479.73526875 479.73526875 0 0 0 47.996113124999994 68.70031875 1325.5585378125 1325.5585378125 0 0 0 159.40356281249998 175.79752875h0.11293125l255.5463646875 236.4043846875a34.7830659375 34.7830659375 0 0 0 23.376930937500003 9.2227828125h0.22586343749999999a34.820709375 34.820709375 0 0 0 23.376930937500003-9.2227828125l255.5463646875-236.4043846875h0.1129321875a1325.5585378125 1325.5585378125 0 0 0 159.40356187499998-175.79752875 481.2974953125 481.2974953125 0 0 0 47.996113124999994-68.70031875 370.51117218750005 370.51117218750005 0 0 0 58.950520312500004-176.73862875zM810.2711084375001 694.2358775l-18.2949890625 15.6222646875-25.5791053125 23.9039465625c-62.6960990625 58.5364359375-147.73391906249998 137.4006375-188.370628125 175.0446478125-40.6367090625-37.6440103125-125.6745290625-116.508211875-188.370628125-175.0446478125l-25.5791053125-23.9039465625-18.2949890625-15.6222646875c-39.52621125-36.891130312499996-98.34497718749999-103.8974690625-98.34497625-103.897468125l-22.79344875-26.727247499999997a1448.9932481249998 1448.9932481249998 0 0 1-30.1152084375-36.1382503125c-11.293202812499999-15.245823750000001-20.704205625-28.7976675-28.552981875-40.65553125a487.301715 487.301715 0 0 1-45.41749875-82.2521625 307.11865875 307.11865875 0 0 1-18.031480312499998-79.2406415625c-0.6399478125-8.093461875-0.9599221874999999-16.5633646875-0.82816875-25.221487500000002v-0.9411a216.1519078125 216.1519078125 0 0 1 13.438911562500001-66.62989875000001 229.34613375 229.34613375 0 0 1 44.0246709375-70.39429875c0.6399478125-0.5646599999999999 0.9599221874999999-0.9411 1.5810478125-1.5057609374999998s1.2798965625-1.31754 1.8822009375-2.0704209375a187.260129375 187.260129375 0 0 1 35.159505-26.3508065625 1.22343 1.22343 0 0 1 0.63994875-0.37644l2.0704200000000004-1.1293209375a243.048553125 243.048553125 0 0 1 54.5838159375-21.645305625 228.423855 228.423855 0 0 1 23.18871-3.9526209374999994 231.002469375 231.002469375 0 0 1 128.5731178125 22.586405624999998 238.64420437500002 238.64420437500002 0 0 1 21.2876878125 12.23430375 448.7354259375 448.7354259375 0 0 1 57.538869375000004 50.8194140625c3.46324875 3.9526209374999994 9.411002812500001 10.728542812499999 16.3186790625 19.010225625l13.6271315625 15.998703749999999c17.5421090625 20.704205625 35.5359459375 42.16129125 35.761809375 42.5377321875a35.366548124999994 35.366548124999994 0 0 0 3.764401875 3.7644009375000005 35.761810312499996 35.761810312499996 0 0 0 16.9398046875 8.093461875c0.9411 0.18822 1.8822009375 0.18822 2.8421221875000002 0.37644h5.7971775c0.9411-0.18822 1.8822009375-0.18822 2.8421231249999996-0.37644a35.761810312499996 35.761810312499996 0 0 0 16.9398046875-8.093461875 35.366548124999994 35.366548124999994 0 0 0 3.7644009375000005-3.7644009375000005c0.3011521875-0.37644 18.2949890625-21.833525625 35.761810312499996-42.5377321875l13.6271315625-15.998703749999999c6.9264975-8.281681874999999 12.855429375-15.057603750000002 16.299855937500002-19.010225625a449.9588559375 449.9588559375 0 0 1 57.5576925-50.8194140625 236.0091234375 236.0091234375 0 0 1 21.2876878125-12.23430375 231.002469375 231.002469375 0 0 1 128.5731178125-22.586405624999998 227.106315 227.106315 0 0 1 23.1698878125 3.9526209374999994 248.45046843749998 248.45046843749998 0 0 1 54.583815 21.457085624999998 13.64595375 13.64595375 0 0 0 2.089243125 1.3175409375 1.1104987499999999 1.1104987499999999 0 0 1 0.6211256249999999 0.37644 187.4107059375 187.4107059375 0 0 1 35.178328125 26.3508065625c0.6399478125 0.75288 1.2798965625 1.31754 1.8822 2.0704209375s0.9411 0.9411 1.5810487500000001 1.5057609374999998a229.34613375 229.34613375 0 0 1 44.02467 70.39429875 216.8106778125 216.8106778125 0 0 1 13.438911562500001 66.62989875000001v0.9411c0.1129321875 8.6581228125-0.18822 17.128024687499998-0.84699 25.221487500000002a305.5564321875 305.5564321875 0 0 1-18.03148125 79.2406415625 485.6077340625 485.6077340625 0 0 1-45.4174978125 82.2521625c-7.811131874999999 11.857862812499999-17.2786003125 25.409706562500002-28.534160625 40.65553125-8.41343625 10.3521028125-18.31381125 22.3981865625-30.115207500000004 36.1382503125l-22.79344875 26.727247499999997s-58.36703812499999 67.00633875-97.9308928125 103.897468125z"></path></symbol><symbol id="icon-xin1" viewBox="0 0 1164 1024"><path d="M1123.1869446875 325.13635625v-1.3175409375l0.338795625-6.211261875c0-2.2586409375 0.15057562500000002-4.5172809375 0.2070421875-6.775921875v-1.69398-9.7874428125c0-1.1293199999999999 0-3.5761809374999998-0.2070421875-6.964141875a235.0868446875 235.0868446875 0 0 0-11.7637528125-69.07675875c-1.8822009375-5.458381875000001-3.9526209374999994-10.728542812499999-6.0230418750000005-15.9987046875l-0.22586343749999999-0.5646599999999999a267.4042275 267.4042275 0 0 0-55.826068125-90.5338453125c-1.8822009375-2.0704209375-3.500893125-3.5761809374999998-4.4796365625000005-4.5172809375a11.293202812499999 11.293202812499999 0 0 0-1.4681165624999999-1.5057609374999998 222.58903312500001 222.58903312500001 0 0 0-48.9372140625-37.8322303125 220.330393125 220.330393125 0 0 0-23.791014375000003-12.798963749999999A231.924748125 231.924748125 0 0 0 914.7520587500001 39.982977500000004a8.3381484375 8.3381484375 0 0 0-2.4656821875-0.5646609375 269.8887328125 269.8887328125 0 0 0-138.98168625 3.5761809374999998 281.78424 281.78424 0 0 0-56.8989225 22.3981865625c-6.154795312499999 3.0115209375000003-12.328413750000001 6.211261875-18.596140312499998 9.5992228125-1.0540321875 0.75288-2.0704209375 1.31754-3.0679875 2.0704200000000004-0.39526218750000003 0.18822-2.6350809375 1.8822009375-6.135973125 4.517281875a310.5630853125 310.5630853125 0 0 0-70.82720625 62.677276875c-1.76926875 2.0704209375-3.5197153125000002 3.9526209374999994-5.194873125 6.0230418750000005l-11.293202812499999 13.17540375c-4.536103125 5.458381875000001-9.411002812500001 11.1049828125-14.3611903125 16.9398046875l-9.109850625 10.728542812499999-9.109850625-10.728542812499999c-4.9313653125000005-5.834821875-9.82508625-11.4814228125-14.361189375-16.9398046875l-11.29320375-13.17540375c-1.67515875-2.0704209375-3.4256053125-3.9526209374999994-5.194873125-6.0230418750000005a310.1866453125 310.1866453125 0 0 0-70.808383125-62.677276875c-3.500893125-2.6350809375-5.740711875000001-4.3290609374999995-6.1359740625-4.517281875-0.9975665625-0.75288-2.013954375-1.31754-3.0679865625-2.0704200000000004q-9.411002812500001-5.0819409375-18.614963437500002-9.5992228125A281.59601999999995 281.59601999999995 0 0 0 382.3528203125 42.99449750000002 269.8887328125 269.8887328125 0 0 0 243.3711340625 39.41831656249997a8.2063940625 8.2063940625 0 0 0-2.465683125 0.5646609375A231.924748125 231.924748125 0 0 0 184.64647718749995 59.55786218750001a269.1546740625 269.1546740625 0 0 0-72.65293968750001 50.6311940625 10.182705 10.182705 0 0 0-1.4681165624999999 1.5057609374999998 127.04853468750001 127.04853468750001 0 0 0-4.4984596875000005 4.5172809375A267.2724740625 267.2724740625 0 0 0 50.21971625000003 206.7459434375l-0.225864375 0.5646599999999999c-2.0704209375 5.270161875-4.1031975 10.5403228125-6.0230409375 15.9987046875a234.3904303125 234.3904303125 0 0 0-11.763753750000001 69.07675875c-0.1693978125 3.3879609375-0.2070421875 5.834821875-0.2070421875 6.964141875v11.4814228125c0 2.2586409375 0.1129321875 4.5172809375 0.2070421875 6.775921875s0.2070421875 4.140840937499999 0.319974375 6.211261875v1.3175409375a370.0782665625 370.0782665625 0 0 0 58.611723749999996 176.73862875 479.73526875 479.73526875 0 0 0 47.996113124999994 68.70031875 1325.5585378125 1325.5585378125 0 0 0 159.40356281249998 175.79752875h0.11293125l255.5463646875 236.4043846875a34.7830659375 34.7830659375 0 0 0 23.376930937500003 9.2227828125h0.22586343749999999a34.820709375 34.820709375 0 0 0 23.376930937500003-9.2227828125l255.5463646875-236.4043846875h0.1129321875a1325.5585378125 1325.5585378125 0 0 0 159.40356187499998-175.79752875 481.2974953125 481.2974953125 0 0 0 47.996113124999994-68.70031875 370.51117218750005 370.51117218750005 0 0 0 58.950520312500004-176.73862875z"></path></symbol><symbol id="icon-faxianwei" viewBox="0 0 1024 1024"><path d="M751.532699 242.420532l-305.670114 141.134766a31.824793 31.824793 0 0 0-4.782494 2.632565 151.533399 151.533399 0 0 0-69.207223 131.628279l0.087752 2.486312a151.021512 151.021512 0 0 0 145.712504 145.814882h4.884872a151.401771 151.401771 0 0 0 129.434474-73.565583 19.46636 19.46636 0 0 0 1.243156-2.340058l149.924609-294.116076a39.488484 39.488484 0 0 0-51.627536-53.675087zM583.648143 553.209523a71.986043 71.986043 0 0 1-61.031646 34.077099h-2.354683a71.986043 71.986043 0 0 1-69.382729-69.47048v-2.486312a72.220049 72.220049 0 0 1 30.932646-61.42653l199.446093-92.139795zM965.691909 275.181348a39.488484 39.488484 0 0 0-69.938492 36.563411A432.79378 432.79378 0 1 1 732.168717 139.16546a39.503109 39.503109 0 0 0 40.219752-68.007944 511.88775 511.88775 0 1 0-299.936971 951.08744c13.469961 1.170029 26.88142 1.60879 40.234377 1.60879A512.034004 512.034004 0 0 0 965.691909 275.181348z" fill="#888888"></path></symbol><symbol id="icon-wodewei" viewBox="0 0 1024 1024"><path d="M769.367642 662.972352a377.70549 377.70549 0 0 0 127.841168-282.677923 385.183578 385.183578 0 0 0-770.305097 0 377.302108 377.302108 0 0 0 127.996315 282.677923C100.063274 710.292202 50.261071 883.126014 46.692689 981.334096A41.54838 41.54838 0 0 0 87.030922 1023.999535h1.55147a41.579409 41.579409 0 0 0 41.734556-39.872792c0.310294-10.239705 11.325735-251.027925 210.689692-251.027925a42.944703 42.944703 0 0 0 17.841911-4.033823 388.395122 388.395122 0 0 0 306.415421 0 42.944703 42.944703 0 0 0 17.841911 4.033823c198.277928 0 210.379398 240.633073 210.689692 251.183072A41.672497 41.672497 0 0 0 935.530131 1023.999535h1.551471a41.54838 41.54838 0 0 0 40.338233-42.665439c-3.568382-98.208082-53.370585-271.041894-208.052193-318.361744zM210.527972 380.294429A301.559319 301.559319 0 1 1 512.133835 678.021616a300.038878 300.038878 0 0 1-301.605863-297.727187z" fill="#888888"></path></symbol><symbol id="icon-zhuanlanwei" viewBox="0 0 1089 1024"><path d="M982.593302 32.133082l-19.745864-7.254871a413.354111 413.354111 0 0 0-152.983131-24.603472 396.44711 396.44711 0 0 0-152.983131 24.603472l-113.554489 46.683513-113.554489-46.683513a404.79021 404.79021 0 0 0-152.983131-24.603472 396.510196 396.510196 0 0 0-152.983131 24.603472l-19.745864 9.778304c-56.777244 22.08004-106.126133 93.524739-103.665786 155.03342v713.65842c0 51.730378 27.158449 86.112154 74.125847 86.112155a106.804305 106.804305 0 0 0 37.01561-7.412585l19.745863-7.25487a471.913531 471.913531 0 0 1 286.315027 0l123.41165 49.206945 130.824234-46.841227a475.067822 475.067822 0 0 1 286.299255 0l19.745864 7.412585a100.038351 100.038351 0 0 0 37.031381 7.412585c41.952075 0 74.04699-34.53949 74.04699-86.112154V189.689935a176.813802 176.813802 0 0 0-106.362705-157.556853z m24.68233 883.51701a19.714321 19.714321 0 0 1-7.396813-2.365719l-19.745864-5.046866a517.713841 517.713841 0 0 0-172.77631-29.492624 464.153974 464.153974 0 0 0-172.776309 29.492624l-93.792854 36.905209-93.792853-36.905209a517.713841 517.713841 0 0 0-172.77631-29.492624 473.348733 473.348733 0 0 0-172.776309 29.492624l-19.745864 7.412585a18.783805 18.783805 0 0 1-7.396813 2.523433V189.689935a108.25528 108.25528 0 0 1 56.777245-83.746436l17.348602-7.25487c64.174058-24.603473 185.12536-24.603473 249.299418 0l106.126133 41.794361v634.958851a37.062923 37.062923 0 0 0 74.125847 0V137.959557l103.665785-41.794361c64.174058-24.603473 185.12536-24.603473 249.299418 0l19.745864 7.412585a112.071972 112.071972 0 0 1 56.777244 86.112154v725.960157z" fill="#888888"></path></symbol><symbol id="icon-faxian" viewBox="0 0 1024 1024"><path d="M751.532699 242.274278l-305.670114 141.28102a31.824793 31.824793 0 0 0-4.782494 2.632565 151.284768 151.284768 0 0 0-69.207223 131.482025l0.087752 2.632566a151.021512 151.021512 0 0 0 145.712504 145.814882h4.884872a151.401771 151.401771 0 0 0 129.434474-73.565583 19.46636 19.46636 0 0 0 1.243156-2.340058l149.924609-294.116076a39.488484 39.488484 0 0 0-51.627536-53.821341zM965.691909 275.181348a39.488484 39.488484 0 0 0-69.938492 36.563411A431.901633 431.901633 0 1 1 732.168717 139.019207a39.488484 39.488484 0 1 0 40.219752-67.861691 511.88775 511.88775 0 1 0-299.936971 951.08744c13.469961 1.170029 26.88142 1.60879 40.234377 1.60879A512.048629 512.048629 0 0 0 965.691909 275.181348z" fill="#000000"></path></symbol><symbol id="icon-zhuanlan" viewBox="0 0 1089 1024"><path d="M982.593605 32.132776l-19.74587-7.254872a488.221367 488.221367 0 0 0-306.060985 0 490.94983 490.94983 0 0 0-59.931555 24.60348c-11.040023 7.570302-19.09924 11.986311-19.09924 40.690371v709.715775a37.062935 37.062935 0 0 1-74.12587 0v-709.715775c0-34.539501-8.20116-35.643503-21.48073-43.686949a433.415538 433.415538 0 0 0-52.566282-21.606902 404.790335 404.790335 0 0 0-152.983178-24.603481 396.510318 396.510318 0 0 0-152.983178 24.603481l-19.74587 9.778306c-56.777262 22.080046-106.126166 93.524768-103.665818 155.033468v713.65864c0 51.730394 27.158457 86.112181 74.12587 86.112181a106.804338 106.804338 0 0 0 37.01562-7.412587l19.74587-7.254872a471.913676 471.913676 0 0 1 286.315115 0l123.411688 49.20696 130.824274-46.841241a475.067968 475.067968 0 0 1 286.299344 0l19.74587 7.412587a100.038381 100.038381 0 0 0 37.031392 7.412587c41.952088 0 74.047013-34.539501 74.047012-86.112181V189.689678a176.813857 176.813857 0 0 0-106.173479-157.556902z" fill="#000000"></path></symbol><symbol id="icon-wode" viewBox="0 0 1024 1024"><path d="M769.367642 662.972352a377.70549 377.70549 0 0 0 127.841168-282.677923 385.183578 385.183578 0 0 0-770.305097 0 377.302108 377.302108 0 0 0 127.996315 282.677923C100.063274 710.292202 50.261071 883.126014 46.692689 981.334096A41.54838 41.54838 0 0 0 87.030922 1023.999535h1.55147a41.579409 41.579409 0 0 0 41.734556-39.872792c0.310294-10.239705 11.325735-251.027925 210.689692-251.027925a42.944703 42.944703 0 0 0 17.841911-4.033823 388.395122 388.395122 0 0 0 306.415421 0 42.944703 42.944703 0 0 0 17.841911 4.033823c198.277928 0 210.379398 240.633073 210.689692 251.183072A41.672497 41.672497 0 0 0 935.530131 1023.999535h1.551471a41.54838 41.54838 0 0 0 40.338233-42.665439c-3.568382-98.208082-53.370585-271.041894-208.052193-318.361744z" fill="#FF5A05"></path></symbol><symbol id="icon-xingzhuang3" viewBox="0 0 1024 1024"><path d="M871.298246 913.156491A110.753684 110.753684 0 0 1 760.598456 1024H263.401544A110.753684 110.753684 0 0 1 152.701754 913.156491V110.843509A110.753684 110.753684 0 0 1 263.401544 0h497.178947a110.753684 110.753684 0 0 1 110.69979 110.843509v802.312982zM807.415018 110.843509a46.852491 46.852491 0 0 0-46.816562-46.888421H263.401544a46.852491 46.852491 0 0 0-46.816562 46.888421v802.312982a46.852491 46.852491 0 0 0 46.816562 46.888421h497.178947a46.852491 46.852491 0 0 0 46.816562-46.888421V110.843509z m31.205052 705.122807H183.906807a15.988772 15.988772 0 0 1 0-31.977544H838.602105a15.988772 15.988772 0 0 1 0 31.977544z m0-640.089825H183.906807a15.988772 15.988772 0 0 1 0-31.977544H838.602105a15.988772 15.988772 0 0 1 0 31.977544zM551.936 884.053333a27.863579 27.863579 0 0 1-27.953404 27.845614h-7.976421a27.863579 27.863579 0 0 1-27.953403-27.845614v-8.08421a28.007298 28.007298 0 0 1 27.953403-28.025263h7.976421a28.007298 28.007298 0 0 1 27.953404 28.025263v8.08421z m32.336842-423.79228a18.324211 18.324211 0 0 1-5.389474-0.898246 16.042667 16.042667 0 0 1-9.772912-20.48l4.329544-12.395789a16.006737 16.006737 0 0 1 30.127158 10.778947l-4.329544 12.21614a15.934877 15.934877 0 0 1-15.072561 10.778948z m-60.883088 173.720701a18.108632 18.108632 0 0 1-5.281684-0.898245 15.916912 15.916912 0 0 1-9.790877-20.300351l45.289544-129.347369a15.970807 15.970807 0 0 1 30.127158 10.599299l-45.289544 129.167719a15.934877 15.934877 0 0 1-15.054597 10.778947z m-64.673684-120.72421a13.779088 13.779088 0 0 1-5.389474-0.898246 15.916912 15.916912 0 0 1-9.772912-20.300351l66.218667-188.990877a15.934877 15.934877 0 0 1 20.354245-9.880702 16.168421 16.168421 0 0 1 9.772913 20.48l-66.218667 188.990878a15.755228 15.755228 0 0 1-15.054596 10.599298z m-31.097263 88.746667a18.108632 18.108632 0 0 1-5.281684-0.898246 16.042667 16.042667 0 0 1-9.790877-20.48l9.754947-27.665965a15.970807 15.970807 0 1 1 30.127158 10.599298l-9.754947 27.665965a15.934877 15.934877 0 0 1-15.054597 10.778948z"></path></symbol><symbol id="icon-xingzhuang4" viewBox="0 0 1024 1024"><path d="M312.768 222.624a64 64 0 1 0 63.808 64 62.24 62.24 0 0 0-63.808-64z m288.288 0a64 64 0 1 0 63.808 64 62.256 62.256 0 0 0-63.808-64z m-14.4 353.504a48 48 0 0 0 0 95.488 48 48 0 1 0-0.032-95.488z m191.888 0a48 48 0 0 0 0 95.488 48 48 0 1 0-0.032-95.488zM1024 683.36A285.12 285.12 0 0 0 913.424 464c0.336-3.952 0.512-7.664 0.512-11.088 0-330.544-235.552-452.896-459.2-452.896C204.8 0 0 178.656 0 405.616c0 130.976 68.064 238.528 181.968 322l1.104 106.944 112.464-47.04a579.088 579.088 0 0 0 83.456 14.08c51.008 106.4 168.96 181.12 309.264 181.12a482.144 482.144 0 0 0 118.608-20.64L915.28 1024l-29.728-103.04C964.8 858.72 1024 776.32 1024 683.36z m-672.096 0a271.68 271.68 0 0 0 4.8 51.2 1094.432 1094.432 0 0 1-36.512-7.264l-11.744-2.464-19.424-4.048-18.32 7.664-24.672 10.32-0.112-11.776-0.336-32-25.84-18.928a416.592 416.592 0 0 1-116.208-123.76A286.176 286.176 0 0 1 64 405.616a318.896 318.896 0 0 1 112-240 395.2 395.2 0 0 1 124.56-74.176A439.12 439.12 0 0 1 454.784 64a495.392 495.392 0 0 1 147.072 21.392 365.088 365.088 0 0 1 125.536 66.4 315.056 315.056 0 0 1 87.696 116.8 435.04 435.04 0 0 1 34.064 153.856 358.88 358.88 0 0 0-160.976-38.4C500.08 384 351.904 518.4 351.904 683.36z m494.176 187.2l-29.696 23.2-0.464-0.32-25.28 6.72a433.776 433.776 0 0 1-102.4 18.56 308.672 308.672 0 0 1-109.376-19.52 273.424 273.424 0 0 1-86.624-51.84 214.288 214.288 0 0 1 0-327.856 273.6 273.6 0 0 1 86.624-52.032A309.744 309.744 0 0 1 688.176 448a292.576 292.576 0 0 1 104.624 19.376 288 288 0 0 1 87.68 52.544 243.6 243.6 0 0 1 58.592 75.328A198.24 198.24 0 0 1 960 683.36a184.144 184.144 0 0 1-29.936 96.8 353.104 353.104 0 0 1-83.984 90.4z"></path></symbol><symbol id="icon-xingzhuang5" viewBox="0 0 1102 1024"><path d="M26.385044 538.385241H1012.083018L564.324889 979.842464a25.321766 25.321766 0 0 0 0 36.624015 26.503186 26.503186 0 0 0 37.017822 0l489.107825-482.806918a25.164243 25.164243 0 0 0 12.208005-21.265557 25.833714 25.833714 0 0 0-6.694713-16.539879l0.393807-0.393806-1.18142-1.18142h-0.393807L601.342711 7.533914a26.503186 26.503186 0 0 0-37.017822 0 25.676192 25.676192 0 0 0 0 36.624016l448.545742 442.638643H26.385044a25.794334 25.794334 0 1 0 0 51.588668z"></path></symbol><symbol id="icon-g" viewBox="0 0 1024 1024"><path d="M592.859991 475.113495v86.004747H769.708167v239.267165a385.429099 385.429099 0 0 1-93.30778 33.623208 441.040176 441.040176 0 0 1-97.651341 11.579077q-16.879121 0-33.116835-1.417846V198.183385a349.397802 349.397802 0 0 1 24.440967-0.945231 296.363604 296.363604 0 0 1 114.462945 23.158154 261.682637 261.682637 0 0 1 94.939429 66.154901L847.824738 213.802198A311.881143 311.881143 0 0 0 722.446629 134.380308a461.463912 461.463912 0 0 0-145.880616-23.158154c-10.465055 0-20.750066 0.438857-30.945055 1.125275V0H486.138936v120.033055a413.403429 413.403429 0 0 0-202.54945 104.20044 379.150066 379.150066 0 0 0-88.39033 129.024A426.771692 426.771692 0 0 0 163.18509 521.407297a443.763341 443.763341 0 0 0 30.382418 167.047033 376.719473 376.719473 0 0 0 85.183296 129.564132 384.742681 384.742681 0 0 0 129.665407 83.799208 408.542242 408.542242 0 0 0 77.722725 22.15666V1024h59.425759v-93.217758c9.125978 0.483868 18.330725 0.810198 27.704263 0.810198a630.558945 630.558945 0 0 0 148.153671-17.644308A535.957099 535.957099 0 0 0 860.85542 858.80967v-383.718681H592.859991zM449.635024 821.338022a291.446154 291.446154 0 0 1-100.352-67.809055 310.789626 310.789626 0 0 1-65.108395-103.120176 350.320527 350.320527 0 0 1-23.326945-129.001494 353.437538 353.437538 0 0 1 23.326945-130.104264 304.499341 304.499341 0 0 1 65.097142-102.546286 301.089758 301.089758 0 0 1 98.191473-67.268923 289.994549 289.994549 0 0 1 38.731956-13.390769v625.596483a304.150505 304.150505 0 0 1-36.560176-12.355516z"></path></symbol><symbol id="icon-weibiaoti-" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 1024 512 512 512 0 0 1 512 1024z m0-947.2A435.2 435.2 0 1 0 947.2 512 435.2 435.2 0 0 0 512 76.8z m211.499886 477.5936l-307.6096 183.413029a32.416914 32.416914 0 0 1-3.4816 1.111771c-0.877714 0.380343-1.784686 0.526629-2.691657 0.877714a39.087543 39.087543 0 0 1-11.966172 2.399086c-0.321829 0-0.6144 0.2048-0.965486 0.2048s-1.2288-0.351086-1.901714-0.380343a39.263086 39.263086 0 0 1-12.405028-2.516114c-0.526629-0.2048-0.936229-0.468114-1.4336-0.672914a36.981029 36.981029 0 0 1-17.729829-14.453029 32.709486 32.709486 0 0 1-1.901714-5.412571 33.850514 33.850514 0 0 1-2.574629-12.843886c0-0.702171-0.4096-1.316571-0.4096-2.018743V319.985371c0-0.702171 0.351086-1.316571 0.4096-2.018742a33.938286 33.938286 0 0 1 2.574629-12.843886 32.182857 32.182857 0 0 1 1.901714-5.441829 37.127314 37.127314 0 0 1 17.759086-14.453028 13.633829 13.633829 0 0 1 1.375085-0.643657 39.087543 39.087543 0 0 1 12.522058-2.633143c0.643657 0 1.199543-0.351086 1.8432-0.351086s0.585143 0.175543 0.936228 0.175543a38.912 38.912 0 0 1 12.053943 2.428343c0.877714 0.292571 1.784686 0.468114 2.633143 0.848457a33.909029 33.909029 0 0 1 3.4816 1.111771l307.580343 183.413029a48.010971 48.010971 0 0 1 26.331428 42.949486 49.737143 49.737143 0 0 1-26.331428 41.866971zM649.508571 512l-214.396342-127.853714v255.678171z"></path></symbol><symbol id="icon-dianji" viewBox="0 0 1024 1024"><path d="M686.027 362.189c-6.642 0-12.861 1.093-18.95 3.162-0.638-0.338-1.292-0.556-1.982-0.757-11.384-18.209-30.737-29.391-52.559-29.391a65.179 65.179 0 0 0-21.469 3.617c-11.265-18.964-31.071-30.634-53.396-30.634-4.001 0-7.937 0.353-11.789 1.058v-34.416c0-35.862-27.505-63.955-62.625-63.955-35.476 0-64.343 28.683-64.343 63.955v168.986l-9.887-9.87c-11.464-11.381-27.454-17.669-45.022-17.669-17.688 0-34.854 6.622-45.918 17.7-24.108 24.111-32.144 65.973-3.832 94.305l144.44 143.477c3.309 3.281 7.11 6.272 11.281 8.88 27.099 21.941 59.379 36.499 127.623 36.499 158.613 0 171.894-92.989 171.894-188.25V426.179c-0.02-35.896-27.307-63.991-63.469-63.991z m38.267 166.681c0 92.371-10.809 163.032-146.674 163.032-61.567 0-88.618-12.003-112.358-31.357l-1.447-1.022c-2.776-1.682-5.246-3.58-7.347-5.686L312.063 510.393c-18.88-18.896-9.114-45.645 3.848-58.61 6.356-6.352 17.119-10.307 28.094-10.307 10.861 0 20.546 3.685 27.238 10.326l52.893 52.706V274.795c0-21.367 17.551-38.735 39.123-38.735 20.981 0 37.407 17.016 37.407 38.735v73.152l0.321-0.167v75.154c0 6.958 5.65 12.608 12.609 12.608 6.962 0 12.608-5.649 12.608-12.608v-87.649c3.701-1.141 7.502-1.934 11.482-1.934 16.275 0 29.842 10.088 35.391 26.281l1.597 4.675v82.532c0 6.958 5.65 12.609 12.612 12.609 6.958 0 12.609-5.65 12.609-12.609v-84.181c4.085-1.363 8.337-2.287 12.639-2.287 16.278 0 29.827 10.086 35.392 26.276l0.856 2.504v82.5c0 6.962 5.65 12.608 12.609 12.608 6.962 0 12.608-5.647 12.608-12.608V389.84c4.054-1.494 8.273-2.468 13.386-2.468 21.014 0 36.872 16.657 36.887 38.769v102.726h0.02z m-364.5-135.357c2.255 1.697 4.911 2.487 7.516 2.487 3.848 0 7.649-1.748 10.12-5.079 4.169-5.6 3.009-13.501-2.588-17.654-33.744-25.116-53.114-63.635-53.114-105.649 0-72.547 59.03-131.591 131.592-131.591 72.565 0 131.612 59.046 131.612 131.591 0 8.809-0.875 17.653-2.607 26.228-1.378 6.827 3.043 13.484 9.87 14.863 6.823 1.328 13.48-3.059 14.859-9.869a157.413 157.413 0 0 0 3.111-31.205c0-86.467-70.359-156.811-156.83-156.811-86.467 0-156.811 70.359-156.811 156.811 0 49.33 23.656 96.388 63.265 125.878z m0 0z"></path></symbol><symbol id="icon-video" viewBox="0 0 1422 1024"><path d="M1292.941504 0.000284H129.279928A129.023928 129.023928 0 0 0 0 128.000213v767.999574A129.023928 129.023928 0 0 0 129.279928 1023.999716h1163.661576A129.023928 129.023928 0 0 0 1422.221432 895.999787v-767.999574A129.023928 129.023928 0 0 0 1292.941504 0.000284zM930.929261 569.599968l-265.045186 166.399908c-45.255086 31.999982-90.510172 12.799993-90.510172-44.799976V332.8001c0-57.599968 38.798201-76.799957 90.510172-44.799976l265.045186 166.399908c51.711971 31.999982 51.711971 83.199954 0 115.199936z"></path></symbol><symbol id="icon-fire" viewBox="0 0 1024 1024"><path d="M536.841481 0a394.770963 394.770963 0 0 1 45.511112 191.070815c0 153.220741-73.367704 277.598815-163.972741 277.598815-70.580148 0-130.199704-75.96563-153.448296-181.930667C182.897778 399.985778 113.777778 534.072889 113.777778 666.718815 113.777778 864.06637 292.02963 1024 512 1024s398.222222-159.93363 398.222222-357.281185C910.222222 308.451556 551.461926 12.003556 536.841481 0z m-21.617777 938.666667c-134.144 0-174.193778-101.527704-167.329185-142.506667 13.729185-81.540741 96.161185-94.966519 158.568296-94.966519 148.176593 0 207.815111-150.793481 211.456-189.781333 0 0 53.342815 427.254519-202.695111 427.254519z"></path></symbol><symbol id="icon-line" viewBox="0 0 1024 1024"><path d="M6.5641024 0h157.538462v1024H6.5641024z"></path></symbol><symbol id="icon-circle" viewBox="0 0 1024 1024"><path d="M496 503.338667m-489.344 0a489.344 489.344 0 1 0 978.688 0 489.344 489.344 0 1 0-978.688 0Z"></path></symbol><symbol id="icon-lock" viewBox="0 0 1024 1024"><path d="M507.180564 589.653605a24.397417 24.397417 0 0 0-26.32167 21.855283v166.862794a26.780666 26.780666 0 0 0 52.64334 0v-166.915755a24.397417 24.397417 0 0 0-26.32167-21.802322z m332.172062-223.672408h-57.092073V277.183075a278.593076 278.593076 0 0 0-77.67629-195.779559A272.27305 272.27305 0 0 0 507.180564 0.019949a272.255397 272.255397 0 0 0-197.403699 81.34826 278.593076 278.593076 0 0 0-77.67629 195.779558v88.780469H184.559154A92.946743 92.946743 0 0 0 88.275862 454.885242v480.004165A92.946743 92.946743 0 0 0 184.559154 1023.934681h654.793472A92.946743 92.946743 0 0 0 935.653572 934.889407v-480.004165a92.946743 92.946743 0 0 0-96.283292-88.97466zM283.878883 277.183075A219.382558 219.382558 0 0 1 507.180564 51.868872 219.382558 219.382558 0 0 1 730.499898 277.183075v88.780468H283.878883V277.183075z m599.99638 657.706332a41.344971 41.344971 0 0 1-44.504983 37.072775H184.559154a41.344971 41.344971 0 0 1-44.504983-37.072775v-480.004165a41.344971 41.344971 0 0 1 44.504983-37.072775h654.793472a41.344971 41.344971 0 0 1 44.504983 37.072775v480.004165z"></path></symbol><symbol id="icon-arrowright1-copy" viewBox="0 0 1024 1024"><path d="M105.34425701 267.649318L64.321958 308.671617 512 756.349659 959.677019 308.671617 918.65472 267.649318 512 674.30506099Z"></path></symbol><symbol id="icon-video-" viewBox="0 0 1611 1024"><path d="M1454.610963 13.198222H152.538074A126.596741 126.596741 0 0 0 26.093037 139.643259v745.775408a126.596741 126.596741 0 0 0 126.445037 126.445037h1302.034963a126.596741 126.596741 0 0 0 126.445037-126.445037V139.643259a126.520889 126.520889 0 0 0-126.407111-126.445037zM1543.130074 885.418667a88.632889 88.632889 0 0 1-88.519111 88.519111H152.538074A88.632889 88.632889 0 0 1 64.018963 885.418667V139.643259a88.632889 88.632889 0 0 1 88.519111-88.519111h1302.034963a88.632889 88.632889 0 0 1 88.519111 88.519111v745.775408z"></path><path d="M975.909926 457.234963l-268.781037-161.261037c-50.706963-30.416593-92.197926-6.940444-92.197926 52.186074v328.779852c0 59.126519 41.490963 82.602667 92.197926 52.186074l268.781037-161.298963c50.706963-30.416593 50.706963-80.175407 0-110.592z"></path></symbol><symbol id="icon-xingzhuang6" viewBox="0 0 1117 1024"><path d="M285.52529 664.619668l-0.152077 2.668949c0.253461-0.707157 0.532269-1.414314 0.811077-2.124007z m692.000212 179.704107c-3.725882-0.147008-17.362103 3.713209-17.995756 3.80192a412.128176 412.128176 0 0 0-2.407883-134.841445c-4.055382-21.767262-0.076038-34.034792 15.562527-47.397275 19.034948-16.236735 43.240508-42.366067 40.832626-73.364391a23.460384 23.460384 0 0 0-2.864114-8.503629c-19.643256-23.701172-42.961701-22.200681-66.406877-15.714604-70.031375 19.372052-132.788408 1.315464-208.117124-6.562115-0.887115-19.009602-1.748883-38.153539-2.635999-57.282268-0.101385-2.810887-2.23046-8.521371-3.624497-8.762159-1.039192-0.185027-4.765074 3.515509-5.778919 6.516491-11.60853 31.081967 5.525458 73.549418-37.309513 78.279008-13.560183-15.040397-26.43602-39.218077-30.035171-56.570042-4.308843-20.831989-20.555717-35.256476-17.38745-5.431677 1.77423 16.474989 16.753796 43.795589 32.189593 67.103896a19.263064 19.263064 0 0 1-14.751451 0.613376c-74.289525-24.220768-143.484477-58.906955-221.702654-35.829298 66.381531-4.09847 127.668488 16.099866 184.13968 46.733206 28.007481 15.187405 49.298235 11.058519 72.565988-1.062003 61.109535-31.844886 168.881306-14.361121 215.061966 36.029533 48.765966 53.226886 62.478226 184.79361 23.850715 245.675029-20.910562 32.949977-45.547007 65.851797-87.469517 71.106051-57.358306 7.190699-115.375612 10.295601-172.429765-5.426608a54.87185 54.87185 0 0 0-19.87137-1.323068c-95.098703 10.024397-190.04533 11.74033-284.814534-3.67519-58.803036-9.568166-82.045443-43.886835-89.80136-103.059924-8.085417-61.644338 16.348258-108.324317 9.04857-168.082903-8.161456 21.496058-16.474989 42.931286-24.332291 64.531263-4.435574 12.237115-4.384882 28.727311-12.698414 36.483228-32.189593 29.984479-87.925747 27.607012-119.583071-3.041536-13.230683-12.809937-24.53506-27.568992-37.613666-40.553818-21.823023-21.660808-41.669048-23.589649-62.351495-2.684156-20.251563 20.446728-33.380861 46.492418-27.297789 76.223436 19.212371 93.795912 113.525344 142.503582 191.870252 135.094906 41.821125-3.946393 47.29589-21.51887 71.628181-35.39081a12.450022 12.450022 0 0 1 3.751228-0.91753c6.463265 7.489783 10.848146 12.515922 17.362103 20.023447-9.910339 5.558408-25.548905-2.504198-29.097364 16.315308-5.854957 10.328551 19.719294 6.083073 26.005136 7.096919 7.654533 1.231822 15.866681 0.030415 23.141022 2.207648 103.564313 31.003394 194.531596 29.817195 299.971523 23.985049 11.963376-0.661534 39.945511-9.654343 51.173849-8.653171 21.468177 1.911099 42.70824 8.475748 64.632647 10.645377 0 8.914236-4.156766 37.236009-4.156766 47.506263-1.089884 7.900391 2.027691 11.246081 7.071572 3.071952 3.269652-5.337896 9.352724-46.484814 14.675413-49.03717 4.435574-2.126541 47.904198-0.955549 52.719963-1.921237s26.537405 43.798123 31.682671 45.227646c5.880304 1.632291 8.744417 2.473783-0.811077-20.677378-5.145266-10.001585-8.643032-16.804488-13.661567-26.583028 13.889683-1.335741 25.447521-4.410228 36.549128-3.188544 56.065653 6.16925 102.651852-19.093244 147.108975-46.685048 15.131643-9.37807 33.507592-25.414571 33.507592-47.176764-4.993189-23.22213-26.055828-23.949564-49.095466-24.862025zM240.91609 902.237161c-79.434791 35.545422-185.356295-4.359535-222.0575-83.013665-14.751451-31.576217-3.725882-58.724463 13.053261-83.895711 11.709915-17.600357 44.583854-12.419607 61.92061 7.64186a107.688129 107.688129 0 0 1 9.555494 14.62979c34.977668 57.20116 75.784947 67.453672 134.461253 33.730638 4.866458-2.788075 9.656878-5.654723 14.675413-8.602479-2.68669 39.223146-2.68669 58.042652 14.067105 111.211242a225.20549 225.20549 0 0 0-25.675636 8.308464z m633.349253-310.267123c49.222197 4.876597 105.034389-21.369327 132.661677-2.438298 12.014069 8.252702-42.37874 71.141535-58.77769 89.302042-15.28372-35.841971-39.03305-61.783742-73.883987-86.853605zM286.18429 665.16461c-14.143144-48.811589-2.788075-77.559177 40.731241-102.220967 15.182336-8.617686 30.11121-18.125022 46.256698-24.491972 18.984256-7.489783 37.715051-8.23496 49.450312 22.3046-52.162348-24.943133-81.209021 9.187974-113.42396 34.470746-16.525681 12.951876-19.41514 29.672722-15.61322 49.632804 1.11523 5.857492-5.170612 13.129299-8.060071 19.752244z m207.508817 27.72107c-0.228115 6.323861-1.292653 16.928684-1.495422 21.351585-0.836422 18.340464-1.77423 32.470935 6.792765 38.820142 10.290531 7.603841 33.1274 3.589013 48.157659-1.875614 18.021103-6.546907 33.532938-19.939805 48.86735-29.561199-14.979567 34.496091-58.625613 60.526573-93.983473 49.571974-11.988722-3.715744-25.067329-21.290754-27.373827-34.328807-2.55996-14.510663 6.640688-31.089571 10.696069-46.766156 3.193613-7.859837 10.189147-18.510283 8.338879 2.788075zM369.547732 890.172401c28.691826-28.324307 89.776015-31.244182 76.013062-93.020321 14.700759 3.682794 18.29991 11.464057 12.825145 33.203439-6.995534 27.705862-62.376841 65.575524-88.838207 59.816882z m-47.397275-32.189594c-5.753573-42.008686 60.906765-85.005872 107.366233-68.414291-46.05393 9.778539-87.672285 20.692586-107.366233 68.432034z m298.881639 9.854578c-43.189816-29.538387-68.333183-16.551027-63.796225 45.524196-0.405538 8.085417-3.877959 12.741503-7.603841 1.173526-1.140576-13.068468-3.041536-28.007481-2.23046-38.432347 1.875614-24.099106 23.41983-35.738052 40.959356-35.314771 10.36657 0.253461 25.65029 12.031811 38.779589 18.981721 9.276686 6.597599 2.281152 12.406934-6.108419 8.098091zM889.929255 833.321017c0 7.051295-31.175748 75.047375-39.387895 87.269282s-15.714604 12.576753-9.631532-4.177044 23.952099-82.344528 35.712706-88.39465 13.306722-1.751418 13.306721 5.302412z m-35.129744-207.627945c8.490956 8.490956 33.583631 64.031944 33.58363 75.675959s-5.221304 12.23458-12.343568 4.749866-17.742295-51.16878-26.613443-76.750635c-3.117575-8.764694-3.117575-12.173749 5.373381-3.67519z m-468.295214 6.843457c8.060071-12.622376 25.016636-24.025603 31.784055-38.959546 4.891804-10.739158-4.612997-29.601753-0.126731-36.627701 1.77423-2.788075 7.071572 7.142541 9.783609 10.792384 11.507146 19.143937 0.025346 40.759122-41.440933 64.797398z m453.974647 122.404096s14.143144 2.027691 18.173179 20.20594 0 28.288823 0 28.288823-8.338879 4.463455-11.557838-2.549822-4.055382-12.419607-6.615341-12.419606-1.77423-8.00431 0-8.587271 0-24.935529 0-24.935529z m-146.678091 7.096918s-3.244305 16.72845 0 22.119573 14.574028 3.325413 14.574028-4.270824-5.398727-22.160127-14.574028-17.84368zM344.201595 872.835643c1.140576-2.281152-0.608307-13.643825 6.818111-12.166145s12.622376 5.9386 9.656878 13.359948-8.92184 6.678707-7.426418 10.391916 14.092452 2.968033 15.587874-8.16399 1.495422-40.074776-20.783832-31.910786-10.898839 29.860283-9.656878 31.910786 4.663689-1.143111 5.804265-3.416659z m-36.219628-240.301648s5.094573-18.487472 12.495645-12.92653 0 25.014102 0 25.014102 8.820455 4.169439 12.064761-6.483542 6.944841-35.669618-6.032381-31.964012-18.528026 7.915598-18.528025 17.139057v9.223459zM987.816034 147.340512a10.019328 10.019328 0 0 1-9.048571-14.386467l51.984926-108.291367-76.266524 18.038845a10.044674 10.044674 0 0 1-4.638343-19.544406L1046.593724 0.27716a10.052278 10.052278 0 0 1 11.380415 14.117798L1005.178137 124.313547l100.953661-16.350792a10.039605 10.039605 0 0 1 3.193613 19.825747l-119.912571 19.422745a9.976239 9.976239 0 0 1-1.596806 0.134334z m-54.494193 160.050712a10.217028 10.217028 0 0 1-2.154422-0.23065l-66.204108-14.447298a10.057347 10.057347 0 0 1-5.525457-16.292496l58.524228-69.212694-56.090999-1.363622a10.014258 10.014258 0 0 1-9.783609-10.280393 9.907805 9.907805 0 0 1 10.290531-9.796282l77.026908 1.87308a10.03707 10.03707 0 0 1 7.426418 16.518077l-61.286957 72.489949 49.906542 10.898839a10.042139 10.042139 0 0 1-2.129075 19.848559z m-65.418378 167.667226a10.039605 10.039605 0 0 1-8.541648-15.347086l39.996203-64.21697-48.259043 9.715174a10.039605 10.039605 0 1 1-3.953998-19.686344l71.04522-14.307894a10.047208 10.047208 0 0 1 10.518647 15.15192l-41.238164 66.201573 63.517418-7.573425a10.042139 10.042139 0 0 1 2.382537 19.944874l-84.275904 10.047209a10.199285 10.199285 0 0 1-1.191268 0.076038z"></path></symbol><symbol id="icon-right" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512A513.504 513.504 0 0 0 512 0z m0 960A445.24 445.24 0 0 1 64 512a448 448 0 1 1 448 448z m230.4-614.4L435.2 652.8 281.6 499.2c-19.456-19.456-45.056-19.456-57.344 0s-19.456 45.056 0 57.344l179.2 179.2c19.456 19.456 45.056 19.456 57.856 0L800.256 396.8c19.456-19.456 19.456-45.056 0-57.344-12.8-12.8-38.912-12.8-57.856 6.144z"></path></symbol><symbol id="icon-remove" viewBox="0 0 1024 1024"><path d="M710.68 287.424a25.472 25.472 0 0 0-15.848 5.504l-0.264-0.248L512.072 475.2 333.088 296.2l-0.176 0.2a25.6 25.6 0 1 0-33.712 37.864l-0.208 0.232 72.952 72.952-0.384 0.376 103.936 103.944-97.536 97.544 0.376 0.376-78.72 78.72a25.6 25.6 0 1 0 30.264 41.128l0.52 0.496 181.68-181.68L692.12 728.4a25.6 25.6 0 0 0 34.968-37.368L645.816 609.688l0.376-0.376-97.536-97.544 103.936-103.936-0.384-0.384 74.4-74.4a25.776 25.776 0 0 0 4-4l1.304-1.304-0.2-0.184a25.6 25.6 0 0 0-21.032-40.136zM512 0a512 512 0 1 0 512 512A512 512 0 0 0 512 0z m0 972.8A460.8 460.8 0 1 1 972.8 512 460.8 460.8 0 0 1 512 972.8z"></path></symbol><symbol id="icon-gou" viewBox="0 0 1280 1024"><path d="M126.912 458.752L425.984 691.2 1170.24 21.504a76.8 76.8 0 0 1 93.504-9.856 60.16 60.16 0 0 1-5.824 86.4l-777.088 889.6a78.656 78.656 0 0 1-130.432-0.96L15.168 544.448a71.168 71.168 0 0 1 9.856-96 75.968 75.968 0 0 1 101.888 10.304z"></path></symbol><symbol id="icon-xingzhuang7" viewBox="0 0 1024 1024"><path d="M382.534474 257.173856h245.456447c75.955881 0 133.899948-165.685005 133.899948-165.685005C761.890869 41.878103 756.950099 4.348555 672.610136 1.692045S568.092543 60.989747 507.491966 60.989747C445.38547 60.989747 414.319531 12.267323 337.898338 1.692045S248.634526 41.878103 248.634526 91.488851c0 0 57.918686 165.685005 133.899948 165.685005z m258.882821 51.209729H382.534474C95.885201 308.383585 25.513067 874.820889 25.513067 874.820889c0 74.3992 59.94914 149.128349 133.899948 149.12835h705.134198c73.942348 0 133.891488-74.729149 133.891488-149.12835 0 0-70.414435-566.437304-357.021406-566.437304z m29.382354 435.32923a31.472029 31.472029 0 0 1 0 62.944059h-126.903344v82.563315a31.252063 31.252063 0 1 1-62.504127 0v-82.563315h-127.749366a31.472029 31.472029 0 0 1 0-62.944059h127.749366v-39.932252h-127.749366a31.480489 31.480489 0 0 1 0-62.952519H439.979387l-88.409329-158.036964a31.573552 31.573552 0 0 1 11.438221-42.977932 31.150541 31.150541 0 0 1 42.698745 11.480523l106.454985 189.508993h5.389162l106.446525-189.508993a31.142081 31.142081 0 0 1 42.681824-11.480523 31.565092 31.565092 0 0 1 11.463602 42.977932l-88.409329 158.036964h81.065856a31.480489 31.480489 0 0 1 0 62.952519h-126.903344v39.932252h126.903344z m0 0"></path></symbol><symbol id="icon-shanchu1-copy" viewBox="0 0 1024 1024"><path d="M62.03327281 991.97774563a30.00010875 30.00010875 0 0 1-21.22916813-51.20745937l428.35792126-428.79428626L40.80410468 83.05080404A30.00010875 30.00010875 0 0 1 83.26244094 40.65792219l449.45617968 450.02345438a29.97829124 29.97829124 0 0 1 1e-8 42.39288187l-449.45617969 450.02345437a29.82556314 29.82556314 0 0 1-21.22916813 8.88003281z m900.1341825-1e-8a29.82556314 29.82556314 0 0 1-21.22916811-8.72730468l-449.45618064-450.02345437a29.97829124 29.97829124 0 0 1 0-42.39288188L940.9382872 40.81065031a30.00010875 30.00010875 0 0 1 42.45833623 42.39288094L555.03870219 511.976l428.35792124 428.72883187a30.00010875 30.00010875 0 0 1-21.22916812 51.27291375z"></path></symbol><symbol id="icon-xingzhuangkaobei1" viewBox="0 0 1057 1024"><path d="M936.167226 136.423226H109.898323a27.086452 27.086452 0 1 1 0-54.172903h826.268903a27.086452 27.086452 0 1 1 0 54.172903z m0 793.765161H109.898323a27.086452 27.086452 0 1 1 0-54.172903h826.268903a27.086452 27.086452 0 1 1 0 54.172903z m0-397.047742H109.898323a27.086452 27.086452 0 1 1 0-54.172903h826.268903a27.086452 27.086452 0 1 1 0 54.172903z"></path></symbol><symbol id="icon-xingzhuangkaobei2" viewBox="0 0 1056 1024"><path d="M950.4 168H529.92a25.28 25.28 0 1 1 0-50.56H950.4a25.28 25.28 0 1 1 0 50.56zM346.944 130.56a17.088 17.088 0 0 1 17.024 16.96v731.84a17.088 17.088 0 0 1-17.024 16.96h-172.8a17.088 17.088 0 0 1-17.024-16.96V147.52a17.088 17.088 0 0 1 17.024-16.96h172.8m0-47.68h-172.8a64.896 64.896 0 0 0-65.28 64.64v731.84a65.12 65.12 0 0 0 65.28 64.64h172.8a65.12 65.12 0 0 0 65.248-64.64V147.52a64.896 64.896 0 0 0-65.248-64.64zM950.4 920H529.92a25.28 25.28 0 1 1 0-50.56H950.4a25.28 25.28 0 1 1 0 50.56z m0-374.08H529.92a25.28 25.28 0 1 1 0-50.56H950.4a25.28 25.28 0 1 1 0 50.56z"></path></symbol><symbol id="icon-zhuanfa" viewBox="0 0 1380 1024"><path d="M30.510104 1024H27.749774a30.363628 30.363628 0 0 1-27.558777-30.274585c-3.517194-213.702954 54.672339-383.774888 172.965829-504.873229a639.550612 639.550612 0 0 1 297.447799-167.400648 1619.022485 1619.022485 0 0 1 267.618428-27.158083V30.726478a30.230064 30.230064 0 0 1 48.172208-24.932011L1367.711818 432.75516a30.230064 30.230064 0 0 1 12.466005 24.486797 31.165014 31.165014 0 0 1-12.510527 24.932011l-581.361078 424.734622a30.452671 30.452671 0 0 1-48.083165-24.932012v-248.429684c-209.250809 5.787788-465.204618 68.563031-573.035567 182.983155a422.24142 422.24142 0 0 0-104.981576 182.983154 30.363628 30.363628 0 0 1-29.695806 24.486797z m737.987535-451.892705a29.962935 29.962935 0 0 1 21.459338 8.90429 30.40815 30.40815 0 0 1 8.90429 21.81551v219.490742l499.441612-365.07588-499.441612-366.411523v233.737606a30.051978 30.051978 0 0 1-9.260462 21.81551 31.788314 31.788314 0 0 1-22.260724 8.904289 55.117554 55.117554 0 0 0-7.791254-0.445214c-47.059171 0-379.100136 8.90429-543.161675 176.750152a550.285107 550.285107 0 0 0-144.961837 304.081495 494.855903 494.855903 0 0 1 47.103693-58.323098 590.398932 590.398932 0 0 1 206.802129-142.023422c100.618474-41.850162 308.800769-63.220457 443.166502-63.220457z m0 0"></path></symbol><symbol id="icon-share" viewBox="0 0 1024 1024"><path d="M490.929231 499.987692H358.4a31.704615 31.704615 0 1 1 0-63.212307h93.696L383.803077 334.769231a31.586462 31.586462 0 1 1 52.578461-35.052308l85.07077 127.606154 85.464615-128.196923A31.763692 31.763692 0 0 1 659.495385 334.769231l-67.997539 102.006154h95.172923a31.704615 31.704615 0 1 1 0 63.212307h-132.529231v36.233846h132.529231a31.704615 31.704615 0 1 1 0 63.212308h-132.529231v131.544616a31.901538 31.901538 0 0 1-31.507692 31.704615c-17.526154 0-31.704615-14.178462-31.704615-31.704615v-131.544616H358.4a31.704615 31.704615 0 1 1 0-63.212308h132.529231v-36.233846zM809.353846 154.584615h-23.827692a40.763077 40.763077 0 0 1 0-81.32923h121.501538a40.763077 40.763077 0 0 1 40.96 55.079384V236.307692a40.763077 40.763077 0 0 1-40.96 39.384616A40.763077 40.763077 0 0 1 866.461538 236.307692v-23.630769l-57.107692 58.289231a40.96 40.96 0 0 1-57.501538-2.56 37.809231 37.809231 0 0 1 0-55.138462l57.501538-58.683077zM512 1006.867692C238.690462 1006.867692 17.132308 785.309538 17.132308 512S238.690462 17.132308 512 17.132308c33.476923 0.059077 66.835692 3.426462 99.643077 10.043077a42.220308 42.220308 0 1 1-16.935385 82.707692A410.584615 410.584615 0 1 0 922.584615 512a420.036923 420.036923 0 0 0-10.830769-94.326154 42.141538 42.141538 0 0 1 81.92-19.692308A495.064615 495.064615 0 0 1 512 1006.867692z"></path></symbol><symbol id="icon-info" viewBox="0 0 1024 1024"><path d="M505.294856 1023.956679A511.978339 511.978339 0 1 0 0.011618 505.873982v24.456812A510.993766 510.993766 0 0 0 505.294856 1023.956679z m0-966.339424a454.400468 454.400468 0 1 1 0 908.722169 454.400468 454.400468 0 0 1 0-908.722169z m-19.179496 569.556211h44.778413a13.784032 13.784032 0 0 0 12.799459-12.799459l12.799458-332.78592a20.439751 20.439751 0 0 0-19.179496-19.21888h-57.577872a16.974051 16.974051 0 0 0-19.179496 19.21888l12.799459 332.78592a13.784032 13.784032 0 0 0 12.760075 12.799459z m25.598917 153.593502a51.197834 51.197834 0 1 0-51.197834-51.197834 55.136129 55.136129 0 0 0 51.197834 51.197834z"></path></symbol><symbol id="icon-xingzhuang11" viewBox="0 0 1024 1024"><path d="M842.175549 430.510362L319.09522 23.5485A113.294059 113.294059 0 0 0 206.613179 8.967495a28.244078 28.244078 0 0 0-3.883561 1.659339A105.279802 105.279802 0 0 0 141.228138 105.067971v814.029639a105.315107 105.315107 0 0 0 62.207582 94.547052 112.976313 112.976313 0 0 0 115.624195-13.062886l523.115634-406.961862a102.384784 102.384784 0 0 0 0-163.109552z m-89.851474 81.519471L263.666217 892.301041V131.86454z"></path></symbol><symbol id="icon-likexuexi" viewBox="0 0 1024 1024"><path d="M684.032 881.152h-409.6c-43.008 0-77.824-34.816-77.824-77.824V220.672c0-43.008 34.816-77.824 77.824-77.824h409.6c79.36 0 143.872 64.512 143.872 143.872v450.56c0 79.36-65.024 143.872-143.872 143.872z m-409.6-674.304c-7.68 0-14.336 6.144-14.336 14.336v582.144c0 7.68 6.144 14.336 14.336 14.336h409.6c44.032 0 79.872-35.84 79.872-79.872V286.72c0-44.032-35.84-79.872-79.872-79.872h-409.6z"></path><path d="M664.064 412.16H359.936c-17.92 0-31.744-14.336-31.744-31.744 0-17.408 14.336-31.744 31.744-31.744h304.128c17.92 0 31.744 14.336 31.744 31.744 0 17.408-14.336 31.744-31.744 31.744z m-82.432 148.48H359.936c-17.92 0-31.744-14.336-31.744-31.744s14.336-31.744 31.744-31.744h222.208c17.92 0 31.744 14.336 31.744 31.744s-14.336 31.744-32.256 31.744z"></path></symbol><symbol id="icon-jiantou" viewBox="0 0 1024 1024"><path d="M336.325 171.134l387.574 297.604c26.938 20.681 26.938 65.523 0 86.203L336.325 852.545c-24.968 19.175-56.196-4.808-56.196-43.161V214.233c0-38.294 31.225-62.278 56.196-43.103z"></path></symbol><symbol id="icon-dingyue" viewBox="0 0 1024 1024"><path d="M967.87 882.012l-108.862-0.154-0.174 94.792c0 26.156-24.02 47.35-53.704 47.35-29.633 0-53.688-21.194-53.688-47.35l0.157-94.945-108.037-0.14c-29.685 0-53.704-21.208-53.704-47.349 0-26.157 24.02-47.38 53.704-47.38l108.214 0.155 0.157-92.34c0-26.143 24.039-47.35 53.704-47.35 29.685 0 53.705 21.207 53.705 47.35l-0.176 92.493 108.705 0.138c29.665 0 53.703 21.225 53.703 47.352 0 26.156-24.038 47.378-53.704 47.378zM806.476 584.445c-29.667 0-53.686-21.239-53.686-47.378l-0.403-394.609-3.11-2.775 3.11 2.751-0.018-2.15c-1.415-24.752-24.23-44.482-52.55-44.898l-0.647-0.569h52.848l0.313 18.365v-18.49l-590.435 0.37 0.062-0.046c-0.175 0-0.314 0.046-0.48 0.046h-0.332l0.586-0.546h-52.857v0.57h-1.014l0.393 722.053 289.729-255.92c20.97-18.48 54.988-18.48 75.932-0.015 0.541 0.461 0.874 1.017 1.38 1.477l125.906 110.391c20.96 18.481 20.96 48.458 0 66.94-20.979 18.496-54.963 18.496-75.942 0l-89.323-78.283L93.466 964.226c-1.407 1.235-2.98 2.175-4.493 3.237-9.317 6.906-21.222 11.237-34.36 11.237-29.64 0-53.705-21.225-53.705-47.395L0.463 93.728c0.253-48.905 42.611-88.6 96.7-93.356L755.62 0c55.332 1.109 99.842 39.103 104.089 87.192l0.472 449.873c0 26.14-24.056 47.38-53.705 47.38zM161.087 95.085c-29.222 0.447-52.831 21.386-52.831 47.273l3.365-2.968-3.593 3.213 0.848-47.518 52.271-0.024-0.06 0.025z m0.393-0.023h0.418l-50.277 44.328 49.466-44.304c0.113 0 0.254-0.024 0.393-0.024z m537.464 0.248c0.297 0 0.596 0.076 0.875 0.076l49.456 44.298-50.33-44.374z"></path></symbol><symbol id="icon-wenzhang" viewBox="0 0 1024 1024"><path d="M909.186 104.382c-19.215-7.887-42.481-11.722-71.123-11.722-111.623 0-278.723 61.038-327.92 79.992-48.772-19.038-213.591-79.992-324.451-79.992-28.479 0-51.663 3.835-70.88 11.722a36.568 36.568 0 0 0-22.68 33.828v671.04c0 18.63 14.008 34.28 32.523 36.343 1.268 0.14 127.604 14.312 192.38 30.969 66.48 17.095 183.073 52.812 184.242 53.171a36.545 36.545 0 0 0 20.668 0.228c1.622-0.46 162.64-45.969 204.775-57.417 32.996-8.964 136.047-22.523 172.97-26.992 18.363-2.222 32.174-17.806 32.174-36.302V138.21a36.564 36.564 0 0 0-22.678-33.828zM165.266 776.82V166.84c5.732-0.645 12.491-1.046 20.426-1.046 91.012 0 233.067 50.371 287.867 71.181l1.733 608.516c-40.617-12.127-98.824-29.157-140.043-39.756-48.997-12.598-126.374-23.394-169.984-28.915z m693.467 0.206c-43.613 5.71-119.445 16.32-151.186 24.943-28.407 7.718-107.685 30.023-159.119 44.526l-1.736-609.461c55.536-20.827 199.475-71.241 291.37-71.241 8.047 0 14.884 0.405 20.671 1.056v610.177z"></path></symbol><symbol id="icon-pintuan" viewBox="0 0 1024 1024"><path d="M939.008 839.026c0 23.381-18.887 42.382-42.098 42.382-23.21 0-42.098-19-42.098-42.382 0-0.228 0.114-0.54 0.114-0.74h-0.313c0-0.967 0.114-1.906 0.114-2.873 0-69.148-27.221-131.811-71.111-177.806l0.2-0.199a40.533 40.533 0 0 1-12.147-28.985c0-22.414 18.148-40.675 40.42-40.675a39.96 39.96 0 0 1 28.814 12.202l0.114-0.114c60.558 61.07 98.02 145.408 98.02 238.564h-0.114c0.085 0.114 0.085 0.313 0.085 0.626M604.075 579.868c-0.2 0.114-0.427 0.114-0.626 0.114-138.866 0-251.364 114.29-251.364 255.346 0 0.74 0.114 1.365 0.114 2.02 0 0.54 0.2 1.052 0.2 1.592 0 23.382-18.888 42.383-42.099 42.383-23.21 0-42.097-19.001-42.097-42.383 0-0.227 0.113-0.54 0.113-0.74h-0.455c0-137.13 81.351-254.918 197.974-307.91-48.527-40.05-79.56-100.921-79.56-169.102 0-120.776 97.195-218.596 217.174-218.596 119.865 0 217.173 97.82 217.173 218.596-0.028 120.632-96.995 218.368-216.547 218.68m-0.655-357.944c-76.288 0-138.24 62.236-138.24 139.15 0 76.8 61.839 139.15 138.24 139.15 76.288 0 138.24-62.236 138.24-139.15-0.085-76.914-61.923-139.15-138.24-139.15M346.795 260.38c-46.109 12.857-79.986 54.7-79.986 104.505 0 41.728 23.751 77.853 58.567 96.029 14.137 7.338 27.847 21.333 30.066 45.568 1.906 21.02-4.21 52.679-31.858 60.33-92.644 25.686-160.91 108.232-164.295 207.332 0.199 1.593 0.512 3.186 0.512 4.779 0 20.707-16.669 37.603-37.348 37.603-20.565 0-37.347-16.782-37.347-37.603 0-0.427 0.114-0.74 0.114-1.053h-0.228c0-126.066 74.382-226.446 178.859-269.88-43.264-33.252-71.225-85.192-71.225-143.617 0-73.5 44.003-136.704 107.434-165.262 29.64-13.397 51.172 2.56 56.463 23.154 6.314 24.633-9.728 38.115-9.728 38.115"></path></symbol><symbol id="icon-shipin" viewBox="0 0 1024 1024"><path d="M371.463 660.159V412.941c0-57.146 64.326-90.633 111.142-57.869l176.588 123.613c40.169 28.122 40.169 87.608 0 115.73L482.596 718.028c-46.816 32.773-111.133-0.722-111.133-57.869z m70.63 0L618.68 536.546 442.093 412.94V660.16z m-329.09 220.703c-16.925 0-30.696-13.555-30.696-30.226V185.754c0-16.662 13.771-30.226 30.695-30.226h797.996c16.924 0 30.686 13.555 30.686 30.226v664.882c0 16.662-13.762 30.226-30.686 30.226H113.002z m890.073-30.226V185.754c0-49.994-41.307-90.669-92.078-90.669H113.002c-50.77 0-92.078 40.675-92.078 90.67v664.881c0 49.995 41.307 90.67 92.078 90.67h797.996c50.77 0 92.078-40.675 92.078-90.67z"></path></symbol><symbol id="icon-xiayige-" viewBox="0 0 1024 1024"><path d="M307.2 0L204.8 102.4 614.4 512 204.8 921.6 307.2 1024l512-512z"></path></symbol><symbol id="icon-wodeyigou" viewBox="0 0 1024 1024"><path d="M320 1024H128C57.6 1024 0 966.4 0 896V128C0 57.6 57.6 0 128 0h768c70.4 0 128 57.6 128 128v256H896V128H128v768h192v128z"></path><path d="M320 256h384c38.4 0 64 25.6 64 64s-25.6 64-64 64H320c-38.4 0-64-25.6-64-64s25.6-64 64-64z m0 256h256c38.4 0 64 25.6 64 64s-25.6 64-64 64H320c-38.4 0-64-25.6-64-64s25.6-64 64-64z m288 512c-19.2 0-32-6.4-44.8-19.2l-160-160c-25.6-25.6-25.6-64 0-89.6s64-25.6 89.6 0L608 870.4l307.2-307.2c25.6-25.6 64-25.6 89.6 0s25.6 64 0 89.6l-352 352c-12.8 12.8-25.6 19.2-44.8 19.2z"></path></symbol><symbol id="icon-fuzhi" viewBox="0 0 1024 1024"><path d="M884.5838112 150.4566784h-182.8008416V62.26367253a47.43483307 47.43483307 0 0 0-47.39119467-47.39119466H112.7531872A47.47847147 47.47847147 0 0 0 65.36199253 62.26367253v766.37583787a47.47847147 47.47847147 0 0 0 47.39119467 47.3911936h182.8008416v88.14936747a47.43483307 47.43483307 0 0 0 47.39119467 47.39119466h541.63858773a47.43483307 47.43483307 0 0 0 47.39119467-47.39119466V197.84787307a47.43483307 47.43483307 0 0 0-47.39119467-47.39119467z m-771.830624 685.1213216a6.8075744 6.8075744 0 0 1-6.76393707-6.76393707V62.26367253a6.8075744 6.8075744 0 0 1 6.76393707-6.763936h541.63858773a6.8075744 6.8075744 0 0 1 6.76393707 6.763936v766.37583787a6.8075744 6.8075744 0 0 1-6.76393707 6.763936z m778.59456107 128.77662507a6.76393707 6.76393707 0 0 1-6.76393707 6.76393706H342.94522347a6.76393707 6.76393707 0 0 1-6.76393707-6.76393706V878.77991787h318.21048853a47.43483307 47.43483307 0 0 0 47.39119467-47.39119467v-14.3570016h97.0079424a20.33544853 20.33544853 0 1 0 0-40.6272576h-97.0079424V677.17096853h97.0079424a20.33544853 20.33544853 0 1 0 0-40.62725866h-97.0079424v-101.58996374h97.0079424a20.33544853 20.33544853 0 1 0 0-40.6272576h-97.0079424V396.7948864h27.05574613a20.33544853 20.33544853 0 0 0 0-40.62725867h-27.05574613V191.08393707h182.8008416a6.76393707 6.76393707 0 0 1 6.76393707 6.763936zM159.0097856 218.008768a20.29181013 20.29181013 0 0 1 20.29181013-20.33544747h329.46917014a20.33544853 20.33544853 0 1 1 0 40.6272576h-329.46917014a20.29181013 20.29181013 0 0 1-20.29181013-20.29181013zM599.0584096 356.16762773a20.29181013 20.29181013 0 0 1-20.29180907 20.29181014H179.30159573a20.33544853 20.33544853 0 0 1 0-40.6272576h399.4650048a20.33544853 20.33544853 0 0 1 20.29180907 20.33544746z m0 142.173584a20.29181013 20.29181013 0 0 1-20.29180907 20.29181014H179.30159573a20.33544853 20.33544853 0 0 1 0-40.6272576h399.4650048a20.33544853 20.33544853 0 0 1 20.29180907 20.24817066z m0 139.90439254a20.29181013 20.29181013 0 0 1-20.29180907 20.29180906H179.30159573a20.29181013 20.29181013 0 0 1 0-40.5836192h399.4650048a20.29181013 20.29181013 0 0 1 20.29180907 20.29181014z m0 0"></path></symbol><symbol id="icon-share-money" viewBox="0 0 1118 1024"><path d="M672.156234 880.147582H147.126592C66.117191 880.041963 0.105619 814.136009 0 733.126608V147.155083C0.105619 66.145681 66.011572 0.134109 147.020974 0.002086h292.985762a34.431636 34.431636 0 1 1 0 68.863272H147.126592a78.276522 78.276522 0 0 0-78.157701 78.26332v585.786693a78.276522 78.276522 0 0 0 78.157701 78.26332h524.369526z" fill="#999999"></path><path d="M880.013473 166.800127a27.830479 27.830479 0 0 0-0.211237-2.957319v-0.422474c0-0.211237-0.105619-0.528093-0.105619-0.739329a0.950567 0.950567 0 0 0-0.105619-0.528093c-0.105619-0.422474-0.105619-0.73933-0.211237-1.161804a0.792139 0.792139 0 0 0-0.105618-0.422474c-0.105619-0.422474-0.211237-0.73933-0.316856-1.161803a0.382867 0.382867 0 0 0-0.105618-0.316856l-0.316856-1.320231v-0.211237c-0.105619-0.422474-0.316856-0.844948-0.422474-1.320232s-0.316856-0.950567-0.528092-1.320231c-0.211237-0.633711-0.528093-1.161804-0.73933-1.795515a26.404629 26.404629 0 0 0-2.429226-4.119122c-0.211237-0.316856-0.316856-0.528093-0.528092-0.844948l-0.950567-1.320232a11.221967 11.221967 0 0 0-0.950567-1.161803c-0.211237-0.211237-0.316856-0.422474-0.528092-0.633711L757.179139 12.069001a34.458041 34.458041 0 0 0-52.386784 44.782251L772.599442 135.985925c-169.253671 10.852302-297.949833 64.084034-382.972738 158.190132-123.996137 137.198452-107.202793 265.102474-106.463463 272.390152a34.16759 34.16759 0 0 0 34.11478 30.734988h0.105619c1.056185 0 2.323607 0 3.591029-0.105619a34.603266 34.603266 0 0 0 30.62937-37.811428c-0.105619-1.478659-13.730407-105.829753 89.564501-219.580895 72.348683-79.741979 184.515547-125.052323 334.018556-134.980463l-71.820591 95.690376a34.431636 34.431636 0 0 0 27.460814 55.132865h0.105619A34.920122 34.920122 0 0 0 758.55218 341.94203l114.490471-152.750778 0.105618-0.211237a5.861828 5.861828 0 0 1 0.633711-0.844948 4.475585 4.475585 0 0 0 0.528093-0.73933l0.633711-0.950566c0.105619-0.211237 0.316856-0.422474 0.422474-0.633711a4.594405 4.594405 0 0 0 0.422474-0.73933 0.369665 0.369665 0 0 0 0.105618-0.211237c0.211237-0.316856 0.316856-0.633711 0.528093-0.950567s0.422474-0.950567 0.633711-1.320231 0.422474-0.950567 0.633711-1.478659c0.105619-0.316856 0.211237-0.528093 0.316856-0.844948 0.211237-0.633711 0.422474-1.161804 0.633711-1.795515a8.792741 8.792741 0 0 0 0.422474-1.584278c0.105619-0.422474 0.211237-0.73933 0.316855-1.161804a4.488787 4.488787 0 0 0 0.211237-1.161803c0.105619-0.422474 0.105619-0.73933 0.211238-1.161804a4.739631 4.739631 0 0 0 0.105618-1.161804c0-0.316856 0.105619-0.633711 0.105619-0.950566 0-0.633711 0.105619-1.320231 0.105618-1.795515a20.371171 20.371171 0 0 0-0.105618-2.640463z" fill="#999999"></path><path d="M879.802236 163.842808a25.968953 25.968953 0 0 1 0.211237 2.957319 27.830479 27.830479 0 0 0-0.211237-2.957319z" fill=""></path><path d="M832.31351 452.445402C674.479841 452.445402 546.575819 580.389032 546.575819 738.222701s127.943629 285.777299 285.777298 285.777299 285.777299-127.943629 285.777299-285.777299S990.173584 452.445402 832.31351 452.445402zM962.448724 764.785758a24.846756 24.846756 0 1 1 0 49.535084h-103.823001v103.096873a24.767542 24.767542 0 1 1-49.535084 0V814.320842h-103.862608a24.846756 24.846756 0 1 1 0-49.535084h103.862608v-28.398178h-103.862608a24.846756 24.846756 0 1 1 0-49.535084h73.431273l-53.522182-79.953217a24.767542 24.767542 0 0 1 41.204423-27.474016L833.066042 679.432795l66.988544-100.469613a24.899565 24.899565 0 0 1 41.204423 27.936097l-53.297743 79.953217H962.448724a24.846756 24.846756 0 1 1 0 49.535084h-103.823001v28.398178z" fill="#FA8919"></path></symbol><symbol id="icon-ziyuan1" viewBox="0 0 1024 1024"><path d="M1023.978534 579.416768v273.410086c-0.122881 94.249679-76.923467 171.050265-171.050265 171.173146H171.184827C76.935148 1023.877119 0.134562 947.199414 0.011681 852.949735V171.206293C0.134562 76.956614 76.812267 0.156028 171.061947 0.002427h340.87172a40.059186 40.059186 0 1 1 0 80.118371H171.184827a91.070135 91.070135 0 0 0-90.931893 91.054775v681.5284a91.070135 91.070135 0 0 0 90.931893 91.054775H852.805388a91.085495 91.085495 0 0 0 91.054775-91.054775V579.416768a40.059186 40.059186 0 0 1 80.118371 0z m-9.21607-389.901215a35.45115 35.45115 0 0 1 0.491524 3.563547c-0.122881-1.105928-0.245762-2.334738-0.491524-3.563547z" fill="#999999"></path><path d="M1023.855653 194.062148a32.379127 32.379127 0 0 0-0.245762-3.440667v-0.491523c0-0.245762-0.122881-0.614405-0.12288-0.860167a1.105928 1.105928 0 0 0-0.122881-0.614405c-0.122881-0.491524-0.122881-0.860167-0.245762-1.35169a0.921607 0.921607 0 0 0-0.122881-0.491524c-0.122881-0.491524-0.245762-0.860167-0.368643-1.35169a0.445443 0.445443 0 0 0-0.122881-0.368643l-0.368643-1.536012v-0.245761c-0.122881-0.491524-0.368643-0.983048-0.491524-1.536012s-0.368643-1.105928-0.614404-1.536012c-0.245762-0.737286-0.614405-1.35169-0.860167-2.088976a30.720234 30.720234 0 0 0-2.826261-4.792356c-0.245762-0.368643-0.368643-0.614405-0.614405-0.983048l-1.105928-1.536012a13.0561 13.0561 0 0 0-1.105929-1.35169c-0.245762-0.245762-0.368643-0.491524-0.614405-0.737286L880.945123 14.041574a40.089906 40.089906 0 0 0-60.948945 52.101518L898.88574 158.211634c-196.916702 12.626016-346.647125 74.558009-445.56628 184.044924-144.262221 159.622338-124.724152 308.431153-123.863985 316.909938a39.751983 39.751983 0 0 0 39.690543 35.758353h0.122881c1.228809 0 2.703381 0 4.177952-0.122881a40.258867 40.258867 0 0 0 35.635472-43.991375c-0.122881-1.720333-15.974522-123.126699 104.203035-255.46947 84.173442-92.775108 214.672998-145.49103 388.610965-157.041838l-83.559038 111.33013a40.059186 40.059186 0 0 0 31.949044 64.143849h0.122881A40.62751 40.62751 0 0 0 882.542575 397.829462l133.202936-177.716556 0.122881-0.245762a6.819892 6.819892 0 0 1 0.737286-0.983047 5.20708 5.20708 0 0 0 0.614405-0.860167l0.737285-1.105928c0.122881-0.245762 0.368643-0.491524 0.491524-0.737286a5.345321 5.345321 0 0 0 0.491524-0.860166 0.430083 0.430083 0 0 0 0.122881-0.245762c0.245762-0.368643 0.368643-0.737286 0.614404-1.105929s0.491524-1.105928 0.737286-1.536011 0.491524-1.105928 0.737286-1.720333c0.122881-0.368643 0.245762-0.614405 0.368643-0.983048 0.245762-0.737286 0.491524-1.35169 0.737285-2.088976a10.229838 10.229838 0 0 0 0.491524-1.843214c0.122881-0.491524 0.245762-0.860167 0.368643-1.35169a5.22244 5.22244 0 0 0 0.245762-1.351691c0.122881-0.491524 0.122881-0.860167 0.245761-1.35169a5.514282 5.514282 0 0 0 0.122881-1.35169c0-0.368643 0.122881-0.737286 0.122881-1.105929 0-0.737286 0.122881-1.536012 0.122881-2.088976a23.700661 23.700661 0 0 0-0.122881-3.072023z m-9.093189-4.608036a35.45115 35.45115 0 0 1 0.491524 3.563548c-0.122881-1.105928-0.245762-2.334738-0.491524-3.563548z" fill="#999999"></path></symbol></svg><div id="app"><div data-v-87ffcada="" class="article"><!----> <div data-v-87ffcada="" class="main main-app"><div data-v-87ffcada="" class="breadcrumb breadcrumb pd"><span><a href="/" class="title router-link-active">讲堂</a> <span class="split iconfont"></span></span><span><a href="/column/139" class="title">MySQL实战45讲</a> <span class="split iconfont"></span></span><span><span class="title">文章详情</span> <!----></span></div> <h1 data-v-87ffcada="" class="article-title pd">
        08 | 事务到底是隔离的还是不隔离的？
      </h1> <div data-v-87ffcada="" class="article-info pd"><span data-v-87ffcada="">2018-11-30</span> <span data-v-87ffcada="">林晓斌</span></div> <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada="" src="https://static001.geekbang.org/resource/image/89/69/89a920f1feb00925fb5a94610af89569.jpg"> <!----> <div data-v-87ffcada="" class="mini-audio-player"><a href="javascript:;" class="btn-play"></a> <div class="audio-info"><h3>08 | 事务到底是隔离的还是不隔离的？</h3> <p><span>朗读人：林晓斌&nbsp;&nbsp;&nbsp;</span> <span>19′01′′ | 17.43M</span></p></div> <!----> <audio title="08 | 事务到底是隔离的还是不隔离的？" src="https://static001.geekbang.org/resource/audio/79/5a/797668397b630849768ecf8c7393e85a.mp3" controls="controls"></audio></div> <div data-v-87ffcada="" id="article-content" class=""><div class="text"><p>我在第 3 篇文章和你讲事务隔离级别的时候提到过，如果是可重复读隔离级别，事务 T 启动的时候会创建一个视图 read-view，之后事务 T 执行期间，即使有其他事务修改了数据，事务 T 看到的仍然跟在启动时看到的一样。也就是说，一个在可重复读隔离级别下执行的事务，好像与世无争，不受外界影响。</p><p>但是，我在上一篇文章中，和你分享行锁的时候又提到，一个事务要更新一行，如果刚好有另外一个事务拥有这一行的行锁，它又不能这么超然了，会被锁住，进入等待状态。问题是，既然进入了等待状态，那么等到这个事务自己获取到行锁要更新数据的时候，它读到的值又是什么呢？</p><p>我给你举一个例子吧。下面是一个只有两行的表的初始化语句。</p><pre style="position: relative;"><code><table class="hljs-ln"><tbody><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">mysql&gt; CREATE TABLE `t` (</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">  `id` int(11) NOT NULL,</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">  `k` int(11) DEFAULT NULL,</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">  PRIMARY KEY (`id`)</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">) ENGINE=InnoDB;</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">insert into t(id, k) values(1,1),(2,2);</div></td></tr></tbody></table></code><div class="richcontent-pre-copy"><span class="iconfont"></span>复制代码</div></pre><p><img src="https://static001.geekbang.org/resource/image/82/d6/823acf76e53c0bdba7beab45e72e90d6.png" alt=""></p><center>图 1 事务 A、B、C 的执行流程</center><p>这里，我们需要注意的是事务的启动时机。</p><p>begin/start transaction 命令并不是一个事务的起点，在执行到它们之后的第一个操作 InnoDB 表的语句（第一个快照读语句），事务才真正启动。如果你想要马上启动一个事务，可以使用 start transaction with consistent snapshot 这个命令。</p><p>还需要注意的是，在整个专栏里面，我们的例子中如果没有特别说明，都是默认 autocommit=1。</p><!-- [[[read_end]]] --><p>在这个例子中，事务 C 没有显式地使用 begin/commit，表示这个 update 语句本身就是一个事务，语句完成的时候会自动提交。事务 B 在更新了行之后查询 ; 事务 A 在一个只读事务中查询，并且时间顺序上是在事务 B 的查询之后。</p><p>这时，如果我告诉你事务 B 查到的 k 的值是 3，而事务 A 查到的 k 的值是 1，你是不是感觉有点晕呢？</p><p>所以，今天这篇文章，我其实就是想和你说明白这个问题，希望借由把这个疑惑解开的过程，能够帮助你对 InnoDB 的事务和锁有更进一步的理解。</p><p>在 MySQL 里，有两个“视图”的概念：</p><ul>
<li>一个是 view。它是一个用查询语句定义的虚拟表，在调用的时候执行查询语句并生成结果。创建视图的语法是 create view ... ，而它的查询方法与表一样。</li>
<li>另一个是 InnoDB 在实现 MVCC 时用到的一致性读视图，即 consistent read view，用于支持 RC（Read Committed，读提交）和 RR（Repeatable Read，可重复读）隔离级别的实现。</li>
</ul><p>它没有物理结构，作用是事务执行期间用来定义“我能看到什么数据”。</p><p>在第 3 篇文章<a href="https://time.geekbang.org/column/article/68963">《事务隔离：为什么你改了我还看不见？》</a>中，我跟你解释过一遍 MVCC 的实现逻辑。今天为了说明查询和更新的区别，我换一个方式来说明，把 read view 拆开。你可以结合这两篇文章的说明来更深一步地理解 MVCC。</p><h1>“快照”在 MVCC 里是怎么工作的？</h1><p>在可重复读隔离级别下，事务在启动的时候就“拍了个快照”。注意，这个快照是基于整库的。</p><p>这时，你会说这看上去不太现实啊。如果一个库有 100G，那么我启动一个事务，MySQL 就要拷贝 100G 的数据出来，这个过程得多慢啊。可是，我平时的事务执行起来很快啊。</p><p>实际上，我们并不需要拷贝出这 100G 的数据。我们先来看看这个快照是怎么实现的。</p><p>InnoDB 里面每个事务有一个唯一的事务 ID，叫作 transaction id。它是在事务开始的时候向 InnoDB 的事务系统申请的，是按申请顺序严格递增的。</p><p>而每行数据也都是有多个版本的。每次事务更新数据的时候，都会生成一个新的数据版本，并且把 transaction id 赋值给这个数据版本的事务 ID，记为 row trx_id。同时，旧的数据版本要保留，并且在新的数据版本中，能够有信息可以直接拿到它。</p><p>也就是说，数据表中的一行记录，其实可能有多个版本 (row)，每个版本有自己的 row trx_id。</p><p>如图 2 所示，就是一个记录被多个事务连续更新后的状态。</p><p><img src="https://static001.geekbang.org/resource/image/68/ed/68d08d277a6f7926a41cc5541d3dfced.png" alt=""></p><center>图 2 行状态变更图</center><p>图中虚线框里是同一行数据的 4 个版本，当前最新版本是 V4，k 的值是 22，它是被 transaction id 为 25 的事务更新的，因此它的 row trx_id 也是 25。</p><p>你可能会问，前面的文章不是说，语句更新会生成 undo log（回滚日志）吗？那么，<strong>undo log 在哪呢？</strong></p><p>实际上，图 2 中的三个虚线箭头，就是 undo log；而 V1、V2、V3 并不是物理上真实存在的，而是每次需要的时候根据当前版本和 undo log 计算出来的。比如，需要 V2 的时候，就是通过 V4 依次执行 U3、U2 算出来。</p><p>明白了多版本和 row trx_id 的概念后，我们再来想一下，InnoDB 是怎么定义那个“100G”的快照的。</p><p>按照可重复读的定义，一个事务启动的时候，能够看到所有已经提交的事务结果。但是之后，这个事务执行期间，其他事务的更新对它不可见。</p><p>因此，一个事务只需要在启动的时候声明说，“以我启动的时刻为准，如果一个数据版本是在我启动之前生成的，就认；如果是我启动以后才生成的，我就不认，我必须要找到它的上一个版本”。</p><p>当然，如果“上一个版本”也不可见，那就得继续往前找。还有，如果是这个事务自己更新的数据，它自己还是要认的。</p><p>在实现上， InnoDB 为每个事务构造了一个数组，用来保存这个事务启动瞬间，当前正在“活跃”的所有事务 ID。“活跃”指的就是，启动了但还没提交。</p><p>数组里面事务 ID 的最小值记为低水位，当前系统里面已经创建过的事务 ID 的最大值加 1 记为高水位。</p><p>这个视图数组和高水位，就组成了当前事务的一致性视图（read-view）。</p><p>而数据版本的可见性规则，就是基于数据的 row trx_id 和这个一致性视图的对比结果得到的。</p><p>这个视图数组把所有的 row trx_id 分成了几种不同的情况。</p><p><img src="https://static001.geekbang.org/resource/image/88/5e/882114aaf55861832b4270d44507695e.png" alt=""></p><center>图 3 数据版本可见性规则</center><p>这样，对于当前事务的启动瞬间来说，一个数据版本的 row trx_id，有以下几种可能：</p><ol>
<li>
<p>如果落在绿色部分，表示这个版本是已提交的事务或者是当前事务自己生成的，这个数据是可见的；</p>
</li>
<li>
<p>如果落在红色部分，表示这个版本是由将来启动的事务生成的，是肯定不可见的；</p>
</li>
<li>
<p>如果落在黄色部分，那就包括两种情况<br>
a.  若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>
b.  若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。</p>
</li>
</ol><p>比如，对于图 2 中的数据来说，如果有一个事务，它的低水位是 18，那么当它访问这一行数据时，就会从 V4 通过 U3 计算出 V3，所以在它看来，这一行的值是 11。</p><p>你看，有了这个声明后，系统里面随后发生的更新，是不是就跟这个事务看到的内容无关了呢？因为之后的更新，生成的版本一定属于上面的 2 或者 3(a) 的情况，而对它来说，这些新的数据版本是不存在的，所以这个事务的快照，就是“静态”的了。</p><p>所以你现在知道了，<strong>InnoDB 利用了“所有数据都有多个版本”的这个特性，实现了“秒级创建快照”的能力。</strong></p><p>接下来，我们继续看一下图 1 中的三个事务，分析下事务 A 的语句返回的结果，为什么是 k=1。</p><p>这里，我们不妨做如下假设：</p><ol>
<li>
<p>事务 A 开始前，系统里面只有一个活跃事务 ID 是 99；</p>
</li>
<li>
<p>事务 A、B、C 的版本号分别是 100、101、102，且当前系统里只有这四个事务；</p>
</li>
<li>
<p>三个事务开始前，(1,1）这一行数据的 row trx_id 是 90。</p>
</li>
</ol><p>这样，事务 A 的视图数组就是 [99,100], 事务 B 的视图数组是 [99,100,101], 事务 C 的视图数组是 [99,100,101,102]。</p><p>为了简化分析，我先把其他干扰语句去掉，只画出跟事务 A 查询逻辑有关的操作：</p><p><img src="https://static001.geekbang.org/resource/image/94/49/9416c310e406519b7460437cb0c5c149.png" alt=""></p><center>图 4 事务 A 查询数据逻辑图</center><p>从图中可以看到，第一个有效更新是事务 C，把数据从 (1,1) 改成了 (1,2)。这时候，这个数据的最新版本的 row trx_id 是 102，而 90 这个版本已经成为了历史版本。</p><p>第二个有效更新是事务 B，把数据从 (1,2) 改成了 (1,3)。这时候，这个数据的最新版本（即 row trx_id）是 101，而 102 又成为了历史版本。</p><p>你可能注意到了，在事务 A 查询的时候，其实事务 B 还没有提交，但是它生成的 (1,3) 这个版本已经变成当前版本了。但这个版本对事务 A 必须是不可见的，否则就变成脏读了。</p><p>好，现在事务 A 要来读数据了，它的视图数组是 [99,100]。当然了，读数据都是从当前版本读起的。所以，事务 A 查询语句的读数据流程是这样的：</p><ul>
<li>找到 (1,3) 的时候，判断出 row trx_id=101，比高水位大，处于红色区域，不可见；</li>
<li>接着，找到上一个历史版本，一看 row trx_id=102，比高水位大，处于红色区域，不可见；</li>
<li>再往前找，终于找到了（1,1)，它的 row trx_id=90，比低水位小，处于绿色区域，可见。</li>
</ul><p>这样执行下来，虽然期间这一行数据被修改过，但是事务 A 不论在什么时候查询，看到这行数据的结果都是一致的，所以我们称之为一致性读。</p><p>这个判断规则是从代码逻辑直接转译过来的，但是正如你所见，用于人肉分析可见性很麻烦。</p><p>所以，我来给你翻译一下。一个数据版本，对于一个事务视图来说，除了自己的更新总是可见以外，有三种情况：</p><ol>
<li>
<p>版本未提交，不可见；</p>
</li>
<li>
<p>版本已提交，但是是在视图创建后提交的，不可见；</p>
</li>
<li>
<p>版本已提交，而且是在视图创建前提交的，可见。</p>
</li>
</ol><p>现在，我们用这个规则来判断图 4 中的查询结果，事务 A 的查询语句的视图数组是在事务 A 启动的时候生成的，这时候：</p><ul>
<li>(1,3) 还没提交，属于情况 1，不可见；</li>
<li>(1,2) 虽然提交了，但是是在视图数组创建之后提交的，属于情况 2，不可见；</li>
<li>(1,1) 是在视图数组创建之前提交的，可见。</li>
</ul><p>你看，去掉数字对比后，只用时间先后顺序来判断，分析起来是不是轻松多了。所以，后面我们就都用这个规则来分析。</p><h1>更新逻辑</h1><p>细心的同学可能有疑问了：<strong>事务 B 的 update 语句，如果按照一致性读，好像结果不对哦？</strong></p><p>你看图 5 中，事务 B 的视图数组是先生成的，之后事务 C 才提交，不是应该看不见 (1,2) 吗，怎么能算出 (1,3) 来？</p><p><img src="https://static001.geekbang.org/resource/image/86/9f/86ad7e8abe7bf16505b97718d8ac149f.png" alt=""></p><center>图 5 事务 B 更新逻辑图</center><p>是的，如果事务 B 在更新之前查询一次数据，这个查询返回的 k 的值确实是 1。</p><p>但是，当它要去更新数据的时候，就不能再在历史版本上更新了，否则事务 C 的更新就丢失了。因此，事务 B 此时的 set k=k+1 是在（1,2）的基础上进行的操作。</p><p>所以，这里就用到了这样一条规则：<strong>更新数据都是先读后写的，而这个读，只能读当前的值，称为“当前读”（current read）。</strong></p><p>因此，在更新的时候，当前读拿到的数据是 (1,2)，更新后生成了新版本的数据 (1,3)，这个新版本的 row trx_id 是 101。</p><p>所以，在执行事务 B 查询语句的时候，一看自己的版本号是 101，最新数据的版本号也是 101，是自己的更新，可以直接使用，所以查询得到的 k 的值是 3。</p><p>这里我们提到了一个概念，叫作当前读。其实，除了 update 语句外，select 语句如果加锁，也是当前读。</p><p>所以，如果把事务 A 的查询语句 select * from t where id=1 修改一下，加上 lock in share mode 或 for update，也都可以读到版本号是 101 的数据，返回的 k 的值是 3。下面这两个 select 语句，就是分别加了读锁（S 锁，共享锁）和写锁（X 锁，排他锁）。</p><pre style="position: relative;"><code><table class="hljs-ln"><tbody><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">mysql&gt; select k from t where id=1 lock in share mode;</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">mysql&gt; select k from t where id=1 for update;</div></td></tr></tbody></table></code><div class="richcontent-pre-copy"><span class="iconfont"></span>复制代码</div></pre><p>再往前一步，假设事务 C 不是马上提交的，而是变成了下面的事务 C’，会怎么样呢？</p><p><img src="https://static001.geekbang.org/resource/image/cd/6e/cda2a0d7decb61e59dddc83ac51efb6e.png" alt=""></p><center>图 6 事务 A、B、C'的执行流程</center><p>事务 C’的不同是，更新后并没有马上提交，在它提交前，事务 B 的更新语句先发起了。前面说过了，虽然事务 C’还没提交，但是 (1,2) 这个版本也已经生成了，并且是当前的最新版本。那么，事务 B 的更新语句会怎么处理呢？</p><p>这时候，我们在上一篇文章中提到的“两阶段锁协议”就要上场了。事务 C’没提交，也就是说 (1,2) 这个版本上的写锁还没释放。而事务 B 是当前读，必须要读最新版本，而且必须加锁，因此就被锁住了，必须等到事务 C’释放这个锁，才能继续它的当前读。</p><p><img src="https://static001.geekbang.org/resource/image/54/92/540967ea905e8b63630e496786d84c92.png" alt=""></p><center>图 7 事务 B 更新逻辑图（配合事务 C'）</center><p>到这里，我们把一致性读、当前读和行锁就串起来了。</p><p>现在，我们再回到文章开头的问题：<strong>事务的可重复读的能力是怎么实现的？</strong></p><p>可重复读的核心就是一致性读（consistent read）；而事务更新数据的时候，只能用当前读。如果当前的记录的行锁被其他事务占用的话，就需要进入锁等待。</p><p>而读提交的逻辑和可重复读的逻辑类似，它们最主要的区别是：</p><ul>
<li>在可重复读隔离级别下，只需要在事务开始的时候创建一致性视图，之后事务里的其他查询都共用这个一致性视图；</li>
<li>在读提交隔离级别下，每一个语句执行前都会重新算出一个新的视图。</li>
</ul><p>那么，我们再看一下，在读提交隔离级别下，事务 A 和事务 B 的查询语句查到的 k，分别应该是多少呢？</p><p>这里需要说明一下，“start transaction with consistent snapshot; ”的意思是从这个语句开始，创建一个持续整个事务的一致性快照。所以，在读提交隔离级别下，这个用法就没意义了，等效于普通的 start transaction。</p><p>下面是读提交时的状态图，可以看到这两个查询语句的创建视图数组的时机发生了变化，就是图中的 read view 框。（注意：这里，我们用的还是事务 C 的逻辑直接提交，而不是事务 C’）</p><p><img src="https://static001.geekbang.org/resource/image/ed/6e/ed4b8d03287df67ecca53b5b4830ee6e.png" alt=""></p><center>图 8 读提交隔离级别下的事务状态图</center><p>这时，事务 A 的查询语句的视图数组是在执行这个语句的时候创建的，时序上 (1,2)、(1,3) 的生成时间都在创建这个视图数组的时刻之前。但是，在这个时刻：</p><ul>
<li>(1,3) 还没提交，属于情况 1，不可见；</li>
<li>(1,2) 提交了，属于情况 3，可见。</li>
</ul><p>所以，这时候事务 A 查询语句返回的是 k=2。</p><p>显然地，事务 B 查询结果 k=3。</p><h1>小结</h1><p>InnoDB 的行数据有多个版本，每个数据版本有自己的 row trx_id，每个事务或者语句有自己的一致性视图。普通查询语句是一致性读，一致性读会根据 row trx_id 和一致性视图确定数据版本的可见性。</p><ul>
<li>对于可重复读，查询只承认在事务启动前就已经提交完成的数据；</li>
<li>对于读提交，查询只承认在语句启动前就已经提交完成的数据；</li>
</ul><p>而当前读，总是读取已经提交完成的最新版本。</p><p>你也可以想一下，为什么表结构不支持“可重复读”？这是因为表结构没有对应的行数据，也没有 row trx_id，因此只能遵循当前读的逻辑。</p><p>当然，MySQL 8.0 已经可以把表结构放在 InnoDB 字典里了，也许以后会支持表结构的可重复读。</p><p>又到思考题时间了。我用下面的表结构和初始化语句作为试验环境，事务隔离级别是可重复读。现在，我要把所有“字段 c 和 id 值相等的行”的 c 值清零，但是却发现了一个“诡异”的、改不掉的情况。请你构造出这种情况，并说明其原理。</p><pre style="position: relative;"><code><table class="hljs-ln"><tbody><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">mysql&gt; CREATE TABLE `t` (</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">  `id` int(11) NOT NULL,</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">  `c` int(11) DEFAULT NULL,</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">  PRIMARY KEY (`id`)</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">) ENGINE=InnoDB;</div></td></tr><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">insert into t(id, c) values(1,1),(2,2),(3,3),(4,4);</div></td></tr></tbody></table></code><div class="richcontent-pre-copy"><span class="iconfont"></span>复制代码</div></pre><p><img src="https://static001.geekbang.org/resource/image/9b/0b/9b8fe7cf88c9ba40dc12e93e36c3060b.png" alt=""><br>
复现出来以后，请你再思考一下，在实际的业务开发中有没有可能碰到这种情况？你的应用代码会不会掉进这个“坑”里，你又是怎么解决的呢？</p><p>你可以把你的思考和观点写在留言区里，我会在下一篇文章的末尾和你讨论这个问题。感谢你的收听，也欢迎你把这篇文章分享给更多的朋友一起阅读。</p><h1>上期问题时间</h1><p>我在上一篇文章最后，留给你的问题是：怎么删除表的前 10000 行。比较多的留言都选择了第二种方式，即：在一个连接中循环执行 20 次 delete from T limit 500。</p><p>确实是这样的，第二种方式是相对较好的。</p><p>第一种方式（即：直接执行 delete from T limit 10000）里面，单个语句占用时间长，锁的时间也比较长；而且大事务还会导致主从延迟。</p><p>第三种方式（即：在 20 个连接中同时执行 delete from T limit 500），会人为造成锁冲突。</p><p>评论区留言点赞板：</p><blockquote>
<p>@Tony Du 的评论，详细而且准确。<br>
@Knight²º¹⁸ 提到了如果可以加上特定条件，将这 10000 行天然分开，可以考虑第三种。是的，实际上在操作的时候我也建议你尽量拿到 ID 再删除。<br>
@荒漠甘泉 提了一个不错的问题，大家需要区分行锁、MDL 锁和表锁的区别。对 InnoDB 表更新一行，可能过了 MDL 关，却被挡在行锁阶段。</p>
</blockquote><p><img src="https://static001.geekbang.org/resource/image/ce/d9/ce7f4e35916ed1aa49206a53a0547bd9.jpg" alt=""></p></div></div> <!----> <div data-v-87ffcada="" class="copyright">
          ©版权归极客邦科技所有，未经许可不得转载
        </div></div> <div data-v-87ffcada="" class="switch-btns pd"><div data-v-87ffcada="" class="btn"><div data-v-87ffcada="" class="tag">上一篇</div> <div data-v-87ffcada="" class="txt">07 | 行锁功过：怎么减少行锁对性能的影响？</div></div> <div data-v-87ffcada="" class="btn"><div data-v-87ffcada="" class="tag">下一篇</div> <div data-v-87ffcada="" class="txt">09 | 普通索引和唯一索引，应该怎么选择？</div></div></div> <div data-v-87ffcada="" class="to-comment pd"><a data-v-87ffcada="" class="button-primary">写留言</a></div> <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span data-v-87ffcada="">精选留言</span></h2> <ul data-v-87ffcada=""><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/0c/ee/7667642c.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">夏日雨</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>47</span></a></div></div> <div class="bd">老师你好，有个问题不太理解，对于文中的例子假设transaction id为98的事务在事务A执行select（Q2）之前更新了字段，那么事务A发现这个字段的row trx_id是98，比自己的up_limit_id要小，那此时事务A不就获取到了transaction id为98的事务更新后的值了吗？<br>换句话说对于文中"之后的更新，产生的新的数据版本的 row trx_id 都会大于 up_limit_id"这句话不太理解， up_limit_id是已经提交事务id的最大值，那也可能存在一个没有提交的id小于up_limit_id的事务对数据进行更新？还是说transaction id比up_limit_id小的事务都是保证已经提交的？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你的问题被引用最多，我回复你哈，其它同学看过来😄<br><br>好吧，今天的课后问题其实比较简单，本来是隐藏在思考题里的彩蛋，被你问出来了哈。<br><br>Innodb 要保证这个规则：事务启动以前所有还没提交的事务，它都不可见。<br><br>但是只存一个已经提交事务的最大值是不够的。 因为存在一个问题，那些比最大值小的事务，之后也可能更新（就是你说的98这个事务）<br><br>所以事务启动的时候还要保存“现在正在执行的所有事物ID列表”，如果一个row trx_id在这列表中，也要不可见。<br><br>虽然踩破了彩蛋，还是赞你的思考哈，置顶让大家学习😄</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">约书亚</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>28</span></a></div></div> <div class="bd">早。<br>思考题，RR下，用另外一个事物在update执行之前，先把所有c值修改，应该就可以。比如update t set c = id + 1。<br>这个实际场景还挺常见——所谓的“乐观锁”。时常我们会基于version字段对row进行cas式的更新，类似update ...set ... where id = xxx and version = xxx。如果version被其他事务抢先更新，则在自己事务中更新失败，trx_id没有变成自身事务的id，同一个事务中再次select还是旧值，就会出现“明明值没变可就是更新不了”的“异象”（anomaly）。解决方案就是每次cas更新不管成功失败，结束当前事务。如果失败则重新起一个事务进行查询更新。<br>记得某期给老师留言提到了，似乎只有MySQL是在一致性视图下采用这种宽松的update机制。也许是考虑易用性吧。其他数据库大多在内部实现cas，只是失败后下一步动作有区别。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">早<br><br>赞<br><br>置顶了<br><br>明天课后问题时间直接指针引用了哈😄<br><br>补充一下：上面说的“如果失败就重新起一个事务”，里面判断是否成功的标准是 affected_rows 是不是等于预期值。 <br>比如我们这个例子里面预期值本来是4，当然实际业务中这种语句一般是匹配唯一主键，所以预期住值一般是1。<br><br></p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/30/29/7d34099d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">ithunter</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>5</span></a></div></div> <div class="bd">请教一个问题，业务上有这样的需求，A、B两个用户，如果互相喜欢，则成为好友。设计上是有两张表，一个是like表，一个是friend表，like表有user_id、liker_id两个字段，我设置为复合唯一索引即uk_user_id_liker_id。语句执行顺序是这样的：<br>以A喜欢B为例：<br>1、先查询对方有没有喜欢自己（B有没有喜欢A）<br>select * from like where user_id = B and liker_id = A<br>2、如果有，则成为好友<br>insert into friend<br>3、没有，则只是喜欢关系<br>insert into like<br><br>如果A、B同时喜欢对方，会出现不会成为好友的问题。因为上面第1步，双方都没喜欢对方。第1步即使使用了排他锁也不行，因为记录不存在，行锁无法生效。请问这种情况，在mysql锁层面有没有办法处理</div> <span class="time">2018-12-05</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你这个问题很有趣。我想到一个不错的解法。不过我先置顶。让别的同学来回答看看。<br><br>好问题，谁有想法po出来。</p> <p class="reply-time">2018-12-06</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/05/f3/5488276f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">心雨鑫晴</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>3</span></a></div></div> <div class="bd">老师，我有一个问题。当开启事务时，需要保存活跃事务的数组（A），然后获取高水位（B）。我的疑问就是，在这两个动作之间（A和B之间）会不会产生新的事务？如果产生了新的事务，那么这个新的事务相对于当前事务就是可见的，不管有没有提交。</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">好问题，有很深入的思考哈<br><br>代码实现上，获取视图数组和高水位是在事务系统的锁保护下做的，可以认为是原子操作，期间不能创建事务。<br></p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/31/fe/30a17a9d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Leo</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>3</span></a></div></div> <div class="bd">老师在文中说: "所以，在执行事务 B 的 Q1 语句的时候，一看自己的版本号是 101，最新数据的版本号也是 101，可以用，所以 Q1 得到的 k 的值是 3。"，<br>1. 这里不参考up_limit_id了吗？<br>2. 如果参考，事务B的up_limit_id是在执行update语句前重新计算的，还是在执行Q1语句前重新计算的？<br></div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">1. 判断可见性两个规则：一个是up_limit_id ,另一个是“自己修改的”；这里用到第二个规则<br><br>2.  这时候事务Bup_limit_id还是99</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/61/57/6f3c81dd.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">阿建</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">以下是一个错误的理解，在编写评论的过程中用前面刚学到的知识把自己的结论推翻，有一种快感，所以还是决定发出来。 哈哈~<br><br>事务A(100) | 事务B(101)<br>-------------------<br>             | select(1)<br>-------------------<br>             | update  <br>-------------------<br>  update  |<br>-------------------<br>              | select(2) <br>-------------------<br>事务A B在事务启动时的up_limit_id为99<br>事务B update 之后表格的每一行的row_trx_id变为101 <br>事务A 再update 之后每一行的row_trx_id变为100<br>事务B的select(2)时因为隔离级别是RR，所以去遍历的时候找row_trx_id&lt;=101的版本返回，优先找到版本为100的，就会导致select(2)并没有取到自己的更新。<br>对于对于自己的修改也认这句话和undo-log的介绍，我觉的这种情况下会获取不到自己更新的最新的数据。不知道我理解的对不对。<br><br>不对！因为事务A的update是会被行锁锁住的，而且锁是要在事务B结束之后才释放，所以不存在在事务B的update之后还在事务中被事务A给更新，导致上面的问题。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍🏿<br><br>我在学习过程中也是最喜欢这种“自己推翻自己结论”的快感</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/c0/25/348b4d76.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">墨萧</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">可重复读情况下，事务c的102早于事务b的101，如果事务c再get k，那不是就取得101的值了？不太明白。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">咱们例子里面，事务C是直接提交的，再执行一个GET 就是另外一个事务了… <br><br>如果你说的是用begin 来启动一个多语句事务，那么事务c在更新后查询，还是看到row trx_id是102的。  【注意：如果它还没提交，101根本生成不出来，因为事务B被行锁挡着呢】</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">某、人</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>26</span></a></div></div> <div class="bd">这篇理论知识很丰富,需要先总结下<br>1.innodb支持RC和RR隔离级别实现是用的一致性视图(consistent read view)<br><br>2.事务在启动时会拍一个快照,这个快照是基于整个库的.<br>基于整个库的意思就是说一个事务内,整个库的修改对于该事务都是不可见的(对于快照读的情况)<br>如果在事务内select t表,另外的事务执行了DDL t表,根据发生时间,要嘛锁住要嘛报错(参考第六章)<br><br>3.事务是如何实现的MVCC呢?<br>(1)每个事务都有一个事务ID,叫做transaction id(严格递增)<br>(2)事务在启动时,找到已提交的最大事务ID记为up_limit_id。<br>(3)事务在更新一条语句时,比如id=1改为了id=2.会把id=1和该行之前的row trx_id写到undo log里,<br>并且在数据页上把id的值改为2,并且把修改这条语句的transaction id记在该行行头<br>(4)再定一个规矩,一个事务要查看一条数据时,必须先用该事务的up_limit_id与该行的transaction id做比对,<br>如果up_limit_id&gt;=transaction id,那么可以看.如果up_limit_id&lt;transaction id,则只能去undo log里去取。去undo log查找数据的时候,也需要做比对,必须up_limit_id&gt;transaction id,才返回数据<br><br>4.什么是当前读,由于当前读都是先读后写,只能读当前的值,所以为当前读.会更新事务内的up_limit_id为该事务的transaction id<br><br>5.为什么rr能实现可重复读而rc不能,分两种情况<br>(1)快照读的情况下,rr不能更新事务内的up_limit_id,<br>    而rc每次会把up_limit_id更新为快照读之前最新已提交事务的transaction id,则rc不能可重复读<br>(2)当前读的情况下,rr是利用record lock+gap lock来实现的,而rc没有gap,所以rc不能可重复读</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍🏿<br><br>本篇知识点全get</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/1f/ff/aadcf237.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Eric</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>12</span></a></div></div> <div class="bd">我不是dba，这个课程还是需要一些基础才会更有帮助，有些章节对我来说确实看起来有些吃力，但是在坚持，一遍看不懂看两遍、三遍，同时查漏补缺的去找一些资料补充盲点，还组了个一起学习的群，希望能坚持下去，收获满满</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">赞👍🏿<br>慢慢来</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/04/b8/3fd2f448.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">lucky star</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>7</span></a></div></div> <div class="bd">答案：<br>      分析： 假设有两个事务A和B， 且A事务是更新c=0的事务； 给定条件： 1， 事务A update 语句已经执行成功， 说明没有另外一个活动中的事务在执行修改条件为id in 1,2,3,4或c in 1,2,3,4, 否则update会被锁阻塞； 2，事务A再次执行查询结果却是一样， 说明什么？说明事务B把id或者c给修改了， 而且已经提交了， 导致事务A“当前读”没有匹配到对应的条件； 事务A的查询语句说明了事务B执行更新后，提交事务B一定是在事务A第一条查询语句之后执行的； <br><br>所以执行顺序应该是：<br>1， 事务A select * from t;<br>2,   事务B update t set c = c + 4;  // 只要c或者id大于等于5就行;  当然这行也可以和1调换， 不影响<br>3,   事务B commit;<br>4,   事务A update t set c = 0 where id = c; // 当前读； 此时已经没有匹配的行<br>5， 事务A select * from t;<br><br>读完第三篇后就陷入了事务执行原理的泥潭中了， 也找了不少相关资料， 但总感觉还不是特别明白， 今天看完这篇终于茅塞顿开呀， 仿佛打通了任督二脉了。。。。<br></div> <span class="time">2018-12-15</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">嗯嗯，分析得很对。<br><br>茅塞顿开的感觉很好，恭喜🎉🎈</p> <p class="reply-time">2018-12-16</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e1/09/9483f537.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">☞</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>5</span></a></div></div> <div class="bd">老师您好：<br>    今天重新看了一下这章您的修改地方，有个地方不明白<br>    落在黄色区域未提交事务集合部分怎么还要分类，低水位+高水位不就是这个数组了吗，之前说，这个数组是记录事务启动瞬间，所有已经启动还未提交的事务ID，那不应该是未提交的事务吗，不就应该是不可读的吗<br>之前说的是启动时会获取一个最大row trx_id，所有大于这个id都不认，这个id肯定是已经提交了的事务的才对啊，这个id不才应该是数组的高水位吗，这里有点懵了</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你设计一个“比低水位大，但是在当前事务启动前，就已经提交了的例子😄</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f3/2d/711d73b2.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">薛畅</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>5</span></a></div></div> <div class="bd">评论区的好多留言都认为 up_limit_id 是已经提交事务 id 的最大值，但是老师并未指出有何不对，这让我很困惑。<br>老师在第二版的文章中通篇未提 up_limit_id，但是文章中有这么一段话：“InnoDB 为每个事务构造了一个数组，用来保存这个事务启动启动瞬间，当前正在“活跃”的所有事务 ID。“活跃”指的就是，启动了但还没提交。数组里面事务 ID 的最小值记为低水位，当前系统里面已经创建过的事务 ID 的最大值加 1 记为高水位”。那么这个 up_limit_id 指的是不是数组里面事务 ID 的最小值，假如是的话，那么 up_limit_id 并不是已经提交事务 id 的最大值，而是活跃事物的最小值。</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">在这版里面就是用“低水位”来作为活跃的最小ID的概念，<br><br>嗯其实是为了理解原理，用了不同的表述方式哈。<br><br>后面发现上一版的描述方法太公式化了，不利于人工分析</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">qpm</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>5</span></a></div></div> <div class="bd">这是典型的“丢失更新”问题。一个事务的更新操作被另外一个事务的更新操作覆盖。在RR状态下，普通select的时候是会获得旧版本数据的，但是update的时候就检索到最新的数据。<br>解决方法：在读取的过程中设置一个排他锁，在 begin 事务里， select 语句中增加 for update 后缀，这样可以保证别的事务在此事务完成commit前无法操作记录。参考《MySQL技术内幕 InnoDB存储引擎》</div> <span class="time">2018-12-01</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGMibYc0m7cDHMsNRBUur2NPVnlBZFXoNjWomibfjnHeAO3XRt27VaH3WNtdUX11d3uIT1ZHWCxLeg/132" class="avatar"> <div class="info"><div class="hd"><span class="username">york</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>5</span></a></div></div> <div class="bd">思考题为何我做出来成功修改为0了啊？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">那就是没复现😄</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="avatar"> <div class="info"><div class="hd"><span class="username">Sinyo</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>3</span></a></div></div> <div class="bd">原来在同一行数据，最新版本的 row trx_id 是可能会小于旧版本的 row trx_id的，这里才搞明白(惭愧脸)。。</div> <span class="time">2018-12-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">赞，这个想通的感觉是很爽的</p> <p class="reply-time">2018-12-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/6e/50/c85284da.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Sawyer</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>3</span></a></div></div> <div class="bd">简单的总结一下：<br>1. 一致性识图，保证了当前事务从启动到提交期间，读取到的数据是一致的（包括当前事务的修改）。<br>2. 当前读，保证了当前事务修改数据时，不会丢失其他事务已经提交的修改。<br>3. 两阶段锁协议，保证了当前事务修改数据时，不会丢失其他事务未提交的修改。<br>4. RR是通过事务启动时创建一致性识图来实现，RC是语句执行时创建一致性识图来实现。</div> <span class="time">2018-12-03</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">WL</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>2</span></a></div></div> <div class="bd">想请教一下老师, 在数据可见性规则那一部分中的第三种可能的b情况: "若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。"对于这部分内容我开始不是很理解, 后来反复思考了一下, 可见性规则这部分是不是在说明这种情况:  因为数据的row trx_id是依次递增的, 但是事务由于创建和提交的时间不可预期所以transactionId可能是跳跃的, 所以假如有事务A, 比A的transactionId大的数据的row trx_id对于事务A一定不可见, 但是比A的transactionId小的数据的row trx_id也可能在A的事务数组中, 所以要判断一次. 不知道这么理解对不对?</div> <span class="time">2018-12-08</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是的，最后这个“可能”说得很好，<br>可能在，也可能不在，就用“是否在数组中”来判断</p> <p class="reply-time">2018-12-09</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">信信</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>2</span></a></div></div> <div class="bd">老师您好，有处疑问，文中说：“对于图 2 中的数据来说，如果有一个事务，它的低水位是 18，那么当它访问这一行数据时，就会从 V4 通过 U3 计算出 V3。”看上去像是一定会取小于低水位的值。那假如我的事务id是27，活跃数组是18，19，26，这样的话事务id为25的数据我也认呀。恳请老师解惑。</div> <span class="time">2018-12-04</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Mr.Strive.Z.H.L</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">这个必须要单独回复一下老师：<br>我的所有留言老师都一一回复，问题全部都解释的很清楚。在学校其实mysql用的非常简单，真的要说一下这个课实在太好了，把原理讲得简单易懂，并且评论里的讨论加深了自己的认知。<br>所以真的很感谢老师~~感谢感谢</div> <span class="time">2018-12-12</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">也谢谢你，说明你的问题质量高哦。<br><br>其实我没有回复大家所有的评论，<br>不过问得认真详细的、又跟其他同学问题不重复的问题，我会尽量全部回复，<br><br>因为把问题问清楚本身是要花心思的，不能辜负呀<br><br><br></p> <p class="reply-time">2018-12-12</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/c5/5e/24cc5a72.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">阿狸爱JAVA</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">只是理解一下这感觉身体被掏空，如果为我自己去实现这样的功能，我只想静静，何况我看到的只是冰山一角。不得不说很佩服👍</div> <span class="time">2018-12-12</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Mr.Strive.Z.H.L</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">关于之前的疑惑：<br>之前问了个问题，老师的答复是：行锁一般不是sql语句指定的，在innodb自动加的。<br>那 sql语句中 ...... for update 这个语法，不就是上锁吗？。<br>这个锁和innodb加的锁是什么关系？？<br><br>我自己的猜测答案：<br>在隔离级别处于可重复读：innodb为了防止并发更新，针对更新的数据都会自动加上行锁。那么实际上两个事务同时执行update同一条语句的操作，是不会发生并发问题的。业务上写的sql语句加上了for update是为了保证 “当前读”，读到最新的数据。因为如果没有for update，应该是读不到当前数据的，而是处于 “快照读”。<br>所以总结一下：for update主要是为了读取到最新数据，即使没有for update，但是只要两个事务同时更新同一条数据，那么就必然会有阻塞等待的过程。<br>我这么理解对吗？</div> <span class="time">2018-12-12</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">哦，好吧，第一段你说的对，还有select ... for update, 我之前回复的时候误以为你只是说update语句哈<br><br>第二段也对。update 和select... for update都会加行的写锁，都不能并发的</p> <p class="reply-time">2018-12-12</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/2a/32/6354a589.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小卡向前冲</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">明白了，是我之前对高低水位的定义没有搞清楚：RR隔离级别下，事务A在执行Select时，要重算read-view,此时数组是[99, 100, 101]，系统最大事务id是102，故低水位是99，高水位是102+1=103。<br>这样就可以推出来了~~</div> <span class="time">2018-12-12</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这回理解到位了😄</p> <p class="reply-time">2018-12-12</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/2a/32/6354a589.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小卡向前冲</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师你好，我有一点不太明白：提交的例子中，事务A进行查询时，事务B未提交，事务C已提交；那么，此时事务A的read-view 数组是多少呢？按照文章中的说法，我认为应该还是[99, 100]，但是这样无法推出查询结果是2。<br>请问，我是在哪里理解有误么？另，看评论中有人提到了up_limit_id 这个值在文中似乎没有提及，但是如果引入这个变量的话，就可以解决我上面的问题了。</div> <span class="time">2018-12-11</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">[99,100,101], 高水位是103，还是可以推得出来的吧</p> <p class="reply-time">2018-12-11</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">杰之7</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">这讲的内容是前面事务和锁的综合，没有前面的知识结构，不可能对这讲的原理和过程有清晰的认识。通过这讲的学习，先写下这讲最经典的两句话，一，可重复读，查询只承认在事务启动前就就已经提交完成的数数据。二、对于读提交，查询只承认在语句启动前就已经提交完成的数据。第一句话解释的老师文章开始抛给我们的问题，也就是为什么是1的原因。第二句话解释在读提交状态下，为什么是2的原因。当然，老师还分析了更新逻辑，对于更新数据先读后写，读是读当前值，这就解释了为什么第二个事物是3的原因。在事物C‘这种情况西，只能等事物C‘释放后，才会继续读，这样将事务和锁的知识又联系的起来。写的感受，这篇文章是我目前为止能力之中感受到最好的一篇文章，还挺难，但我能搞定它。</div> <span class="time">2018-12-09</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍🏿，总结得不错</p> <p class="reply-time">2018-12-09</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/ba/48/c892a35b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">崔根禄</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师，<br>这两天反复读这篇文章，想到一个业务上的问题：减库存的场景<br>当前库存：num=200<br>假如多线程并发：<br>AB同时开启事务，A先请求到行锁，<br>A：<br>start transaction;<br>select num from t where num&gt;0;先查询当前库存值（num&gt;0）<br>update t set num=num-200; 库存减量<br><br>B：<br>start transaction;<br>select num from t where num&gt;0;先查询当前库存值（num&gt;0）<br>update t set num=num-200; 库存减量<br>----结果---<br>A：查询到num=200,做了库存减量成了0<br>B：事务启动后，查询到也是200，等 A 释放了行锁，B进行update，直接变成 -200<br>但是 B 查询时，时有库存的，因此才减库存，结果变成负的。<br>老师，对于这种场景，怎么避免减成负值？<br>给 select 加读锁或者写锁吗 ？这种select 加锁，对业务影响大吗？<br></div> <span class="time">2018-12-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这是个好问题，也是并发业务常见的问题。<br><br>一开始Select 加锁虽然可以，但是会比较严重地影响并发数。<br><br>比较简单的做法是update语句的where 部分加一个条件： where nun &gt;=200 .<br>然后在程序里判断这个update 语句的affected_rows, <br>如果等于1 那就是符合预期；<br>如果等于0，那表示库存不够减了，业务要处理一下去，比如提示“库存不足”</p> <p class="reply-time">2018-12-08</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">进阶的码农</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">文中黄色区域不就是代表当前事务启动时的活跃数组吗，因为黄色区域两个边界是低水位和高水位。既然这样怎么会有 row tx_id在黄色区域 但是又不在数组里的情况呢。是我理解的有问题吗 请指教</div> <span class="time">2018-12-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">黄色区域只是高水位和低水位之间，但是不是连续自然数集合哦</p> <p class="reply-time">2018-12-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/4a/45/04a13bf9.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">bing</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">当行记录的事务ID在活动范围之中时，判断是否在活动链表中，如果在就不可见，如果不在就是可见的。<br>　　for (i = 0; i &lt; n_ids; i++) {<br>　　　　trx_id_t view_trx_id<br>　　　　　　= read_view_get_nth_trx_id(view, n_ids - i - 1);<br>　　　　if (trx_id &lt;= view_trx_id) {<br>　　　　return(trx_id != view_trx_id);<br>　　　　}<br>　　}<br><br>新建事务(当前事务)与正在内存中commit 的事务不在活跃事务链表中。<br>新建事务(当前事务)与正在内存中commit 的事务不在活跃事务链表中。<br>新建事务(当前事务)与正在内存中commit 的事务不在活跃事务链表中。<br>求解释<br><br></div> <span class="time">2018-12-06</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/fa/61/691e2936.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">算不出流源</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">“InnoDB 里面每个事务有一个唯一的事务 ID，叫作 transaction id。它是在事务开始的时候向 InnoDB 的事务系统申请的，是按申请顺序严格递增的。”<br><br>老师您好，请问是begin/start transaction语句就申请到了trx_id，还是执行了第一个操作数据表的语句才有了trx_id呢？</div> <span class="time">2018-12-05</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">都是“事务启动”的时候申请，<br><br>所以是第一个操作表的语句。<br><br>也可以是执行start transaction with consistent snapshot这个语句的时候</p> <p class="reply-time">2018-12-05</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e1/09/9483f537.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">☞</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师回复“你设计一个“比低水位大，但是在当前事务启动前，就已经提交了的例子😄”<br>我意思说比低水位大的肯定是已经提交的事务啊，这样的话黄色区域肯定都是已经提交的事务啊，为什么还要区分已经提交和还没有提交的事务呢？应该都是不可读的才对吧<br>如果是RC的话，可以理解成每次读之前会再去黄色区域看看有没有提交，但是RR应该就不会再去读黄色区域了才对</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">比低水位大的不一定已经提交了哦<br><br>比如一个事务启动时当前活跃事务是[99,100,102], 而101已经提交了</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">WL</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">把该讲内容总结为几个问题, 大家复习的时候可以先尝试回答这些问题检查自己的掌握程度:<br><br>	1. <br>MySQL中的两个视图分别应该如何理解?<br>	2. <br>row trx_id 和 up_limit_id的定义是什么?<br>	3. <br>MVCC的实现机制是怎样的?<br>	4. <br>一致性读的概念是什么? 事务的可重复读是怎么毅力一致性读实现的?<br>	5. <br>当前读的概念是什么? 什么语句会采用当前读的机制?<br><br></div> <span class="time">2018-12-01</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">row Trx-id不是最大的就是最新版本，但是rc时候最大up-limit-id,102都成为历史版本，还读取，感觉好奇怪，如果c在执行一个事物读到的数据?怎么知道那个数据是最新版本，因为最新版本数据对应的row Trx-id并不是最新数据</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这个问题没看明白…</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/29/8e/f6241f28.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">欧阳波</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师好 我是一个java开发 看了前面文章 提到 清空索引空间问题 我们现在得表所有的删除都用truncate 不用delete是否合理</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">如果业务上是接受清空的，truncate没问题😄</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e0/b9/bca7ff9a.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">way</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">MySQL分为当前读和快照读。一般情况下，select是快照读，dml操作是当前读。RC和RR的区别就是创建read view 的时间不一样。rc在每个当前读的时候创建，rr在事物开始的时候创建。<br>之前遇到个问题，请老师帮忙解答下。<br>rr 隔离级别<br>数据demo <br>a b 都不是主键。b 上有普通索引<br>-------<br>a b<br>-------<br>1 2<br>10 5<br>-----<br>#session 1<br>select * from t where a = 10 ;<br>b=5<br>#session 2<br>select * from t where a = 10 ;<br>b=5<br>#session 1<br>update t set b = 100 where a = 10 ;<br>rows matched 1 effect 1 change 1<br>select * from t where a = 10 ;<br>#b = 100<br>#session 2 <br>update t set b = 100 where a = 10 ;<br>--阻塞，等session 1 commit 以后<br>rows matched 1 effect 0 change 0<br>此时<br>#session 2 <br>select * from t where a = 10 ;<br>结果是 b = 10 <br>在mysql 8.0 里面测试，session2 最后的值是100 。percona server 5.7.18一下是 10 ，所以这是低版本的bug 对吧？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是不是执行过程有误，整个过程里面并没有把b 赋值成10过，怎么会查出来10？</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/d5/ee/762ca3f9.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">🚶🏻_____路人丙</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师你好第一次提问不是dba，有个疑问，事务不是先拿到锁的先执行么，为啥图3，事务C先执行？</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">某、人</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">接上一篇更正:<br>rc不是没有gap.情况稍显复杂,基本上就是replace和insert有唯一索引的情况加next-key lock(还分X和S)<br>老师我有个问题:<br>假如A开启事务up_limit_id为100,B开启事务up_limit_id为110,C开启事务up_limit_id为120<br>A trx101   <br>select ;      B tid111<br>                   select;             C tid121<br>			                 update;<br>update                              commit;<br>commit;                             <br>                  select;<br>C最先把row tid改写为121,A随后把该行的row tid更改为101.那么B第二次去判断110&gt;101,那不是就能查到A更改的数据了？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍🏿<br><br>看一下置顶评论里面我的一个回复哈</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/06/dc/1a504e09.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">周巘</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师好 我想请问一下 如果文章中99号事务提交了 98号事务还没有提交 那么这三个事务的up_limit_id应该还是99 然后在事务A(id=100)的两次读过程中 98号事务提交并且修改了这一行 此时row trx_id=98 将会小于up_limit_id=99 那么事务A的两次读请求结果不就不一样了吗? 请老师解惑 谢谢<br><br></div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">看一下置顶评论答复哈</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/34/5c/6b4757a0.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">倪大人</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">对于读提交，查询只承认在语句启动前就已经提交完成的数据；<br>而当前读，总是读取已经提交完成的最新版本。<br><br>老师请问下读提交和当前读有什么区别吗，我理解这两个都是读到已提交的最新版本？如果是的话，那为什么读提交这种隔离级别不直接基于当前读做呢，每次去算一下up_limit_id不麻烦吗o.o</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不一样，读提交隔离级别下，首先是不加锁的。<br><br>还有，你考虑下，一个语句开始执行的之后，执行期间别的事务修改了数据的情况<br><br>PS： 这是个好问题</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/48/bd/6c7d4230.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Tony Du</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">在RR隔离级别下，对于文中的例子，“所以，在执行事务 B 的 Q1 语句的时候，一看自己的版本号是101，最新数据的版本号也是101，可以用，所以 Q1 得到的 k 的值是3”，<br>这里事务B的 up_limit_id 应该还是99，此时数据的最新版本是101，则这里通过up_limit_id判断数据可见性原则是不适用的（如果Q1能够看到k=3），那是否还有其他的数据可见性原则？（比如当自己修改过数据之后，看一下自己当前transaction的版本号？）<br>如果存在多个数据可见性原则，那这些原则的优先级是怎么样的（即先用哪条原则，后用哪条原则），请老师解惑。<br></div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">自己改的要看到，事务启动时还没提交的看不到<br><br>理解上可以认为就这两条</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/6c/02/cdeeea90.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">稳</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">思考题：<br>事务A：<br>       begin;<br>       select * from t;<br>       /*<br>        *这个时候执行了事务B<br>      */<br>       update t set c=0 where id=c;<br>       select * from t;<br>事务B：<br>     update set c = 0 where id = c;<br><br>有一个疑问，对于可重复读，查询应该是只承认事务中第一个查询语句前已经提交完成的数据吧。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">准确描述是“事务启动时”</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/48/b2/cca85581.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小文</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">老师您好，事务启动是begin就记录up_limit_id还是begin之后的第一条select语句开始记录up_limit_id?我测试中，客户端A 执行begin后但没执行select，客户端B开始事务修改提交后，客户端A再次select会读到这个修改值。而另一种begin后直接select,此后客户端B开始事务修改后，客户端Aselect就是第一次Select的值。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">Begin之后的第一个语句算启动事务<br><br></p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/0b/78/22410c47.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">魏春河</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">思考题：<br>   begin<br>   up_limit_id = 100;<br>   1. select (row trx_id = 100)<br>        这里另外一个事务里执行了 set c= 0 where id = c 并提交；trx_id = 102;<br>  2 . update 执行(当前读) ，所以找不到符合条件的数据。<br><br> 3. select <br>     up_limit_id 依然是 100；<br><br>所以结果就如思考题中截图所示。<br>   </div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小四</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>1</span></a></div></div> <div class="bd">显然地，语句 Q1 的查询结果 k=1。这个测试后发现是3？请老师确认下</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是1，手误抱歉。<br><br>👍🏿一边看一边验证哈</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Geek_515b9e</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师您好，start transaction with consistent snapshot 这个命令是启动马上开启事务，那么图一中事务b是在事务a开始之前就创建了呀。为什么还可以看到c修改的数据呢，忘老师解答。。</div> <span class="time">2019-01-16</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">图1 的事务B是在事务A之后才创建的呀，<br><br>然后我没看懂你这个问题的逻辑。。你重新理一下再发一个😆</p> <p class="reply-time">2019-01-17</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e7/99/8dbfe583.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">旧时光、</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，5.7.17  REPEATABLE-READ 执行图6中事务B的update时返回死锁了。什么情况？<br>mysql&gt; update t set k=k+1 where id=1;<br>ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction</div> <span class="time">2019-01-16</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这个不是死锁啊，这个是锁等待超时</p> <p class="reply-time">2019-01-16</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e5/c9/36fdec8e.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">liuq</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">怎么在别人问题下回复呢，或者引用别人的问题？<br>有个问题一直卡着：<br><br>老师您好：<br>今天重新看了一下这章您的修改地方，有个地方不明白<br>落在黄色区域未提交事务集合部分怎么还要分类，低水位+高水位不就是这个数组了吗，之前说，这个数组是记录事务启动瞬间，所有已经启动还未提交的事务ID，那不应该是未提交的事务吗，不就应该是不可读的吗<br>之前说的是启动时会获取一个最大row trx_id，所有大于这个id都不认，这个id肯定是已经提交了的事务的才对啊，这个id不才应该是数组的高水位吗，这里有点懵了<br>2018-12-03作者回复  你设计一个“比低水位大，但是在当前事务启动前，就已经提交了的例子😄<br>---------------------------------<br>无法理解，在当前事务启动前就已经提交了，不是已经不活跃了吗，怎么还在快照数组中<br></div> <span class="time">2019-01-14</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">在当前事务启动前就已经提交了，不在数组中，但是比低水位高。<br>你想下这种场景，按照时间顺序：<br>事务A启动 ，假设trx_id是1；<br>事务B启动，假设trx_id是2；<br>事务B提交；<br>事务C启动，这时候C的低水位是1，因为A还没提交。所对于C的事务数组里是没有2的，但是“2&gt;低水位（也就是1）”</p> <p class="reply-time">2019-01-14</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e9/4a/db2252f6.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">scarlett🦌</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">顿悟了，读一直是一致性读，更新是当前已提交的基础上更新。感谢作者的分享，支持</div> <span class="time">2019-01-12</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍</p> <p class="reply-time">2019-01-12</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e9/4a/db2252f6.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">scarlett🦌</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">例子中的事务C是在事务B后启动的，对B而言属于范围区间，按照文中的结论，在可重复读隔离级别下，B不应该可见C的执行结果，B为什么选出来是3<br></div> <span class="time">2019-01-12</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">因为B又修改了这个数据一次<br>等于最新的数据结果是B自己修改的，它就要可见</p> <p class="reply-time">2019-01-12</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/b0/37/d654fbac.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">几近虚年</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">昨天看了2遍始终不是很明白，今天早上来看，很多知识点就感觉明白了。<br>一致性视图、行锁、当前读，基本连通起来了，老师的课文讲的真好。<br>以前只会写sql语句，什么增删查改，自从决定好好学习下原理，看了老师的文章，很多东西都明白了。对以后写代码也有很多帮助，代码的顺序，sql语句的优化等。<br>多谢老师！</div> <span class="time">2019-01-10</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍一起学习</p> <p class="reply-time">2019-01-10</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/a1/e6/c0577a54.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">目人可分😁</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这些天才开始撸您的文章，看完这篇文章之后，一开始我是很懵的状态，各种碎片化的知识在大脑中一直萦绕，似乎看到了光明但是又很灰暗，之后我下班之后一直在想，在关联所有学知识，经历了挺痛苦的理解和推翻 在重新理解的过程，现在我感觉有种挣脱束缚的自由感，谢谢您老师！</div> <span class="time">2019-01-10</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">哈哈👍🏿这个状态很好</p> <p class="reply-time">2019-01-10</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/12/da/a3ea305f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">jiaobuchongจุ๊บ</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">1、start transaction with consistent snapshot; 执行完，就已经创建了 read view，read view 包括两部分 up_limit_id 和 事务活跃数组。事务小于  up_limit_id 的事务是可见的，活跃事务数组中已经提交的是可见的，本身事务做的 dml 是可见的。<br>2、如果是 begin 创建的事务，read view 会在第一次执行 select 的时候创建 read view。<br>3、更新是当前读。 </div> <span class="time">2019-01-09</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">对的 </p> <p class="reply-time">2019-01-10</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/a5/75/f23d2dd2.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">byronwx</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">感觉评论区很多人把 up_limit_id 的概念搞错了。<br>原文“当前系统里面已经创建过的事务 ID 的最大值加 1 记为高水位”</div> <span class="time">2019-01-08</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这篇文章上线以后重写过，之前用up_limit_id的概念，但是那个判断标准有点复杂，重写的版本去掉了这个概念，之前大家理解不准确只要是我的锅😄</p> <p class="reply-time">2019-01-08</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLv9HJIW4OACkjlwOQJ9cU7HzvaDFYkACWCib2lzOMef9ZiaGDTVFqjPicpVK5KDRbBRVGGHrMHQO1Rw/132" class="avatar"> <div class="info"><div class="hd"><span class="username">fdconan</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">请教下，文章说：当然，如果“上一个版本”也不可见，那就得继续往前找。这个不太好理解。</div> <span class="time">2019-01-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">啊？就是说得一直往一直往前直到最后找到自己可见的版本</p> <p class="reply-time">2019-01-08</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/6b/c6/2534e14a.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">spraith</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">“如果落在黄色部分，那就包括两种情况<br>a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。”<br>这里的b，怎么会不在“活跃”数组中的？黄色是在高低水位之间，这之间的事务id都记在活跃数组中，所以按理来说应该不可能出现b情况啊，想不明白，求解答</div> <span class="time">2019-01-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">其它同学的评论中有答复了😄</p> <p class="reply-time">2019-01-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">信信</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师您好，文章中提到：<br>如果把事务 A 的查询语句 select * from t where id=1 修改一下，加上 lock in share mode 或 for update，也都可以读到版本号是 101 的数据，返回的 k 的值是 3。我认为这里会因为事务B未提交而被阻塞。请老师指正。此外，还有个问题：什么情况下高水位会大于自己的事务id？文中举例的几个事务id也都是等于视图数组的高水位的。</div> <span class="time">2019-01-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">1. 你说的对，我文中意思是事务B提交后返回版本号是101的数据；<br>2. 事务创建后，在获取视图数组前，有可能出现别的事务启动</p> <p class="reply-time">2019-01-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/de/23/be735002.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">山人</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师你好！<br>针对图3，“数据版本可见性规则”的几种可能性解释的3(b)有疑惑：若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。<br>既然落在黄色部分，就是未提交的事务。怎么后面说是已经提交了的事务生成的呢？如果理解为：当前事务自己生成的，是不是更合理些。</div> <span class="time">2019-01-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不一定是自己的，可能是“比低水位后启动的、但是已经提交了的事务”</p> <p class="reply-time">2019-01-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/c6/51/b3d1144f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">劉阳河</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，C查询一行数据， A和B都对这行数据进行了提交，这种情况下也是根据transid和事物启动时的数组来看A和B对于C都是可见的，但是A的transid小于B，A也晚于B提交，那是怎么保证C看到的是 A提交的数据？</div> <span class="time">2019-01-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">A晚于B提，说明最新的版本是A生成的对吧<br><br>然后C去读数据的时候，就从最新版本开始读，先读到A生成这个，由于对C可见，就直接读走了</p> <p class="reply-time">2019-01-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/c6/51/b3d1144f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">劉阳河</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，我现在理解是  当A对一行进行操作时，开启事务，创建transid，然后B再对这一行操作时，必须要等到A提交释放锁后啊才可以继续操作，所以说明transid是严格递增的，查询一行数据时只查找transid最大的数据就可以了</div> <span class="time">2019-01-02</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不是，你想这个序列：<br>A启动，更新id=1, <br>     B 启动更新id=2，提交； <br>A更新id=2，再提交；<br></p> <p class="reply-time">2019-01-02</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/1b/17/64e18a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">雪候鸟</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">我想问问读未提交隔离级别是怎么实现的</div> <span class="time">2019-01-02</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">就是直接读最新版本，连有没有提交都不管</p> <p class="reply-time">2019-01-02</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/c6/51/b3d1144f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">劉阳河</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，有三个事务，事务A先启动tranid是100，事务B再启动tranid是101，都对id=1的行操作，B先操作然后提交，A再操作然后提交，此时C开启事务执行查询id=1的行，那它应该拿的是tranid为101的数据，这样不就读不到最新的了吗</div> <span class="time">2019-01-02</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不是啊，此时C拿到的是A操作后的结果哦。</p> <p class="reply-time">2019-01-02</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/a4/31/e48393bf.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Manjusaka</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">问题应该就是 MySQL RR 下的幻读吧<br>官府在我理解看来也是一种不可重读，不过作用的范围也不一样<br>目前看起来比较好的解决方案就是 CAS ，最暴力的就是串行化<br>复现的话，记得提交事务，不然在老师的 SQL 会被锁住</div> <span class="time">2019-01-02</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/01/c4/9a0c9535.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">窗外</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">在可重复读隔离级别下，事务在启动的时候就“拍了个快照”。注意，这个快照是基于整库的。<br><br>有个疑问啊，对于库中的 myisam 表是怎么处理的？<br><br>作者回复<br>MyISAM 不支持事务…<br><br>就是考虑到 myisam 不支持事务，所以才想知道，做快照时对 myisam 表是怎么处理的，因为您不是说基于整库的嘛，整库肯定包括各种引擎的表啊</div> <span class="time">2019-01-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">我说的整库是专指“整库中的所有Innodb”哈，嗯嗯忘记强调了<br><br>MyISAM 表没处理，所以每次要读数据的时候都去直接读最新的，没有可重复读这个特性</p> <p class="reply-time">2019-01-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/01/c4/9a0c9535.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">窗外</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">在可重复读隔离级别下，事务在启动的时候就“拍了个快照”。注意，这个快照是基于整库的。<br><br>有个疑问啊，对于库中的 myisam 表是怎么处理的？</div> <span class="time">2019-01-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">MyISAM 不支持事务… </p> <p class="reply-time">2019-01-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">myf</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">数据库是设置auto conmmit的，而且这种问题不是必然出现，是偶尔出现<br>--------------------------------<br>笔误，是相差几十毫秒，是业务日志显示已经插入成功，返回了影响行数1，然后启动的查询没查到，有点奇怪<br>--------------------------------<br> 作者回复<br>是不是在事务中没提交？</div> <span class="time">2018-12-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">额…这样描述比较难这么回答了😓</p> <p class="reply-time">2018-12-31</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/6b/c6/2534e14a.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">spraith</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">我想到一种更容易理解的方法来说明innodb的mvcc。如下：<br>我们可以在现实中找到同样的问题，然后对现实问题进行解决。<br>我想到的是这样的，假设有六个人（对应于六个事务，人员编号对应于事务id）一起修改及阅读一本书（可对应整个数据库），并且有如下规则：1.同一页书同一个时刻只能允许一个人修改（页对应于一行记录，这条规则对应于行锁）2.某个人翻开书的瞬间（对应于事务开始），在他把书放下之前，不管这期间有多少人在改这本书，他看到的内容是不变的（对应于可重复读）。<br>再假设六人改书的顺序：除了3号，其他人都是改了某些页的内容，并且按编号依次顺序修改，而3号则是第三个参与进来的人，他只看书，看书的时间一直持续到了第6号人把书改完。<br>上面这种假设是符合常理的，因为现实中确实可能出现这样的场景（当然现实中不一定是改书了）。好了，现实问题已经构建完成，接下来我们就思考一下如何帮3号更高效地实现规则2。<br>首先最容易想到的是3号拿到的是他参与瞬间的整本书的复印件，这样是不会被其他人修改打扰了，但是复印整本书，效率只能是“呵呵”了。<br>继续想改进的办法。3号想，我进来的时候，2号已经改完了，所以我直接看他的版本就行（即不用管id比自己小的事务），但是456号的改动是在我未看完期间，他们的改动量相对于整个书是很小的，我能否让他们把各自的改动都记下来，分别记为d4，d5，d6（d是delta，增量的意思），dn的内容只需要记录哪个人（事务）改了哪页内容（哪条记录），并且要记录某页书最后一次是被谁改动的。<br>这样，当3号读到当前的某页书记录着被6号改动了，那只需要把当前页的内容-d6-d5-d4 就可以得到3号刚进来时的同一页书的内容了，如果看到某页被2号改动，直接读，如果看到被4号改动，则回退一下d4即可。<br>这种方案明显比复印整个书的方案要节省空间和时间。<br>现在回到数据库的mvcc，来把一些还未对应进去的数据库术语对进去：d4这些增量，本质上和数据库的undo log是一样的；低水位则对应于4号，高水位在这个例子中，至少是比6号更大的事务id（高低水位的边界有点记不太清楚，可能会有1的差异，主要能理解意思就行）；undolog的清除时机也很明显了，就是要能保证可以还原到3号的那个版本，d4（不包含d4）以前的都删除。</div> <span class="time">2018-12-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/5b/94/091258c2.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">林千景</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">图4事务A读数据的时候，此时最大事务ID是102，read-view是[99，100，10]，所以低水位是99，高水位是103。当前数据版本是(1,3),事务ID是103，文中说【找到 (1,3) 的时候，判断出 row trx_id=102，比高水位大，处于红色区域，不可见】;可是102不是比103小么？</div> <span class="time">2018-12-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">在可重复读的时候，高水位这个指是事务创建的时候，保存起来的。<br><br>虽然后来变成103，但是sessionA 的事务数组和高水位都没有改变，所以判断的时候102是大于它的高水位的</p> <p class="reply-time">2018-12-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">myf</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">笔误，是相差几十毫秒，是业务日志显示已经插入成功，返回了影响行数1，然后启动的查询没查到，有点奇怪<br>-----------------------------------------------------------------------<br>请教一下，我在mysql实践中遇到个问题，就是同一个后台服务的方法A中执行了插入一条数据成功后，然后方法B中去查询发现没查到这条数据，其中方法B是一个异步方法（另一线程），看日志发现查询是在插入后几十微妙，这是不是出现幻读了，有什么办法解决吗？隔离级别是Repeatedable Read，数据库没有读写分离，查询条件也是唯一索引的。<br>2018-12-28<br> 作者回复<br>这个不是幻读呀，这个是写入了查不到<br><br>你看的“查询在插入之后几十微秒发起”，这个日志是客户端日志，还是数据库日志？<br>数据库除非特别定制，否则没有微秒单位，<br>如果是业务发送端的话，有可能查询是后发先到哦，毕竟才差几十微秒…<br></div> <span class="time">2018-12-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是不是在事务中没提交？</p> <p class="reply-time">2018-12-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/5b/94/091258c2.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">林千景</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">高水位是103，row trx_id=101为什么会比高水位大？</div> <span class="time">2018-12-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是指那一个图？ 具体指明图几哈</p> <p class="reply-time">2018-12-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">myf</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">请教一下，我在mysql实践中遇到个问题，就是同一个后台服务的方法A中执行了插入一条数据成功后，然后方法B中去查询发现没查到这条数据，其中方法B是一个异步方法（另一线程），看日志发现查询是在插入后几十微妙，这是不是出现幻读了，有什么办法解决吗？隔离级别是Repeatedable Read，数据库没有读写分离，查询条件也是唯一索引的。</div> <span class="time">2018-12-28</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这个不是幻读呀，这个是写入了查不到<br><br>你看的“查询在插入之后几十微秒发起”，这个日志是客户端日志，还是数据库日志？<br>数据库除非特别定制，否则没有微秒单位，<br>如果是业务发送端的话，有可能查询是后发先到哦，毕竟才差几十微秒…</p> <p class="reply-time">2018-12-28</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/d4/96/b257de7f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">灰机。</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，您好我有个问题，事务在创建快照的时候，数据版本是否可见是由数据版本小于等于当前事务id决定，这个地方有点不解，比如同时并发五个事务，事务id分别为98,99,100,101,102，假如在事务98创建活跃数组的时候101已经提交，那么事务98的活跃数组就为98,99,100,102，此时事务101对98是可见的，这和数据版本小于等于当前事务id可见有点矛盾，我觉得应该是按活跃数组来确定，第一种只是大致上的，对么，老师</div> <span class="time">2018-12-27</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">额，事务id递增的，怎会98创建的时候，101提交了😓</p> <p class="reply-time">2018-12-28</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/6f/06/82d8bdfb.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">D.L</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">您好，请问tcc下是怎么实现分支事务能够看到其他分支事务修改的内容的？gts可以吗？</div> <span class="time">2018-12-27</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/12/93/3470fc43.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Mr.钧👻</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，我有个疑问，数据版本可见性规则图中，落在黄色部分，为什么会有a b两种情况呢？既然数组包含的，都是启动未提交的事务，应该都不可见才对吧？</div> <span class="time">2018-12-27</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">也包含提交了的</p> <p class="reply-time">2018-12-27</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/2b/bb/5cf70df8.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">嘉嘉☕</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师还有一个问题<br>对于当前事物启动瞬时来说，高水位就是它自己的id+1吧？</div> <span class="time">2018-12-26</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">但是创建数组得时候，已经比“启动瞬间”稍晚一会儿了</p> <p class="reply-time">2018-12-27</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/2b/bb/5cf70df8.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">嘉嘉☕</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师, 请问一下,<br>------------------------<br>但是，当它要去更新数据的时候，就不能再在历史版本上更新了，否则事务 C 的更新就丢失了。<br>因此，事务 B 此时的 set k=k+1是在（1,2）的基础上进行的操作。<br>------------------------<br>这个地方我比较疑惑, <br>为什么不能让C的更新丢失呢 ?<br>C来得早, 而且已经提交了, 被后面的更新所覆盖不是很正常吗 ?<br>没太想明白这块, 希望老师能给解惑<br>谢谢</div> <span class="time">2018-12-26</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">就是说，这时候应该按照3+1=4来算才对，对吧<br><br><br>但是如果还当作2，算成2+1=3，前面等更新结果就等于没做了，这个丢失是不能接受的</p> <p class="reply-time">2018-12-26</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/EfYxc1HovSS5fMHKyhSiaG00H2CG5Z9XU6ibV9aBiagWFH4Co53icq2uCFZs3ksHEz9OHK6SxCUicwVdwyrhgRLiaR8A/132" class="avatar"> <div class="info"><div class="hd"><span class="username">Geek_fe79fa</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师好，事务里的一致性读，不受其他事务锁（update操作的行锁、select读锁、排他锁）的阻塞影响，其读取结果受事务隔离的影响。不知这样理解正确不？</div> <span class="time">2018-12-26</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/bd/da/abb7bfe3.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">进击的菜鸡</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这章读完瞬间觉的茅塞顿开，希望在老师的带领下对MySQL的理解能有一个质的提升(∩_∩)。但是又有一个疑问。就是如果说根据一致性视图读取可见数据，那么RR级别下为什么不能阻止幻读呢。例如RR级别下，session A先执行select范围查找开启一致性视图(使用begin开启事物)，此时session B在A之后开启事物恰好insert了一条符合A范围查找的数据并立刻commit，然后A又执行了同样的语句。如果按照一致性视图B插入的数据RTX_ID大于A的事物ID那么A就不会读取到B插入的数据。这样的话岂不就可以防止幻读了？那么为什么MVCC不能有效防止幻读？百度了一下，甚至有人说就是因为MVCC才引入了幻读。还请老师解惑一下。</div> <span class="time">2018-12-25</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你理解的对，快照读是不会有幻读的。<br>但是这时候如果select是用lock in share mode ，就会看到新插入的数据了。<br><br>第20篇专门讲幻读哈😄</p> <p class="reply-time">2018-12-26</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/9b/22/dd04892a.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">heat nan</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，你说的落在红色区域的是由将来启动的事务  是否不准确？是否应该是比当前事务id大的且没提交的</div> <span class="time">2018-12-24</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这两个比起来，还是“将来启动”更准确些😄</p> <p class="reply-time">2018-12-24</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/45/91/afda3094.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">是我的海</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这篇文章真的是全程高能，看了快一下午，从头开始仔细梳理了下，仿佛明白了很多东西。<br>有个问题想请教老师，就是MDL 锁跟 我在其他地方看到的意向锁是一回事么 ？ </div> <span class="time">2018-12-23</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/61/c7/b64ac05e.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">sky</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师2个问题<br>1:trx_id 始终自增，不会超长么，是用什么类型存储的，db大量开启事物跑了一年这个trx_id得多大<br>2: 如果落在黄色部分，那就包括两种情况<br>a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。<br><br>既然是落在黄色区域，不就都是当前事务开启时活跃的trx-id 么，为啥会不在数组内</div> <span class="time">2018-12-22</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/2f/22/ed2b9b35.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">a劳</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">好呀！有个问题没太明白.<br>哪个事务C'的，和事务B修改同一条数据，为啥事务C'都没提交，事务B也能修改？不是应该有行锁的x锁吗？</div> <span class="time">2018-12-19</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">没有提交呀，堵住了……<br>要等C’提交了才B才能继续的</p> <p class="reply-time">2018-12-20</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">三木禾</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">row trx_id 当前事务以前的事务提交的数据==》绿色部分 本事务是可见的<br>row trx_id 当前事务以后的事务提交的数据==》红色色部分 本事务是不可见的<br>row trx_id 在数组中，由其它事务提交的，那肯定是不可见的，因为隔离级别为3。<br>row trx_id 不在数组中，怎么会出现不在数组中的情况呢，是不是高水位？</div> <span class="time">2018-12-19</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">低于高水位，但是提交了</p> <p class="reply-time">2018-12-19</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">xinzhong</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">"所以，如果把事务 B 的查询语句 select * from t where id=1 修改一下...",这里是不是应该是事务A，B无论加不加锁都应该读到3，因为3是他更新的</div> <span class="time">2018-12-19</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">啊，你说的对，👍🏿细致<br><br>我勘误一下</p> <p class="reply-time">2018-12-21</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">xinzhong</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">对于置顶留言夏日雨自己的理解，既然98事务没有提交，那么事务A的列表不就变成了[98,99,100]了吗，按照作者文中讲的不会出现你说的那种情况吧？所以事务A的up_limit_id应该是98，而不是99了吧？不知道是不是这样</div> <span class="time">2018-12-19</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">三木禾</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">里面有个视图数组，不是当前活跃的事务ID组成的数组么</div> <span class="time">2018-12-19</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">就是当前活跃事务ID数组呀</p> <p class="reply-time">2018-12-21</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/de/e1/de266478.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">就是个渣渣</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">林老师，图五那里：更新数据都是先读后写的，而这个读，只能读当前的值，称为“当...“<br>这里更新同一行数据不是会有锁么？？？</div> <span class="time">2018-12-18</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">会呀，但是如果别的事务提交了，就就没有锁等待了</p> <p class="reply-time">2018-12-19</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/ec/cb/27033e11.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">王木鱼</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">文中的这个语句：<br>“是的，如果事务 B 在更新之前查询一次数据，这个查询返回的 ...”<br>是不是应该改为<br>“是的，如果事务 B 在更新之前查询一次数据(加锁查询)，这个查询返回的 ...”<br>才是正确的？<br>否则这个语句就是思考题了，刚好证明思考题情况不存在。</div> <span class="time">2018-12-18</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不是，这里要说的就是非加锁查</p> <p class="reply-time">2018-12-18</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/5c/1c/7a2e8bee.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">🐋</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">思考题：<br>事务A：<br>begin;<br>select * from t;<br>/*<br>*这个时候执行了事务B<br>*/<br>update t set c= c + 1 where id=c;<br>select * from t;<br><br>事务B：<br>update set c = c + 1 where id = c;<br><br>请问老师在事务A中update语句set部分c读取到事务B更新后的值，而where 部分id读取的c是事务A一致性视图中的值，由于两者不一致导致更新记录为零的对吗？<br></div> <span class="time">2018-12-17</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不是，<br>整个update语句走的当前读，因此where读的就是事务B修改后的值啦</p> <p class="reply-time">2018-12-17</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">William</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师启动了事务，此事并未执行任何语句，会生成trx_id么？<br><br>看了您对@算不出流源的会发，发现有<br>“都是“事务启动”的时候申请，<br><br>所以是第一个操作表的语句。<br><br>也可以是执行start transaction with consistent snapshot这个语句的时候”<br><br>我的理解是申明事务的时候不会生成。<br>然后假设有crud操作的时候，才会生成对么？</div> <span class="time">2018-12-17</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">William</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，针对 @崔根禄 的问题，如果不仅仅从数据库层面考虑，<br>是不是也可以加一个业务锁，比如用redis，设置一个 key ： lock_kucun 如有值，则说明正在由线程在操作此任务，<br>后续的去排队，等上一个执行完了，再接着执行。然后校验是否有剩余。<br></div> <span class="time">2018-12-17</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">我爱学习</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，您说：<br>对于可重复读，查询只承认在事务启动前就已经提交完成的数据；<br>那么为什么不能避免幻读呢<br><br>还有一种现象：<br>当前事务x中查询出a值为1，另外一个事务将a值加一，当前事务查询到a值仍然为一，但是如果在当前事务对a update加一，查询出来的a就变成3了</div> <span class="time">2018-12-14</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这个就是文中的session B 不是？<br><br></p> <p class="reply-time">2018-12-14</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/0FI2bUjegtznv7XPC9DB9RJaqiaMiamWkibibPOibuUC3DCvI7XMvBANr6sDjRNbc1jwPic9pIaFxrdaib88VqUJKXSTQ/132" class="avatar"> <div class="info"><div class="hd"><span class="username">Chenl07</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，我碰到一个问题：数据库show processlist存在大量opening tabale的情况，此时数据库接近瘫痪，这个跟阻塞有关么？</div> <span class="time">2018-12-11</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">阻塞一般就提示为阻塞了，也可能根本就是并发太大…</p> <p class="reply-time">2018-12-11</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Mr.Strive.Z.H.L</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">关于事务A，B与C‘的疑惑：<br>因为事务C是更新后马上提交，B的update属于 当前读 的情况。<br>而事务C‘是获取了行锁，所以B必须阻塞等待C'提交后，再进行 当前读。<br>我的疑惑在于，行锁一般都是sql语句指定的，而不是innodb自动加的，如果在事务C'update语句中，我没有获取行锁，那么事务B在update的时候获取到的值肯定不是2，而是1，最后结果也是2。这种情况就是因为没有加行锁，而发生了并发问题。<br>老师您看我这么理解是正确吗？？</div> <span class="time">2018-12-11</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">描述反了哦：行锁一般不是SQL语句指定的，在innodb自动加的😄</p> <p class="reply-time">2018-12-11</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/fd/66/8db1f464.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">雯子Arωeฅ</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，有个问题，为什么我把autocommit设置为0。 然后按照start transaction 启动事物，但是为啥不能启动多个事物</div> <span class="time">2018-12-10</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e3/2e/77ad18f4.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">滔滔</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师您好，像update t set k=1 where id=1这条更新语句是不是不需要先获得当前读的值，因此不需要先获得读锁而是直接获得排它锁然后更新值？</div> <span class="time">2018-12-10</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/04/fb/40f298bb.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小罗希冀</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">刚刚重看了一下这一篇文章，发现里面内容的描述改了很多，但是我还是认为之前的讲得比较清楚，现在新版的都把up_limit_id的介绍删除了</div> <span class="time">2018-12-09</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">额，是这样的，原来的太公式化了，平时我们在判断的时候，用起来麻烦</p> <p class="reply-time">2018-12-09</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/13/56/6a062937.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">gentleman♥️</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这个 update语句和row rxid生成的时候 说明数据已经写入数据页了吧？那个unlog就是方便来回滚的对吗？</div> <span class="time">2018-12-09</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">对</p> <p class="reply-time">2018-12-09</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">WL</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师真的很负责, 这周的内容比上周看讲得更细致了</div> <span class="time">2018-12-08</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/30/29/7d34099d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">ithunter</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，我提的问题：A、B相互喜欢的问题，我觉得是不是另外建一个用户喜欢操作表user_like_op，字段为 包含user_id，并为唯一索引。在A喜欢B时，加 X锁，select * from user_like_op where user_id = A for update，select * from user_like_op where user_id = B for update，把流程做到事务里。不知道您的解法是什么？</div> <span class="time">2018-12-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">为了让互相喜欢都操作同一行，你可以多一个字段，表示关系。比如等于1 是A喜欢B， 等于2 B喜欢2 ，等于三互相喜欢。<br>展开比较复杂，我放到答疑篇了</p> <p class="reply-time">2018-12-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/8b/ee/49ba9142.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">王虹凯</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">不能层级的回复留言，好尴尬，有些针对留言的讨论不能进行。<br>针对前面有个建立好友关系的，我觉得就查询是否有记录和插入表可以从其他业务中剥离（其他不必需要的），让整个事务尽可能小，而且这个查询判断可以走RC,尽量减少RR对乐观锁带来的不命中。另外，这种场景，我觉得可以异步去做，配合一个内存级别的bitmap 操作判断是否被喜欢以及好友关系bitmap,减少通过db判断。<br><br>针对问题-创建数组和最大上限的过程中，新事务ID：假如没有锁，那新创建的事务，也肯定会比最大的事务ID大，就算不在数组，在边界判断就不满足条件了。<br><br>欢迎讨论！<br></div> <span class="time">2018-12-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">对于可见性和视图数组这个理解很好</p> <p class="reply-time">2018-12-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/c6/e4/ec572f55.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">沙亮亮</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">买了很多专栏，丁奇老师绝对是为读者考虑最为细致的，不管是从回复大家的提问，还是从学习者角度考虑优化文章内容，最后到思考题的讲解，都是最细致的</div> <span class="time">2018-12-07</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">谢谢你，我倍受鼓舞呀😄</p> <p class="reply-time">2018-12-07</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/05/d4/e06bf86d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">长杰</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">现在事务 A 要来读数据了，它的视图数组是 [99,100]。当然了，读数据都是从当前版本读起的。所以，事务 A 查询语句的读数据流程是这样的：<br><br>找到 (1,3) 的时候，判断出 row trx_id=101，比高水位大，处于红色区域，不可见。<br>有个疑问，<br>为何会比高水位大？事物A当前事物数组99和100,高水位是当前系统中最大的事物id加1,高水位至少是101,应该是大于等于高水位就是处于红色区域吧？</div> <span class="time">2018-12-06</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是，其实是大于等于都算</p> <p class="reply-time">2018-12-06</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="avatar"> <div class="info"><div class="hd"><span class="username">Sinyo</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">第二个有效更新是事务 B，把数据从 (1,2) 改成了 (1,3)。这时候，这个数据的最新版本（即 row trx_id）是 101，而 102 又成为了历史版本。<br><br>老师，请问这里可不可以理解成事务B用102替代了原来的101，最新的还是102呢？<br></div> <span class="time">2018-12-06</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不能，最新的就是101，图中画的那样</p> <p class="reply-time">2018-12-06</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/4a/45/04a13bf9.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">bing</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">// 判断数据对应的聚簇索引中的事务id在这个readview中是否可见<br>bool changes_visible<br>(<br>        <br>trx_id_t<br>        id<br>,<br> <br>// 记录的id<br>    <br>const<br> <br>table_name_t<br>&amp;<br> name<br>)<br> <br>const<br>MY_ATTRIBUTE<br>((<br>warn_unused_result<br>))<br>{<br>    ut_ad<br>(<br>id <br>&gt;<br> <br>0<br>);<br>    <br>// 如果当前记录id &lt; 事务链表的最小值或者等于创建该readview的id就是它自己,那么是可见的<br>    <br>if<br> <br>(<br>id <br>&lt;<br> m_up_limit_id <br>||<br> id <br>==<br> m_creator_trx_id<br>)<br> <br>{<br>        <br>return<br>(<br>true<br>);<br>    <br>}<br>    check_trx_id_sanity<br>(<br>id<br>,<br> name<br>);<br>    <br>// 如果该记录的事务id大于事务链表中的最大值,那么不可见<br>    <br>if<br> <br>(<br>id <br>&gt;=<br> m_low_limit_id<br>)<br> <br>{<br>        <br>return<br>(<br>false<br>);<br>        <br>// 如果事务链表是空的,那也是可见的<br>    <br>}<br> <br>else<br> <br>if<br> <br>(<br>m_ids<br>.<br>empty<br>())<br> <br>{<br>        <br>return<br>(<br>true<br>);<br>    <br>}<br>    <br>const<br> <br>ids_t<br>::<br>value_type<br>*<br>    p <br>=<br> m_ids<br>.<br>data<br>();<br>    <br>//判断是否在ReadView中，如果在说明在创建ReadView时 此条记录还处于活跃状态则不应该查询到，否则说明创建ReadView是此条记录已经是不活跃状态则可以查询到<br>    <br>return<br>(!<br>std<br>::<br>binary_search<br>(<br>p<br>,<br> p <br>+<br> m_ids<br>.<br>size<br>(),<br> id<br>));<br>}<br><br>读源码证明</div> <span class="time">2018-12-06</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/4a/45/04a13bf9.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">bing</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">当检索到的数据的事务ID表示的是当前事务自己修改的数据(数据行的DBTRXID = mcreatortrx_id) 时，数据可见。<br><br>所有上面讲的有点问题</div> <span class="time">2018-12-06</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/1c/39/aafcb4e2.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Lei</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">置顶留言中”现在正在执行的所有事物ID列表” 和文章中的<br>”用来保存这个事务启动瞬间，当前正在“活跃”的所有事务 ID。“活跃”指的就是，启动了但还没提交”<br>不是一个意思吗？  正在执行，不就是以启动未提交吗？</div> <span class="time">2018-12-06</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">歪歪鱼</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">因此，一个事务只需要在启动的时候声明说，“以我启动的时刻为准，如果一个数据版本是在我启动之前生成的，就认；如果是我启动以后才生成的，我就不认，我必须要找到它的上一个版本”。<br><br>老师，这里的这句话 “如果一个数据版本是在我启动之前生成的，就认” 有个前提条件得是提交了的事务吧？ </div> <span class="time">2018-12-06</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是的，提交的</p> <p class="reply-time">2018-12-06</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">李</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">如果落在黄色部分，那就包括两种情况<br>a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见<br><br><br><br>我的问题是，落在黄色部分的还是都是事务启动时活跃的其他事务，那么应该都会落在数组里面，为什么还有不在数组的情况呢？</div> <span class="time">2018-12-06</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">已经提交了的<br></p> <p class="reply-time">2018-12-06</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/1d/7f/aabc1b66.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">hetiu</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，请教个问题，RR事务read view开始时间应该是在第一条CRUD语句，而不是BEGIN或START吧？也就是说，A事务SELECT时，所有已经commit的结果都是可以看到的。</div> <span class="time">2018-12-06</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">说的哪个图…</p> <p class="reply-time">2018-12-06</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/05/d4/e06bf86d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">长杰</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">在读提交隔离级别下，事物数组是如何维护的？活跃的事物处于黄色区域，如果某个黄色区域的事物提交了，数据就是可见的，事物是否从数组中移出？</div> <span class="time">2018-12-05</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是的，事务提交了，就不属于活跃，再创建视图数组，数组里就没它了</p> <p class="reply-time">2018-12-05</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f7/69/d8dba3de.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">DanielAnton</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">文中这里“事务 B 是当前读，必须要读最新版本，而且必须加锁，因此，就被锁住了，必须等到事务 C' 释放这个锁，才能继续它的当前读。”我的理解是，行锁不是唯一的吗，事务 B 此时应该是被阻塞了吧，只有等到 C’释放锁，它才能竞争获取当前锁吧。请老师指教。</div> <span class="time">2018-12-05</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">嗯，这段说的是过程，你说的是结果，咱俩没矛盾哈</p> <p class="reply-time">2018-12-05</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f7/69/d8dba3de.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">DanielAnton</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">问个问题，事务 A 的视图数组是 [99,100]，那么低水位是 99 ，高水位是 101？</div> <span class="time">2018-12-05</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是的</p> <p class="reply-time">2018-12-05</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/05/d4/e06bf86d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">长杰</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师好，您在文章中说begin不是事物的起点，第一个执行的innodb表操作的时候，事物才开始，那么申请事物id也是在第一个操作inodb表的时候申请的吗？</div> <span class="time">2018-12-05</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是，事务是在事务启动时候生成的</p> <p class="reply-time">2018-12-05</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/62/81/ad80f427.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Lane</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">重写以后果然就看懂了...之前真的没看懂，有点晦涩</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">变量要少，“讲清楚”这个能力，我也在学习中😄</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoH6lQA2ib1sV9hdJF7gnfFegC8egDPssYFDpJYUU6ZpAtTMZLdU3ApLYJZkxnKBrXibGUYxUabUnkg/132" class="avatar"> <div class="info"><div class="hd"><span class="username">sayhelen</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">留个笔记，update inster等语句执行时也是一个事务，会执行 commit</div> <span class="time">2018-12-04</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIrunVjKyFdya4mu8XXbqWepfiakljMV8gvevUFbh7bempdWdrwia5M2fdQh51K50PxlOKJVibGH7lTg/132" class="avatar"> <div class="info"><div class="hd"><span class="username">城市之光</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，3(b)“若 row trx_id 不在数组中”，对于事务启动当前瞬间正活跃的事务组成的数组，row trx_id 能落在未提交事务中，而又不这个数级中，什么情形下会出现这样的记录呢？</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不在这个数组中，表示提交了。<br>因为视图数组只记录那些“当前活跃事务ID”</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/34/1f/ef171ece.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">阿洛飛</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">标准答案的话个人觉得有些超过了已有的知识点的范围，CAS啊，乐观锁和悲观锁等等这些概念在没有提示的情况下实在想不出来，或许老师给些提示会更好<br><br>不知道从已有知识的角度去理解的对还是不对：<br>在RR事务隔离情况下，SessionA和SessionB的事务是隔离的，也就是说SessionA的视图列表中并看不到SessionB的更新，当SessionB更新了之后SessionA要更新id=c的row，因为更新语句是需要读当前值的，所以这里SessionA的更新语句看到的当前值中id和c都是不想等的，所以更新无效<br><br>又由于是RR事务的隔离，所以SessionA更新后Select出来的内容依然是SessinA视图中的可见的内容<br><br>不知道这么理解是否正确，还请老师指正</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">最后一段，需要指出“由于更新没有成功”，这几行数据的row trx_id 没变，所以再查还是查不出来</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/59/80/dc4a799f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">supertizzy</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">@约书亚 的评论。个人觉得在mysql innodb引擎中，增加version字段实现乐观锁的方式在实际应用场景中有点多此一举的味道。在对某一行进行cas更改的时候，针对该行记录innodb会加行锁（排他锁），update ...set ... where id = xxx and version = xxx，其他的线程依旧是阻塞的，并没有起到一个“无锁”的效果。那么我是不是可以理解为这种设计是针对没有行锁的情况下？</div> <span class="time">2018-12-04</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Geek_a9a978</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">事务的 id 是在事务"开始"还是事务"启动"时分配的呢？<br>按道理应该是事务"开始"的时候，但如果这样，文中黄色"未提交的事务集合"是否还应当包括"已开始"但"未启动"的事务？如果包括的话，而数组又是所有"已启动但未提交"的事务，第三条中是否不在数组中的还应当包括这种"已开始"但"未启动"的事务？那这种也应当是不可见的？</div> <span class="time">2018-12-04</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e1/09/9483f537.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">☞</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师能麻烦举一个即在黄色区域，又可读的例子吗，我还是认为黄色区域的肯定是我事务启动时，其他事务还未提交的，这部分数据我感觉在RR下怎样都是不可读的才对</div> <span class="time">2018-12-04</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/45/ae/a213a2a3.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">tinsang</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">事务在启动时,找到已提交的最大事务ID记为up_limit_id，按照文中所提的，B的是101，C是102，B最后提交更新，那最大的事务ID不就是102吗？可是最新更新的是101呢？</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">换用低水位来理解哈</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e1/09/9483f537.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">☞</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">b. 若 row trx_id 不在数组中，表示这个版本已经提交事务产生的，是可读的<br>老师我还是不太懂这个啊，落在黄色区域，我可以理解为是还没提交的事务ID啊，您这边之前说<br>innodb为每个事务构造了一个数组，用来保存这个事务启动瞬间，所有已经启动但是还未提交的事物ID <br>那怎么可能又落在黄色区域，row trx_id又不在数组中呢<br></div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">黄色区域是“高水位和低水位之间的事务ID”<br><br>这个数组不保证是“连续自然数”的</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">有铭</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">新改过的文章里，还是存在问题<br>如果transaction id是严格递增并唯一，按文章的解释，mysql如何知道哪个是最新版本的呢？我开始以为mysql的机制是取最大transaction id来作为最新版本，但是文章上说transaction id 101可以取代transaction id 102变成最新版本，如果说，小transaction id能作为最新版本，MySQL如何识别哪个transaction id是数据的最新版本？</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这个可以理解为一个链表，最新版本是链表的入口哦</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/fa/61/691e2936.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">算不出流源</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">疑问一：图3是否有误？当前事务的txid必定等于高水位吧？因为“在实现上， InnoDB 为每个事务构造了一个数组，用来保存这个事务启动瞬间，当前正在“活跃”的所有事务 ID。”说明在事务启动瞬间它的txid必定是系统里最高的水位。<br><br>疑问二：事务启动的时候为什么InnoDB要为事务构造一个“数组”，不是保存高低水位就可以了吗？</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">1. 有可能高水位会略大一点<br><br>2. 高低之间要有一些已经提交过的</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">菜鸟萌新</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，请问一个问题，低水位和up_limit_id不是相等的吧，高水位我理解是当前事物</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">高水位可能比当前事务大，因为创建事务后，到创建事务视图之间的执行代码期间，可能有新事务创建出来。<br><br>忽略up_limit_id 吧😄</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/21/57/ee02ef41.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">大龄小学生</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师是不是没提交的事务查询不到。</div> <span class="time">2018-12-04</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">除非你设置了隔离级别为“读未提交”</p> <p class="reply-time">2018-12-04</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">undifined</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师有一个问题，文章开始说 change buffer 不适用于写完之后立刻读取的场景，我的理解是 记录 change buffer 之后，如果要读就得先purge，将数据保存在硬盘上，然后再读取到内存中；但是文章末尾说 需要把 Page2 从磁盘读入内存中，然后应用 change buffer 里面的操作日志，生成一个正确的版本并返回结果；那么这个过程是在内存中做的，这个过程相比数据没有在内存中的普通查询多了一次 purge 的过程而已，所以这种查询消耗最多是"随机访问的 IO 的次数不会减少，反而增加了 change buffer 的维护代价"是吗？想和老师确认一下 purge 的过程需要先把数据读到内存然后更新之后放回到硬盘还是直接更新硬盘的数据？purge 发生在哪儿</div> <span class="time">2018-12-03</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/09/c7/861b4a70.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">泰格杨</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">文稿是不是有缺失？落在黄色部分的2种情况是啥？</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">额，还在呀。<br><br>a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/ef/59/3e454a59.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">dpqb</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">请问下老师，您说的那个正在执行的事务的id列表怎么理解呢?和活跃的事务ID数组有什么区别呢?因为我理解的活跃的事务不就是正在执行的事务吗?还是等待的事务不算是正在执行?</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">这俩是同一个概念的</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/94/59/ac2aa72b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Smile</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，您好，有两个问题还麻烦抽空解答一下：<br>问题1:<br>上个版本中为：事务启动的时候，找到所有已经提交的事务 ID 的最大值，记为 up_limit_id。<br>    --  这个up_limit_id 是否可以理解为 是 最接近低水位的成功提交的 trx_id  （考虑还有回滚的，所以不一定是 减1的值）<br><br>=== <br><br>问题2:<br>如果落在黄色部分，那就包括两种情况 <br>a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见<br>b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见<br>  <br>-------------------<br><br>针对(a)， RR和RC都能理解;<br>针对(b)， RR 应该也是认为不可见吧，因为已经 row trx_id &gt; up_limit_id了， 而RC能可见是不是因为 在事物启动的一瞬间虽然 row trx_id 还未提交，但是当执行到某个语句时，对应的row trx_id已经提交了，所以能可见。<br> <br>因此，图3中黄色部分的未提交数据，是否理解为事物启动时的视图，在RC下，随着事物的执行，这些事物有可能会变成提交状态，对应(b)的可见性<br><br>望老师解答。感谢！<br><br><br><br><br></div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">1. 摒弃那个吧😄 我都觉得绕了<br>2. 你的理解是对的，但(a)和(b)的定义不同改。因为我们说的是跟“视图数组”的对比，而RR的视图数组是在事务启动的时候创建的，之后不会改了</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/9f/1d/ec173090.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">melon</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师有一点不太明白，当前事务自己生成的为什么会落在绿色部分呢？当前事务的ID应该是大于或等于低水位的，为什么不是落在黄色部分呢？</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">单独绿色的字和绿色的线标出来了😄</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/77/fd/c6619535.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">XD</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">看明白了，辛苦老师！</div> <span class="time">2018-12-03</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/fe/c1/6c99fff4.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Jason_鹏</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">“因为之后的更新，生成的版本一定属于上面的 2 或者 3(b) 的情况，而对它来说，这些新的数据版本是不存在的，所以这个事务的快照，就是“静态”的了”这块是不是应该改成“生成的版本一定属于上面的2或者3（a）”</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">对… 谢谢，我更新下… 我这手残😓 </p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/e7/7b/71da8283.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">似水流年</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">原文”如果落在黄色部分，那就包括两种情况<br>a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。”中，b段落，为什么row trx_id不在数组中，不是未来提交事务，而不是已提交事务？这个row trx_id如果是已提交事务，怎么又在黄色区域，不在绿色已提交区域？</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">在黄色区域是因为，这些事务是在“低水位事务之后”开启的，但是又在“当前事务启动前”提交的</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/80/da/9c0c458c.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">安静</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这篇讲清楚了所有事物隔离级别的原理。</div> <span class="time">2018-12-03</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f6/c8/d89de7c4.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">潘健</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师重新改写了一遍啊，辛苦，精益求精啊。    1.up-limit-id概念没了，用低水位，高水位来代替了。<br>2.增补了一个场景，当前正在执行的事务中存在的row trx-ID也不可见。<br>3.还增加了事务c'场景，加了个锁等待。<br>感觉第二版比第一版知识量还多啊，大概是先入为主的概念，我怎么还是觉得第一版的uo-limit-id更好理解呢！</div> <span class="time">2018-12-03</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/59/8c/1958aa8f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">void</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，有没语句能看到up-limit-id。和read-view</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">没有😄</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/59/8c/1958aa8f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">void</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">从测试中看 innodb的事务id 应该是第一条sql后才分配的。而不是begin 时候分配的。</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">试一下 start transaction with consistent snapshot 验证文章中的结论哈，这样印象更深刻</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/bc/0d/00424e81.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">到道可道</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这是由于采用begin显示声明了一个事务，在本次事务没结束前，在本事务内做的查询操作，都是对事务开始前的版本的查询，可以加for update或共享锁的当前读来获取最新的值。</div> <span class="time">2018-12-03</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">对的，可重复读是这样</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/77/fd/c6619535.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">XD</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，在整理的时候又发现一个问题，请指导一下。<br>如果在A启动之前有另外一个事务D没有提交， 它的trx_id为98, 在Q1之后，它进行了提交，操作也是k=k+1，那这一行的最新的记录应该是{v:4, trx_id:98}。这么一来，当进行Q2操作的时候，读取到的row trx_id为98, 小于事务A的trx_id100。那这个时候是不是就要的起了呢？</div> <span class="time">2018-12-02</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你现在看一下09篇的“课后问题时间”哈</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/07/8c/51401220.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小美</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">原文：【好，现在事务 A 要来读数据了，它的 up_limit_id 是 99。当然了，读数据都是从当前版本读起的。所以，Q2 的读数据流程是这样的：<br>  ● 找到 (1,3) 的时候，判断出 row trx_id=101 大于 up_limit_id，要不起；<br>  ● 接着，找到上一个历史版本，一看 row trx_id=102，还是要不起；<br>  ● 再往前找，终于找到了（1,1)，它的 row trx_id=90，是可以承认的数据。】<br>问题：林老师，假设事务C执行完后，来了一个事务D：查询select k from t where id = 1;查询执行两次，一次在B事务提交前，一次再B事务提交后，此时D得到的up_limit_id=102，第一次查询时，得到的k=2，第二次查询时，事务B已经提交了，那up_limit_id=102,row trx_id=101,所以读到了B提交以后的结果，即第二次k=3，同一个事务两次读取结果不一致。我这个逻辑哪里有问题呢？</div> <span class="time">2018-12-02</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">其实规则里面还有一个活跃事务判断。<br><br>本来要留着下一篇说的…<br><br>后面发现这篇的描述规则不好人工判断，<br>我把08篇重写了，你再看下😄</p> <p class="reply-time">2018-12-02</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="avatar"> <div class="info"><div class="hd"><span class="username">Sinyo</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">第二个有效更新是事务 B，把数据从 (1,2) 改成了 (1,3)。这时候，这个数据的最新版本（即 row trx_id）是 101，而 102 又成为了历史版本。<br><br>老师，请问这里102不是最大的row trx_id吗？如果最大即最新，那么前面事务A的Q2读到的还是102吗？</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">一致性读下A一直读的是90这个版本的</p> <p class="reply-time">2018-12-02</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/44/2f/42a8d353.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">王宝龙</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">刚开始没注意作者说要复现，以为这是一个固定的知识点，于是根据作者正片篇文章的知识点来做步骤分析，但思来想去，依然无解。于是开始查看评论的答案，看到了置顶评论，然后依据他的思路进行了复现，果然效果浮现了，同时，思路也明朗了。<br><br>**复现思路**：在事务期间，开启另外一个客户端，执行“update set c=c+1 where id=c”，此时所有的值修改了，就会出现作者问题中的效果。<br><br>那么我就来班门弄斧，详细分析一下问题的解题思路。<br><br>1. 开启事务，创建一致性视图，假定分配的 transaction id 为 101，up_limit_id 为 100。<br>2. 在第一次 select 时，数据未修改，则会看到1、2、3、4。<br>3. 在执行更新前，先去开启另一个客户端，执行 SQL 对每一行的 c 累加 1（假定该更新的事务的 transaction id 为 102）。<br>4. 再在当前事务中，执行更新。更新操作是遵循“当前读”规则，此时实际的数据已更新，并且每一行（row）的 trx_id 为 102，那么 id=c 的条件判断，则无法匹配到任何行，以至于最终得到的结果是影响行数为 0。<br>4. 由于是事务隔离级别是 RR（Repeatable Read）可重复读规则，而 select 遵循的是“一致性读”规则。所以，在执行 select 查询时up_limit_id 为 100，而每一行版本已经成为了 102，所以会根据 undo log 计算版本回退为 100 时的数据，最终你看到的数据依然是 1、2、3、4。</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">👍🏿<br><br>从评论区获得灵感很棒</p> <p class="reply-time">2018-12-02</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/a0/da/4f50f1b2.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Knight²º¹⁸</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">本来看完第一遍认为自己理解了，结果看完评论区的留言，懵逼了。果断再看了一遍，敲了几行sql，再到纸上上画了几篇，这会儿总算理解了评论区其他童鞋问的问题了。</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">一波三折呀😄</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoVHWQP5bIygys4Ou6ibyED9b8PUt5CqYZxhMKWMLlVWl3xGGJO32exHuZs16ROCssmM77KicXXT6gw/132" class="avatar"> <div class="info"><div class="hd"><span class="username">鲁旭光</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">看图1，根据MDL特性，事务A开启了读锁，事务B开启了读锁，事务A和事务B都是读锁，不互斥，但是到事务C开启了写锁，读写互斥，事务C应该进入锁等待，事务C的更新操作，应该等事务A和事务B提交后才能执行吧。为什么事务C的更新操作先执行了呢？<br>请老师解惑下，多谢！</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">对数据的增删改查都是MDL读锁，<br><br>06篇再细看下？</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/4e/3a/2aa0f5cf.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">linqw</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">学习总结：<br>1、不可重复读，相对于update和remove，幻读是相对于insert<br>2、mvcc只能在rc及rr级别下才能使用，mvcc在数据行增加隐藏列（undo log指针，事务版本号（数据行的当前事务版本和当前行的删除版本）），在事务进行删除时，更新删除版本号，update时将其数据写入undo log中并且更新当前事务版本，更新undo log指针<br>3、rr级别下，在开启事务时将其当前数据行的最新版本号更新到up_limit_id变量中，up_limit_id事务已经结束的版本号，比如88事务已经停止，89事务对其行进行更新过，但是89事务还未提交，为此需将其up_limit_id保存为88，防止89对数据行进行更新，导致不可重复读，up_limit_id变量只能在自身事务对其数据行进行更新时，才将其改变为自身的事务版本号，select是快照读，除了for update（需要获取x锁），读取的数据行只能是行的系统版本号小于up_limit_id或等于事务的系统版本号），这样可以确保事务读取的行，要么是在事务开始之前已经存在，要么是事务自身插入或修改的数据，行的删除版本要么未定义，要么大于当前事务版本号，这可以确保事务读取到的行，在事务开始之前未被删除，由于当前行存放的是最新的版本号，为此需根据其undo log获取数据行，当前读是需要获取x锁，为此读取到的数据是最新的数据，当一个事务要对其一行进行更新时，需获取x锁，读取到的数据是最新的数据，rr级别存在幻读在select级别mvcc不会出现幻读，当前读，根据next-key锁，行锁和gap锁，在一定上下范围解决了幻读<br>3、rc级别由于每次执行sql时，都会重新计算up_limit_id，读取到的数据都是最新的数据，存在不可重复读<br>4、undo log中的数据什么时候？当没有事务再需要它的时候，就可以删掉，即事务中的up_limit_id都大于此数据中的版本号<br>5、思考题，和java中的cas，判断内存中的数据是否是预期的数据，如果是就更新，如果不是证明数据已经过期，事务基于数据行版本，更新数据时，如果当前行的版本号大于事务的版本号，另起事务进行重新更新，有点感觉像自旋锁的味道，如果更新失败，先把值值，读取出来，然后在重新更新，不知道老师我理解的对不对</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">嗯，这是一种做法的，分析得挺好</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">WL</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">思考题: 因为更新是当前读, 所以如果有另外的事务先执行了一次更新操作, 本事务在执行的时候就会根据的值进行判断和更新, 于是可能就会出现无法更新的情况. </div> <span class="time">2018-12-01</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/c4/3a/a92cb97b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">FW _UI</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">没有复现的同学，记得不要用begin而是改用start transaction.<br>是不是只有老师才有回复的权限？</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">Begin和start transaction是一样的<br><br>如果要马上启动事务，是start transaction with consistent snapshot</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">执行事务B的Q1语句时候，一看自己版本好是101，最新数据版本号不是102？是在事物C基础上读到新的值。上面描述是不是错了</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">执行Q1的时候，事务B已经更新过了，(1,3)已经生成出来了</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">row trx-id不是小的才会成为历史版本？难道这个id大小没关系？</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">历史版本的意思就是“有人更新了，产生一个新版本，原来的版本就变成历史版本”</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">transaction-id 和row Trx-id 两者值应该一直是相等的吧</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">不会肯定相等，你想下如果有多个事务一起读同一行… </p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">天王</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">mvcc的实现原理，一行数据有多次更新，一次更新操作都有一个事务，事务id是申请的，递增的叫做transactionid。每一次修改都会有一回滚日志undolog，多个版本就是通过undolog计算出来的。每一次修改都会有一回滚日志undolog，多个版本就是通过undolog计算出来的。</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">嗯嗯，把这些名词和他们的逻辑理得很清楚呢😄</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/00/4e/6a23251c.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小智e</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这一篇文章非常厉害了，值了值了</div> <span class="time">2018-12-01</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">发条橙子 。</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师 ， 看了@约书亚 的回答还有个疑问点 。 说到另起一个事务在 当前事务update前 先修改掉 <br><br>问题 ：<br><br>另起一个事务在当前事务更新前修改 ， 如果新起的事物没有提交 ，那么当前的事物没有办法执行更新语句 ，会一直堵塞。<br>如果新起的事物提交后 ，当前事务再更新，那么当前事务更新的数据行是最新的 ，再去查询也应该是当前事务更新的值<br><br>所以为什么会看不到新的值还是没有理解😞</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">当前事务再更新，成功了的话，就是就是看到自己更新的，<br><br>自己更新生成的版本自己是要可见的（transaction_id=row trx_id)</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这个要是有案例操作现象操作就好了，会更易理解。</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">额，开头的三个事务就是操作现象呀，你是希望什么样的，给我举个例子。如果能更方便说明问题，后面文章我好参考着写</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">perkyoung</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">图一，在 RR 隔离级别下，如果 begin 下面不紧跟着一个 select 语句，那 Q2的结果应该是3，所以视图应该是在事务的第一个查询语句的时候创建的，而不是事务一启动就创建了，我的 mysql 版本是5.1.73；望指教。</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是的，事务并不是在begin启动的，而是begin 之后的第一个语句，才算事务启动</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">很多没有说清楚，哪个先提交，row Tex-id和up-limit-id 有什么区别？是不是两者都要比较再去读或者更新</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">额，<br>Row trx_id 是行上的， up_limit_id是事务视图的<br><br>你再看看？</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这里是c先提交的事物，然后b，在是a？</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">表格里面从上到下是时间顺序</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">发条橙子 。</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">这篇文章细节满满 很多模棱两可的疑问不攻自破了 受益匪浅 。 谢谢老师 🙏</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">希望重写的版本可以解决更多😄</p> <p class="reply-time">2018-12-03</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">往事随风，顺其自然</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">事物A开始之前up-limit-time 是99，对应这个数据的k值是多少？你为啥还是取row Trx-Id为90的k的值，不应该是99对应k值？</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">在这个题目背景里，99这个事务没有更新这一行的 😓</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/70/cc/a99b8bf9.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">绵呀绵</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师请教一个问题，有个表A里面有300条数据，每次alter 增加字段都会卡住，一直执行不了，然后导致后面查询A表的请求全部锁死了，只能强制断开alter增加字段操作，手动删除锁死的请求pid，请问，理论上我执行alter表的时候，会锁住整个表但数据才300条应该很快就更新完成了，为什么一直卡住。</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你再看一遍06篇呗😄<br><br>如果还没理解，把你被锁住后的show processlist发出来</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/ec/01/978d54af.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Justin</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">有个问题 如果commit之前就生成了历史版本，当前版本的记录，那么如果之前的一个update没有commit，没有释放锁，那后来新的一个事务select会不会因为那一行还有锁而提取全表数据等待呢？一致性读的时候读不是不加锁的吗？那这种情况怎么办呢？</div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">一致性读的时候，只有未提交的版本都直接认为不可见（包括可重复读隔离级别和读提交隔离级别）</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/9a/f2/64d1c380.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">📆</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师你好，我想问下，我用的mysql5.7，最后成功改成0了，是有哪里不对吗？<br>mysql&gt; begin;<br>Query OK, 0 rows affected (0.00 sec)<br><br>mysql&gt; select * from t;<br>+----+------+<br>| id | c    |<br>+----+------+<br>|  1 |    1 |<br>|  2 |    2 |<br>|  3 |    3 |<br>|  4 |    4 |<br>+----+------+<br>4 rows in set (0.00 sec)<br><br>mysql&gt; update t set c=0 where c=id;<br>Query OK, 4 rows affected (0.01 sec)<br>Rows matched: 4  Changed: 4  Warnings: 0<br><br>mysql&gt; select * from t;<br>+----+------+<br>| id | c    |<br>+----+------+<br>|  1 |    0 |<br>|  2 |    0 |<br>|  3 |    0 |<br>|  4 |    0 |<br>+----+------+<br>4 rows in set (0.00 sec)<br></div> <span class="time">2018-12-01</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">表示你还没有复现题目的现象，可以参考一下评论区其它答案哦</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/de/2b/2702fcbe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">jimmy</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，问个问题，一个历史row版本可以删除的依据是什么，您文中提到的是没有事物再使用这个版本了，感觉这句话还是很空洞，能不能具体说一下？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">如果所有事务的一致性读的结果，都不需要再用到它的时候。<br><br>比如我们例子中，Q2执行前， row trx_id=101 102的两个版本，就不能删除，因为事务A还需要依赖他们</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">风雪</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师临时表怎么避免，我已经用join和注意使用第一张表的列了</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">其实临时表不能完全避免，不过如果只是两表join应该还是可以的<br><br>贴一下你的表结构和查询语句</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/fe/75/46742f12.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">liao xueqiang</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">那么，它在读到（1,3) 的时候，就满足了 up_limt_id(102) ≥row trx_id(101) 的条件，所以返回了 k=3。<br>这有问题吧，101是最新版本，102是历史版本啊。应该up_limt_id(101) ≥row trx_id(102) 吧</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">（1，3）的row trx_id 是等于101的呀，事务B更新产生的</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f7/69/d8dba3de.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">DanielAnton</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">那么，它在读到（1，3）的时候，就满足了 up_limit_id（102）&gt;= row trx_id（101）的条件，所以返回了 k = 3。事务 A 的 row trx_id 不应该是 100 吗？所以应该是 up_limit_id（102） &gt;= row trx_id（100）吧。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">注意，row trx_id 是“数据版本”才有的概念（名字里故意加了个row )，up_limit_id才是事务的<br><br>你再重新理解下哈</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/fd/c8/5aa7ae1b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">李金刚</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">和 @夏日雨 一样的问题。<br><br><br>老师你好，有个问题不太理解，对于文中的例子假设transaction id为98的事务在事务A执行select（Q2）之前更新了字段，那么事务A发现这个字段的row trx_id是98，比自己的up_limit_id要小，那此时事务A不就获取到了transaction id为98的事务更新后的值了吗？<br>换句话说对于文中"之后的更新，产生的新的数据版本的 row trx_id 都会大于 up_limit_id"这句话不太理解， up_limit_id是已经提交事务id的最大值，那也可能存在一个没有提交的id小于up_limit_id的事务对数据进行更新？还是说transaction id比up_limit_id小的事务都是保证已经提交的？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">看置顶回答哈</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/fd/c8/5aa7ae1b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">李金刚</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">和 @夏日雨 一样的问题。<br><br><br>老师你好，有个问题不太理解，对于文中的例子假设transaction id为98的事务在事务A执行select（Q2）之前更新了字段，那么事务A发现这个字段的row trx_id是98，比自己的up_limit_id要小，那此时事务A不就获取到了transaction id为98的事务更新后的值了吗？<br>换句话说对于文中"之后的更新，产生的新的数据版本的 row trx_id 都会大于 up_limit_id"这句话不太理解， up_limit_id是已经提交事务id的最大值，那也可能存在一个没有提交的id小于up_limit_id的事务对数据进行更新？还是说transaction id比up_limit_id小的事务都是保证已经提交的？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">看置顶回答哈</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/8f/ad/6e3e9e15.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">产品助理</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">提醒一下，自己看到前面的时候进行测试，发现执行结果与老师分享的不一致，困惑了一下。<br><br>后想到当前要求是：可重复读的场景下，于是检查事务隔离级别：<br><br>SELECT @@tx_isolation; <br><br>结果却是 READ-COMMITTED 读提交。。<br><br>所以调整后就可以了：set global  TRANSACTION ISOLATION LEVEL REPEATABLE READ;<br><br>-- 执行后记得重新连接Mysql。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">嗯嗯，检查环境是好习惯，也可以不加global，这样本连接直接生效哦</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/fd/c8/5aa7ae1b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">李金刚</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">和@周巘 一样的问题。<br><br> 老师好 我想请问一下 如果文章中99号事务提交了 98号事务还没有提交 那么这三个事务的up_limit_id应该还是99 然后在事务A(id=100)的两次读过程中 98号事务提交并且修改了这一行 此时row trx_id=98 将会小于up_limit_id=99 那么事务A的两次读请求结果不就不一样了吗? 请老师解惑 谢谢</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">看置顶回答哈</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/46/48/e959b1e0.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">amazon1011</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">请问最大事务ID是保存在系统里面的一个全局变量吗?是excution_gtid?如果并发写很大，这个产生事务id的生成器会不会成为瓶颈?</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是全局变量，事务启动后拷贝为这个事务自己的内部变量的<br><br>不是gtid 哈，trx_id是innodb 的机制，gtid 是server 层的</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/d5/ee/762ca3f9.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">🚶🏻_____路人丙</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师你好，请问图3假设第三点，三个事务开始之前，这一行得数据row trx_id为啥就是90？这个值是如何得到的？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">假设呀… </p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIqWaVic6yGdicbM2ca4KaJLo3oVtxnpea9hb2zMKSvM2UNiadF5l3PW88QJibcKiaf5b61c0cVa72ZYjw/132" class="avatar"> <div class="info"><div class="hd"><span class="username">杜明欣</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">对于一行数据来讲，数据版本大的对应的事务id不一定是最大的，这个是否会有什么影响</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/4c/49/4c5bc84f.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">mazhen</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">分布式数据库TiDB实现了可重复读隔离级别，但它没有“当前读”这个概念，参看它的文档：<br><br>“与MySQL可重复读隔离级别的区别”  https://pingcap.com/docs-cn/sql/transaction-isolation/ <br><br> TiDB在事务中的update语句也用的是snapshot版本，而不是“当前读”。<br><br> 老师如何评价TiDB的这种实现方式？</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">库淘淘</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">session 1;<br>begin;<br>select * from t;<br>+----+------+<br>| id | c    |<br>+----+------+<br>|  1 |    1 |<br>|  2 |    2 |<br>|  3 |    3 |<br>|  4 |    4 |<br>+----+------+<br><br>session 2;<br>update t set c=0 where id=c;<br>Rows matched: 4  Changed: 4  Warnings: 0<br><br>session 1;<br>update t set c=0 where id=c;<br>Query OK, 0 rows affected (0.00 sec)<br>Rows matched: 0  Changed: 0  Warnings: 0<br><br>select * from t;<br>select * from t;<br>+----+------+<br>| id | c    |<br>+----+------+<br>|  1 |    1 |<br>|  2 |    2 |<br>|  3 |    3 |<br>|  4 |    4 |<br>+----+------+<br>原理：是可重复读隔离级别下，<br>session1 中因update 当前读 发现没有适合条件的更新，未更新成功，<br>select 读继续保持最开始select快照；<br><br>解决方案 可以再事务update语句后面加入 commit work and chain;</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/cb/ab/1aac53bf.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">董航</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">个人觉得，吧read-view理解为当前活跃事务表就好理解了，网上看到的一篇写的还行<br>https://skydh.github.io/2017/12/27/mysql%20%E4%BA%8B%E5%8A%A1%EF%BC%8C%E9%94%81%EF%BC%8C%E4%B8%8E%E5%9B%9B%E5%A4%A7%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/ec/01/978d54af.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Justin</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">有个问题 ，是不是只有commit了之后的数据才会被加到有历史版本和当前版本的记录中呢 没有commit 是不是就是自己知道 存在内存的某个角落呢？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">好问题，<br><br>没commit也写，也生成版本，但是是未提交的，还加着锁。<br><br>正文再引入这个大家看晕了，偷偷没提。</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/04/fb/40f298bb.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">小罗希冀</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">ABC事务 的流程图，那个语句是Q1，那个是Q2，Q3？看的有点晕，就是这里看不懂，经常在下文中看到这些Q1、Q2、Q3都有一种不知所云的感觉</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">我去确认了一下图，都标出来了呀</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/95/6b0c334b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">刘-阿-伟</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">早！老师有什么办法能模拟你文章的例子。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">就是开三个客户端按顺序模拟呀</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/33/cc/2c73c8c4.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">fery</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，请问我可以请教一个问题吗？存储过程统计历史数据的每天数据，使用insert   into  select (可能会多张表，有的是大表)  ，会造成死锁吗？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">单线程跟自己是不会死锁的<br><br>另外对你描述的这个背景有点疑惑，统计历史数据每天的数据，为什么用 insert into select. ?</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/79/b7/989824f7.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">春困秋乏夏打盹</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">session1 更新失效，是session2在更新提交之后，session1的update是当前读，读到id=c的不存在，所以更新失败</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/f7/ad/4a5acd62.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">帅子</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">思考题，好像不符合预期，mysql5.7，有点疑惑<br>mysql root@127.0.0.1:test&gt; select @@transaction_isolation;<br>+---------------------------+<br>| @@transaction_isolation   |<br>|---------------------------|<br>| REPEATABLE-READ           |<br>+---------------------------+<br>1 row in set<br>Time: 0.002s<br>mysql root@127.0.0.1:test&gt; desc test;<br>+---------+---------+--------+-------+-----------+---------+<br>| Field   | Type    | Null   | Key   |   Default | Extra   |<br>|---------+---------+--------+-------+-----------+---------|<br>| id      | int(11) | NO     | PRI   |    &lt;null&gt; |         |<br>| c       | int(11) | YES    |       |    &lt;null&gt; |         |<br>+---------+---------+--------+-------+-----------+---------+<br><br><br>mysql root@127.0.0.1:test&gt; begin;<br>Query OK, 0 rows affected<br>Time: 0.001s<br>mysql root@127.0.0.1:test&gt; select * from test;<br>+------+-----+<br>|   id |   c |<br>|------+-----|<br>|    1 |   1 |<br>|    2 |   2 |<br>|    3 |   3 |<br>|    4 |   4 |<br>|    5 |   5 |<br>+------+-----+<br>5 rows in set<br>Time: 0.002s<br>mysql root@127.0.0.1:test&gt; update test set c=0 where id=c;<br>Query OK, 5 rows affected<br>Time: 0.002s<br>mysql root@127.0.0.1:test&gt; select * from test;<br>+------+-----+<br>|   id |   c |<br>|------+-----|<br>|    1 |   0 |<br>|    2 |   0 |<br>|    3 |   0 |<br>|    4 |   0 |<br>|    5 |   0 |<br>+------+-----+</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">参考一下其它评论的复现步骤</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">库淘淘</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">读提交隔离下。 这时，事务 A 的 Q2 语句开始执行的时候，由于事务 B（101）、C（102）都已经提交了，所以 Q2 的 up_limit_id 的值就应该是事务 C 的 transaction id，即 102。  这个有个疑问 up_limit_id不应该是最后提交的 事务B(101)吗 为何是最先提交的 102呢</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">规则就是“找最大的”😄</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/18/07/c0a73a52.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">憶海拾貝</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">看似更新不了,实际上是更新语句执行时(当前读)读到的数据, 与查询语句执行时(快照读)读到的数据不同所致.<br>只需要在更新语句执行前, 开启另一个事务破坏`id=c`条件. 比如执行`update t set c=id+1`提交即可.<br><br>解决方式, 可以直接用`select...for update`来查询, 先加锁再读.<br><br>构造场景的时候想到一个问题, InnoDB的行锁什么情况下会升级为表锁?</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">分析不错，不过 For update对业务并发度影响比较大哦<br><br>“锁一个表的所有行” 还是行锁蛤，<br><br>如果这么定义，应该不会这么升级吧？</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/30/28/6e019a7a.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">锅子</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">思考题<br>session1                                                        session2<br>begin;<br>select * from t;<br>                                                    update t set c=100 where id=c;<br>update t set c=0 where id=c;<br>select * from t;</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">路过</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">在5.7.24中测试今天的思考题，结果是c都变成了0。和您贴出的结果不同。没有想明白为什么。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">表示你没有复现这个情况哈</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/6f/9f/71fa279a.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Geek_7c1218</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">对于可重复读，查询只承认在事务启动前就已经提交完成的数据；<br><br>这个应该是第一次查询时 不是事务启动时吧</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">Begin不算事务启动哦，所以咱们俩是一致的</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/91/b1/b56e800e.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">w</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，我是那个提问mysql 5.5, 5.7, 8.0 问题的人。具体的参数太多了，这里贴不下。有没有需要重点贴出的参数呢？或者是否给我个什么命令然后我执行一下后把结果发给您。</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你找个地方把复现过程写一下，这里贴地址。 GitHub 或者博客、长微博都可以</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">keepmoving</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">在可重复读隔离级别下，事务在启动的时候就“拍了个快照”。<br>老师，这句话有点疑问，在可重复读隔离级别下，事务视图应该是在事务第一个查询执行时建立的吧，在下面这个例子中<br>demo1<br>A1: start transaction;<br>A2: select * from t;<br>         B1: start transaction;<br>         B2: insert into t values (4, wangwu);<br>         B3: commit;<br>A3: select * from t;<br><br>demo2<br>A1: start transaction;<br>         B1: start transaction;<br>         B2: insert into t values (4, wangwu);<br>         B3: commit;<br>A2: select * from t;<br><br>demo1的A3和A2读到的数据是一样的即读不到B事务新插入的数据，但是demo2里的A2却可以读到B事务新插入的数据，能解答一下么？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">我跟你是一致的，<br><br>如果是 begin; select ... 这种用法，<br><br>事务是在select语句才正式启动</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/77/fd/c6619535.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">XD</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">感觉可以理解成，只要操作需要对记录加锁，他就会使用当前读。那么这个加锁的过程到底是怎么样的呢，锁是存放在内存里的吗？这块后续还会有专门讲解吗？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">在内存里，专门有个地方存锁信息，“这一行现在是我的了”，类似这样的信息</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/01/29/11c1c2f7.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">姜磊</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师你好，关于上期的问题，假设我的T表很大，第一种方法只需要全表扫描一次，第二种需要全表扫描20次吧？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">有Limit ，都是总共锁10000行</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/static/time/img/defaultAvatar.e4ab9fe.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">suke</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师，在重复读级别下，b事务中，执行update t set k=k+1 where k=1这句时，where条件中得到的k=1 ，k+1以后，不应该是2，么，为什么是3，您的文章里说，如果是2，c事务就失效了，所以 执行where语句和执行k=k+1不是在同一个逻辑一致性下执行的？那这样可重复读的语义是不是没有保证？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">Update语句是“当前读”的逻辑，所以它拿到的k 是2哦<br><br></p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/de/7b/49810dd8.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">live</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">显然地，语句 Q1 的查询结果 k=1，哈哈，这里我想了半天，也应该是3啊，原来大家都有此疑问</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">尴尬😅 赞大家细致</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/0b/70/a2c1723c.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">武者</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">可重复读 需保证查询前后一致<br>我一直认为这是相对其他查询的<br>当前的提交和查询都在一个事物里怎么还查不到变化的结果</div> <span class="time">2018-11-30</span> <!----></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/ec/01/978d54af.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Justin</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">请问可重复读会给行加锁吗</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">你要问的应该是一致性读， 不加</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/31/fe/30a17a9d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Leo</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">文中说: “读提交是在每条语执行前计算up_limit_id”，如果不计算会怎样？就变成了读未提交吗？</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">… 为啥不提交，bug 吗 😄<br><br>无关不计算也不判断，就是读未提交；<br>如果不计算，但是判断，那就是用事务的up_limit_id, 就是可重复读</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/de/29/71685b0b.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">BigMortal</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">##思考题：<br>#问题复现：<br>session 1：                                        session2：<br>t1:begin：(up_limit_id1)<br>t2:select * from t;                                t2:begin;  (up_limit_id2)<br>                                                        t3:update t set c=0 where id=c;  <br>                                                        t4:commit                                                        <br>t5:update t set c=0 where id=c; (need             <br>t6:select * from t;  <br>#原理：<br><br><br>                               </div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">继续哈🤝</p> <p class="reply-time">2018-11-30</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/31/fe/30a17a9d.jpg" class="avatar"> <div class="info"><div class="hd"><span class="username">Leo</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">老师在文中说: "所以，在执行事务 B 的 Q1 语句的时候，一看自己的版本号是 101，最新数据的版本号也是 101，可以用，所以 Q1 得到的 k 的值是 3。"，<br>1. 这里不参考up_limit_id吗？<br>2. 如果参考，事务B的up_limit_id是在update语句执行前重新计算的，还是在Q1语句执行前重新计算的？<br></div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是自己更新的，就不用比了</p> <p class="reply-time">2018-12-01</p></div></div></li><li data-v-87ffcada="" class="comment-item"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/AwEHMTGSmVsia3WZDyIicBQPAfS11lBZ0yUappicPzfmGDmMwkje1UoqKK3UJ6FCBdsZyiauuV1SEfcrFzWfx9n1RQ/132" class="avatar"> <div class="info"><div class="hd"><span class="username">虚爱凯平</span> <div class="control"><!----> <a href="javascript:;" class="btn-praise"><i class="iconfont"></i> <span>0</span></a></div></div> <div class="bd">最后读提交隔离级别下, Q1的查询结构应该是k=3吧?</div> <span class="time">2018-11-30</span> <div class="reply"><div class="reply-hd"><i class="iconfont"></i> <span>作者回复</span></div> <p class="reply-content">是的… 抱歉写错了，已经发起修改</p> <p class="reply-time">2018-11-30</p></div></div></li></ul></div></div> <!----> <!----></div></div><link rel="dns-prefetch" href="//cdn.mathjax.org"><script type="text/x-mathjax-config">MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        tex2jax: {
          inlineMath: [['$','$'], ['\\(','\\)']],
          displayMath: [ ["$$","$$"] ],
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'a']
        }
      });
      MathJax.Hub.Register.MessageHook("End Process", function (message) {
        var eve = new Event('mathjaxfini')
        window.dispatchEvent(eve)
      })</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-103082599-6', 'auto');
      ga('send', 'pageview');</script><script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?022f847c4e3acd44d4a2481d9187f1e6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();</script></body><iframe id="__ToutiaoJSBridgeIframe_SetResult" style="display: none;"></iframe><iframe id="__ToutiaoJSBridgeIframe" style="display: none;"></iframe>